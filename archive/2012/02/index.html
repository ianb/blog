<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <!-- MOBIFY - DO NOT ALTER - PASTE IMMEDIATELY AFTER OPENING HEAD TAG -->
        <script type="text/javascript">
            /*<![CDATA[*/ (function (a) {
                function b(a, b) {
                    if (+a) return ~a || (d.cookie = h + "=; path=/");
                    (j = d.createElement(e)),
                        (k = d.getElementsByTagName(e)[0]),
                        (j.src = a),
                        b && (j.onload = j.onerror = b),
                        k.parentNode.insertBefore(j, k);
                }
                function c() {
                    n.api || b(l.shift() || -1, c);
                }
                if (this.Mobify) return;
                var d = document,
                    e = "script",
                    f = "mobify",
                    g = "." + f + ".com/",
                    h = f + "-path",
                    i = g + "un" + f + ".js",
                    j,
                    k,
                    l = [!1, 1],
                    m,
                    n = (this.Mobify = {
                        points: [+new Date()],
                        tagVersion: [6, 0],
                    }),
                    o = /(; |#|&|^)mobify-path=([^&;]*)/g.exec(
                        location.hash + "; " + d.cookie
                    );
                o
                    ? (m = o[2]) &&
                      !+(m = sessionStorage[h] || m) &&
                      (l = [!0, "//preview" + g + escape(m)])
                    : ((l = a() || l),
                      l[0] && l.push("//cdn" + i, "//files01" + i)),
                    l.shift()
                        ? (d.write('<plaintext style="display:none;">'),
                          setTimeout(c))
                        : b(l[0]);
            })(function () {
                if (
                    /ip(hone|od)|android.*(mobile)|blackberry.*applewebkit/i.test(
                        navigator.userAgent
                    )
                ) {
                    return [
                        1,
                        "//cdn.mobify.com/sites/ians-blog/production/mobify.js",
                    ];
                }
            }); /*]]>*/
        </script>
        <!-- END MOBIFY -->
        <title>Ian Bicking: a blog :: 2012 :: February</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <meta name="generator" content="WordPress 3.4.2" />
        <!-- LEAVE FOR STATS -->
        <meta name="description" content="" />
        <link
            rel="stylesheet"
            title="plaintxtSimpler"
            href="../../wp-content/themes/Barthelme-ianb/style.css"
            type="text/css"
            media="all"
        />
        <link rel="start" href="../../index.html" title="Ian Bicking: a blog" />
        <link
            rel="alternate"
            type="application/atom+xml"
            title="Ian Bicking: a blog Atom Feed"
            href="../../feed/atom/index.html"
        />
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Ian Bicking: a blog RSS 2.0 Feed"
            href="../../feed/rss/index.html"
        />
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Ian Bicking: a blog Comments RSS 2.0 Feed"
            href="../../comments/feed/index.html"
        />
        <link
            rel="alternate"
            type="application/rdf+xml"
            title="Ian Bicking: a blog RSS 1.0"
            href="../../feed/rdf/index.html"
        />
        <link
            rel="alternate"
            type="text/xml"
            title="Ian Bicking: a blog RSS 0.92 Feed"
            href="../../feed/rss/index.html"
        />

        <link rel="archives" title="October 2012" href="../10/index.html" />
        <link rel="archives" title="February 2012" href="index.html" />
        <link
            rel="archives"
            title="April 2011"
            href="../../2011/04/index.html"
        />
        <link
            rel="archives"
            title="March 2011"
            href="../../2011/03/index.html"
        />
        <link
            rel="archives"
            title="September 2010"
            href="../../2010/09/index.html"
        />
        <link
            rel="archives"
            title="August 2010"
            href="../../2010/08/index.html"
        />
        <link rel="archives" title="May 2010" href="../../2010/05/index.html" />
        <link
            rel="archives"
            title="April 2010"
            href="../../2010/04/index.html"
        />
        <link
            rel="archives"
            title="March 2010"
            href="../../2010/03/index.html"
        />
        <link
            rel="archives"
            title="February 2010"
            href="../../2010/02/index.html"
        />
        <link
            rel="archives"
            title="January 2010"
            href="../../2010/01/index.html"
        />
        <link
            rel="archives"
            title="September 2009"
            href="../../2009/09/index.html"
        />
        <link rel="archives" title="May 2009" href="../../2009/05/index.html" />
        <link
            rel="archives"
            title="April 2009"
            href="../../2009/04/index.html"
        />
        <link
            rel="archives"
            title="January 2009"
            href="../../2009/01/index.html"
        />
        <link
            rel="archives"
            title="December 2008"
            href="../../2008/12/index.html"
        />
        <link
            rel="archives"
            title="November 2008"
            href="../../2008/11/index.html"
        />
        <link
            rel="archives"
            title="October 2008"
            href="../../2008/10/index.html"
        />
        <link
            rel="archives"
            title="September 2008"
            href="../../2008/09/index.html"
        />
        <link
            rel="archives"
            title="August 2008"
            href="../../2008/08/index.html"
        />
        <link
            rel="archives"
            title="July 2008"
            href="../../2008/07/index.html"
        />
        <link
            rel="archives"
            title="June 2008"
            href="../../2008/06/index.html"
        />
        <link rel="archives" title="May 2008" href="../../2008/05/index.html" />
        <link
            rel="archives"
            title="April 2008"
            href="../../2008/04/index.html"
        />
        <link
            rel="archives"
            title="March 2008"
            href="../../2008/03/index.html"
        />
        <link
            rel="archives"
            title="February 2008"
            href="../../2008/02/index.html"
        />
        <link
            rel="archives"
            title="January 2008"
            href="../../2008/01/index.html"
        />
        <link
            rel="archives"
            title="November 2007"
            href="../../2007/11/index.html"
        />
        <link
            rel="archives"
            title="October 2007"
            href="../../2007/10/index.html"
        />
        <link
            rel="archives"
            title="September 2007"
            href="../../2007/09/index.html"
        />
        <link
            rel="archives"
            title="August 2007"
            href="../../2007/08/index.html"
        />
        <link
            rel="archives"
            title="July 2007"
            href="../../2007/07/index.html"
        />
        <link
            rel="EditURI"
            type="application/rsd+xml"
            title="RSD"
            href="../../xmlrpc.php?rsd"
        />
        <link
            rel="wlwmanifest"
            type="application/wlwmanifest+xml"
            href="../../wp-includes/wlwmanifest.xml"
        />
        <meta name="generator" content="WordPress 3.4.2" />
        <link
            rel="stylesheet"
            href="../../wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"
            type="text/css"
        />
        <style type="text/css">
            .recentcomments a {
                display: inline !important;
                padding: 0 !important;
                margin: 0 !important;
            }
        </style>
        <style type="text/css" media="all">
            /*<![CDATA[*/
            body {
                font-size: 100%;
            }
            body {
                font-family: tahoma, geneva, sans-serif;
            }
            div.post-header,
            h2.post-title,
            p.post-date-single,
            h2.post-title-single,
            div.post-entry h1,
            div.post-entry h2,
            div.post-entry h3,
            div.post-entry h4,
            div.post-entry h5,
            div.post-entry h6,
            div.post-entry blockquote,
            div.post-footer,
            h3#comment-count,
            h4#comment-header,
            div#comments ol li p.comment-metadata,
            h4#respond {
                font-family: verdana, geneva, sans-serif;
            }
            div.post-entry p {
                text-align: left;
            }
            div#wrapper {
                width: 100%;
            }

            /*]]>*/
        </style>
    </head>
    <body>
        <div id="wrapper">
            <div
                id="header"
                onclick="location.href='https://ianbicking.org/';"
                style="cursor: pointer"
            >
                <h1 id="title">
                    <a href="../../index.html" title="Ian Bicking: a blog"
                        >Ian Bicking: a blog</a
                    >
                </h1>
                <p id="description"></p>
            </div>
            <!-- WP Theme Credits -->
            <div style="display: none">
                We can answer on question
                <a href="http://www.olnevhost.net/vps-hosting.html"
                    >what is VPS</a
                >? and what is
                <a href="http://www.olnevhost.net/dedicated-servers.html"
                    ><strong>cheap dedicated servers</strong></a
                >?
            </div>
            <!-- END HEADER -->
            <div id="container">
                <div id="content" class="narrowcolumn">
                    <p class="post-date-single">{ Monthly Archives }</p>
                    <h2 class="post-title-single">February 2012</h2>

                    <div id="post-283" class="post">
                        <div class="post-container">
                            <div class="post-content">
                                <h2 class="post-title">
                                    <a
                                        href="../../index.html?p=283"
                                        title="Permalink to Python Application Package"
                                        rel="bookmark"
                                        >Python Application Package</a
                                    >
                                </h2>
                                <div class="post-entry">
                                    <div class="document">
                                        <p>
                                            I&#8217;ve been thinking some more
                                            about deployment of Python web
                                            applications, and deployment in
                                            general (in part leading up to the
                                            <a
                                                class="reference external"
                                                href="https://us.pycon.org/2012/community/WebDevSummit/"
                                                >Web Summit</a
                                            >). And I&#8217;ve got an idea.
                                        </p>
                                        <p>
                                            I
                                            <a
                                                class="reference external"
                                                href="../../index.html?p=250"
                                                >wrote about this about a year
                                                ago</a
                                            >
                                            and
                                            <a
                                                class="reference external"
                                                href="https://github.com/ianb/pywebapp/blob/master/docs/spec.txt"
                                                >recently revised some notes on
                                                a proposal</a
                                            >
                                            but I&#8217;ve been thinking about
                                            something a bit more basic: a way to
                                            simply ship server applications,
                                            bundles of code. Web applications
                                            are just one use case for this.
                                        </p>
                                        <p>
                                            For now lets call this a
                                            &quot;Python application
                                            package&quot;. It has these
                                            features:
                                        </p>
                                        <ol class="arabic simple">
                                            <li>
                                                There is an
                                                <em>application description</em
                                                >: this tells the
                                                <em>environment</em> about the
                                                application. (This is sometimes
                                                called &quot;configuration&quot;
                                                but that term is very confusing
                                                and overloaded; I think
                                                &quot;description&quot; is much
                                                clearer.)
                                            </li>
                                            <li>
                                                Given the description, you can
                                                create an execution environment
                                                to run code from the application
                                                and acquire objects from the
                                                application. So there would be a
                                                specific way to setup
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >sys.path</span
                                                    ></tt
                                                >, and a way to indicate any
                                                libraries that are required but
                                                not bundled directly with the
                                                application.
                                            </li>
                                            <li>
                                                The environment can inject
                                                information into the
                                                application. (Also this sort of
                                                thing is sometimes called
                                                &quot;configuration&quot;, but
                                                let&#8217;s not do that either.)
                                                This is where the environment
                                                could indicate, for instance,
                                                what database the application
                                                should connect to (host,
                                                username, etc).
                                            </li>
                                            <li>
                                                There would be a way to run
                                                commands and get objects from
                                                the application. The environment
                                                would look in the application
                                                description to get the names of
                                                commands or objects, and use
                                                them in some specific manner
                                                depending on the purpose of the
                                                application. For instance, WSGI
                                                web applications would point the
                                                environment to an application
                                                object. A Tornado application
                                                might simply have a command to
                                                start itself (with the
                                                environment indicating what port
                                                to use through its injection).
                                            </li>
                                        </ol>
                                        <p>
                                            There&#8217;s a lot of things you
                                            can build from these pieces, and in
                                            a sophisticated application you
                                            might use a bunch of them at once.
                                            You might have some WSGI, maybe a
                                            seperate non-WSGI server to handle
                                            Web Sockets, something for a Celery
                                            queue, a way to accept incoming
                                            email, etc. In pretty much all cases
                                            I think basic application lifecycle
                                            is needed: commands to run when an
                                            application is first installed,
                                            something to verify the environment
                                            is acceptable, when you want to back
                                            up its data, when you want to
                                            uninstall it.
                                        </p>
                                        <p>
                                            There&#8217;s also some things that
                                            all environments should setup the
                                            same or inject into the application.
                                            E.g.,
                                            <tt class="docutils literal"
                                                ><span class="pre"
                                                    >$TMPDIR</span
                                                ></tt
                                            >
                                            should point to a place where the
                                            application can keep its temporary
                                            files. Or, every application should
                                            have a directory (perhaps specified
                                            in another environmental variable)
                                            where it can write log files.
                                        </p>
                                        <div class="section" id="details">
                                            <h2>Details?</h2>
                                            <p>
                                                To get more concrete,
                                                here&#8217;s what I can imagine
                                                from a small application
                                                description; probably YAML would
                                                be a good format:
                                            </p>
                                            <div
                                                class="dean_ch"
                                                style="white-space: wrap"
                                            >
                                                <br />
                                                <span class="kw3">platform</span
                                                >: python, wsgi<br />
                                                require:<br />
                                                &nbsp;
                                                <span class="kw3">os</span>:
                                                <span class="kw3">posix</span
                                                ><br />
                                                &nbsp; python: &lt;<span
                                                    class="nu0"
                                                    >3</span
                                                ><br />
                                                &nbsp; rpm: m2crypto<br />
                                                &nbsp; deb: python-m2crypto<br />
                                                &nbsp; pip: requirements.<span
                                                    class="me1"
                                                    >txt</span
                                                ><br />
                                                python:<br />
                                                &nbsp; paths: vendor/<br />
                                                wsgi:<br />
                                                &nbsp; app: myapp.<span
                                                    class="me1"
                                                    >wsgiapp</span
                                                >:application<br />
                                                &nbsp;
                                            </div>
                                            <p>
                                                I imagine
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >platform</span
                                                    ></tt
                                                >
                                                as kind of a series of mixins.
                                                This system doesn&#8217;t really
                                                need to be Python-specific; when
                                                creating something similar for
                                                <a
                                                    class="reference external"
                                                    href="http://cloudsilverlining.org"
                                                    >Silver Lining</a
                                                >
                                                I found PHP support relatively
                                                easy to add (handling languages
                                                that aren&#8217;t naturally
                                                portable, like Go, might be more
                                                of a stretch). So
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >python</span
                                                    ></tt
                                                >
                                                is one of the features this
                                                application uses. You can
                                                imagine lots of modularization
                                                for other features, but it would
                                                be easy and unproductive to get
                                                distracted by that.
                                            </p>
                                            <p>
                                                The application has certain
                                                requirements of its environment,
                                                like the version of Python and
                                                the general OS type. The
                                                application might also require
                                                libraries, ideally one libraries
                                                that are not portable (M2Crypto
                                                being an example). Modern
                                                package management works pretty
                                                nicely for this stuff, so
                                                relying on system packages as a
                                                first try I believe is best
                                                (I&#8217;d offer
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >requirements.txt</span
                                                    ></tt
                                                >
                                                as a fallback, not as the
                                                primary way to handle
                                                dependencies).
                                            </p>
                                            <p>
                                                I think it&#8217;s much more
                                                reliable if applications
                                                primarily rely on bundling their
                                                dependencies directly (i.e.,
                                                using a vendor directory). The
                                                tool support for this is a bit
                                                spotty, but I believe this
                                                package format could clarify the
                                                problems and solutions.
                                                <a
                                                    class="reference external"
                                                    href="https://gist.github.com/1368649"
                                                    >Here is an example</a
                                                >
                                                of how you might set up a
                                                virtualenv environment for
                                                <em>managing</em> vendor
                                                libraries (you then do not need
                                                virtualenv to <em>use</em> those
                                                same libraries), and do so in a
                                                way where you can check the
                                                results into source control.
                                                It&#8217;s kind of complicated,
                                                but works (well, almost works
                                                &#8211;
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >bin/</span
                                                    ></tt
                                                >
                                                files need fixing up).
                                                It&#8217;s a start at least.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="support-library"
                                        >
                                            <h2>Support Library</h2>
                                            <p>
                                                On the environment side we need
                                                a good support library.
                                                <a
                                                    class="reference external"
                                                    href="https://github.com/ianb/pywebapp/"
                                                    >pywebapp</a
                                                >
                                                has some of the basic features,
                                                though it is quite incomplete. I
                                                imagine a library looking
                                                something like this:
                                            </p>
                                            <div
                                                class="dean_ch"
                                                style="white-space: wrap"
                                            >
                                                <br />
                                                <span class="kw1">from</span>
                                                apppackage
                                                <span class="kw1">import</span>
                                                AppPackage<br />
                                                app = AppPackage<span
                                                    class="br0"
                                                    >&#40;</span
                                                ><span class="st0"
                                                    >'/var/apps/app1.2012.02.11'</span
                                                ><span class="br0">&#41;</span
                                                ><br />
                                                <span class="co1"
                                                    ># Maybe a little Debian
                                                    support directly:</span
                                                ><br />
                                                <span class="kw3"
                                                    >subprocess</span
                                                >.<span class="me1">call</span
                                                ><span class="br0">&#40;</span
                                                ><span class="br0">&#91;</span
                                                ><span class="st0"
                                                    >'apt-get'</span
                                                >,
                                                <span class="st0"
                                                    >'install'</span
                                                ><span class="br0">&#93;</span>
                                                +<br />
                                                &nbsp; &nbsp; &nbsp; &nbsp;
                                                &nbsp; &nbsp; &nbsp; &nbsp;
                                                app.<span class="me1"
                                                    >config</span
                                                ><span class="br0">&#91;</span
                                                ><span class="st0"
                                                    >'require'</span
                                                ><span class="br0">&#93;</span
                                                ><span class="br0">&#91;</span
                                                ><span class="st0">'deb'</span
                                                ><span class="br0">&#93;</span
                                                ><span class="br0">&#41;</span
                                                ><br />
                                                <span class="co1"
                                                    ># Or fall back of
                                                    virtualenv/pip</span
                                                ><br />
                                                app.<span class="me1"
                                                    >create_virtualenv</span
                                                ><span class="br0">&#40;</span
                                                ><span class="st0"
                                                    >'/var/app/venvs/app1.2012.02.11'</span
                                                ><span class="br0">&#41;</span
                                                ><br />
                                                app.<span class="me1"
                                                    >install_pip_requirements</span
                                                ><span class="br0">&#40;</span
                                                ><span class="br0">&#41;</span
                                                ><br />
                                                wsgi_app = app.<span class="me1"
                                                    >load_object</span
                                                ><span class="br0">&#40;</span
                                                >app.<span class="me1"
                                                    >config</span
                                                ><span class="br0">&#91;</span
                                                ><span class="st0">'wsgi'</span
                                                ><span class="br0">&#93;</span
                                                ><span class="br0">&#91;</span
                                                ><span class="st0">'app'</span
                                                ><span class="br0">&#93;</span
                                                ><span class="br0">&#41;</span
                                                ><br />
                                                &nbsp;
                                            </div>
                                            <p>
                                                You can imagine building hosting
                                                services on this sort of thing,
                                                or setting up continuous
                                                integration servers (<tt
                                                    class="docutils literal"
                                                    ><span class="pre"
                                                        >app.run_command(app.config['unit_test'])</span
                                                    ></tt
                                                >), and so forth.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="local-development"
                                        >
                                            <h2>Local Development</h2>
                                            <p>
                                                If designed properly, I think
                                                this format is as usable for
                                                local development as it is for
                                                deployment. It should be able to
                                                run directly from a checkout,
                                                with the &quot;development
                                                environment&quot; being an
                                                environment just like any other.
                                            </p>
                                            <p>
                                                This rules out, or at least
                                                makes less exciting, the use of
                                                zip files or tarballs as a
                                                package format. The only
                                                justification I see for using
                                                such archives is that they are
                                                easy to move around; but we live
                                                in the FUTURE and there are many
                                                ways to move directories around
                                                and we don&#8217;t need to cater
                                                to silly old fashions. If that
                                                means a script that creates a
                                                tarball, FTPs it to another
                                                computer, and there it is
                                                unzipped, then fine &#8211; this
                                                format
                                                <em>should not</em> specify
                                                anything about how you actually
                                                deliver the files. But
                                                let&#8217;s not worry about
                                                copying
                                                <a
                                                    class="reference external"
                                                    href="http://en.wikipedia.org/wiki/WAR_file_format_%28Sun%29"
                                                    >WARs</a
                                                >.
                                            </p>
                                        </div>
                                    </div>
                                    <!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://ianbicking.org/2012/02/29/python-application-package/"
    dc:identifier="https://ianbicking.org/2012/02/29/python-application-package/"
    dc:title="Python Application Package"
    trackback:ping="https://ianbicking.org/2012/02/29/python-application-package/trackback/" />
</rdf:RDF> -->
                                </div>
                                <!-- END POST-ENTRY -->
                            </div>
                            <!-- END POST-CONTENT  -->
                        </div>
                        <!-- END-CONTAINER -->
                        <div class="post-header">
                            <h3 class="post-date">2012 02 29</h3>
                            <p class="post-categories">
                                <a
                                    href="../../category/packaging/index.html"
                                    title="View all posts in Packaging"
                                    rel="category tag"
                                    >Packaging</a
                                ><br /><a
                                    href="../../category/python/index.html"
                                    title="View all posts in Python"
                                    rel="category tag"
                                    >Python</a
                                ><br /><a
                                    href="../../category/silverlining.1"
                                    title="View all posts in Silver Lining"
                                    rel="category tag"
                                    >Silver Lining</a
                                ><br /><a
                                    href="../../category/web/index.html"
                                    title="View all posts in Web"
                                    rel="category tag"
                                    >Web</a
                                >
                            </p>
                            <p class="post-comments">
                                <a
                                    href="../../index.html?p=283#comments"
                                    title="Comment on Python Application Package"
                                    >Comments (9)</a
                                >
                            </p>
                            <p class="post-permalink">
                                <a
                                    href="../../index.html?p=283"
                                    title="Permalink to Python Application Package"
                                    rel="permalink"
                                    >Permalink</a
                                >
                            </p>
                        </div>
                        <!-- END POST-FOOTER -->
                    </div>
                    <!-- END POST -->

                    <div id="post-277" class="post">
                        <div class="post-container">
                            <div class="post-content">
                                <h2 class="post-title">
                                    <a
                                        href="../../index.html?p=277"
                                        title="Permalink to Git-as-sync, not source-control-as-deployment"
                                        rel="bookmark"
                                        >Git-as-sync, not
                                        source-control-as-deployment</a
                                    >
                                </h2>
                                <div class="post-entry">
                                    <div class="document">
                                        <p>
                                            I don&#8217;t like systems that use
                                            <tt class="docutils literal"
                                                ><span class="pre">git</span>
                                                <span class="pre"
                                                    >push</span
                                                ></tt
                                            >
                                            for deployment (Heroku et al). Why?
                                            I do a lot of this:
                                        </p>
                                        <div
                                            class="dean_ch"
                                            style="white-space: wrap"
                                        >
                                            <br />
                                            $ git push deploy<br />
                                            ...
                                            <span class="me1">realize</span> I
                                            forgot a domain name ...<br />
                                            $ git commit -m
                                            <span class="st0"
                                                >&quot;fix domain
                                                name&quot;</span
                                            >
                                            -a ; git push deploy<br />
                                            ...
                                            <span class="me1">realize</span> I
                                            didn<span class="st0"
                                                >'t do something right with the
                                                database setup ...<br />
                                                $ git commit -m &quot;configure
                                                database right&quot; -a ; git
                                                push deploy<br />
                                                ... dammit, I didn'</span
                                            >t fix it quite right ...<br />
                                            $ git commit -m
                                            <span class="st0"
                                                >&quot;typo&quot;</span
                                            >
                                            -a ; git push deploy<br />
                                            &nbsp;
                                        </div>
                                        <p>
                                            And then maybe I&#8217;d actually
                                            like to keep my config out of my
                                            source control, or have a build
                                            process that I run locally, or any
                                            number of things. I&#8217;d like to
                                            be able to test deployment, but
                                            every deployment is a commit, and I
                                            like to commit <em>tested</em> work.
                                            I think I could use
                                            <tt class="docutils literal"
                                                ><span class="pre">git</span>
                                                <span class="pre"
                                                    >rebase</span
                                                ></tt
                                            >
                                            but I lack the discipline to undo my
                                            work so I can do it correctly. This
                                            is why I don&#8217;t do continuous
                                            commits.
                                        </p>
                                        <p>
                                            There&#8217;s a whole different
                                            level of weirdness when you use
                                            <a
                                                class="reference external"
                                                href="http://pages.github.com/"
                                                >GitHub Pages</a
                                            >
                                            as you aren&#8217;t pushing to a
                                            deployment-specific remote, you are
                                            pushing to a deployment-specific
                                            branch.
                                        </p>
                                        <p>
                                            So I&#8217;ve generally thought: git
                                            deployment is wrong.
                                        </p>
                                        <p>
                                            Then I was talking to some other
                                            people at Mozilla and they mentioned
                                            that ops was using git for simply
                                            moving files around even though the
                                            stuff they were deploying was itself
                                            in Mercurial. They had a particular
                                            site with a very large number of
                                            files, and it was faster to use git
                                            than rsync (git has more metadata
                                            than rsync; rsync has to look at
                                            <em>everything</em> everytime you
                                            sync). And that all seemed very
                                            reasonable; git is a fine way to
                                            sync things.
                                        </p>
                                        <p>
                                            But I kind of forgot about it all,
                                            and just swore to myself as I did
                                            too many trivial commits and wrote
                                            too many meaningless commit
                                            messages.
                                        </p>
                                        <p>
                                            Still&#8230; it isn&#8217;t so hard
                                            to separate these concerns, is it?
                                            So I wrote up a
                                            <a
                                                class="reference external"
                                                href="https://github.com/ianb/git-sync/blob/master/git-sync"
                                                >quite small command</a
                                            >
                                            called
                                            <a
                                                class="reference external"
                                                href="https://github.com/ianb/git-sync"
                                                >git-sync</a
                                            >. The basic idea: copy the working
                                            directory to a new location (minus
                                            <tt class="docutils literal"
                                                ><span class="pre"
                                                    >.git/</span
                                                ></tt
                                            >), commit that, and push the result
                                            to your deployment remote. You can
                                            send modified and untracked files,
                                            and you can run a build script
                                            before committing and push the
                                            <em>result</em> of the build script,
                                            all without sullying your
                                            &quot;real&quot; source control. And
                                            you happen to have a nice history of
                                            deployments, which is also nice.
                                        </p>
                                        <p>
                                            I&#8217;ve only used this a little
                                            bit, but I&#8217;ve enjoyed when I
                                            have used it, and it makes me feel
                                            much better/clearer about my actual
                                            commits. It&#8217;s really short
                                            right now, and probably gets some
                                            things entirely wrong (e.g., moving
                                            over untracked files). But it works
                                            well enough to be improved
                                            (<em>winkwinknudgenudge</em>).
                                        </p>
                                        <p>
                                            So check it out:
                                            <a
                                                class="reference external"
                                                href="https://github.com/ianb/git-sync"
                                                >https://github.com/ianb/git-sync</a
                                            >
                                        </p>
                                    </div>
                                    <!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://ianbicking.org/2012/02/14/git-as-sync-not-source-control-as-deployment/"
    dc:identifier="https://ianbicking.org/2012/02/14/git-as-sync-not-source-control-as-deployment/"
    dc:title="Git-as-sync, not source-control-as-deployment"
    trackback:ping="https://ianbicking.org/2012/02/14/git-as-sync-not-source-control-as-deployment/trackback/" />
</rdf:RDF> -->
                                </div>
                                <!-- END POST-ENTRY -->
                            </div>
                            <!-- END POST-CONTENT  -->
                        </div>
                        <!-- END-CONTAINER -->
                        <div class="post-header">
                            <h3 class="post-date">2012 02 14</h3>
                            <p class="post-categories">
                                <a
                                    href="../../category/programming/index.html"
                                    title="View all posts in Programming"
                                    rel="category tag"
                                    >Programming</a
                                ><br /><a
                                    href="../../category/web/index.html"
                                    title="View all posts in Web"
                                    rel="category tag"
                                    >Web</a
                                >
                            </p>
                            <p class="post-comments">
                                <a
                                    href="../../index.html?p=277#comments"
                                    title="Comment on Git-as-sync, not source-control-as-deployment"
                                    >Comments (11)</a
                                >
                            </p>
                            <p class="post-permalink">
                                <a
                                    href="../../index.html?p=277"
                                    title="Permalink to Git-as-sync, not source-control-as-deployment"
                                    rel="permalink"
                                    >Permalink</a
                                >
                            </p>
                        </div>
                        <!-- END POST-FOOTER -->
                    </div>
                    <!-- END POST -->

                    <div class="navigation">
                        <div class="alignleft"></div>
                        <div class="alignright"></div>
                    </div>
                    <!-- END NAVIGATION -->
                </div>
                <!-- END CONTENT -->
            </div>
            <!-- END CONTAINER  -->

            <div id="sidebar">
                <ul>
                    <li id="home-link">
                        <h2>
                            <a
                                href="../../index.html"
                                title="Ian Bicking: a blog"
                                >Home</a
                            >
                        </h2>
                    </li>
                    <li id="text-315934862" class="widget widget_text">
                        <h2 class="widgettitle">About</h2>
                        <div class="textwidget">
                            Ian is a developer with Mozilla,
                            <a href="http://ianbicking.appspot.com/projects"
                                >Python open source developer</a
                            >, actually uses
                            <a
                                href="https://plus.google.com/u/0/104537541227697934010/posts"
                                >Google+</a
                            >
                            more than
                            <a href="http://twitter.com/ianbicking">twitter</a>
                            and lives in Minneapolis.<br />
                            <span
                                class="gittip-0001"
                                gittip-username="ianbicking"
                            ></span>
                            <script
                                id="gittip-0001"
                                src="https://www.gittip.com/assets/widgets/0001.js"
                            ></script>
                        </div>
                    </li>
                    <li id="text-315934863" class="widget widget_text">
                        <div class="textwidget">
                            <!-- <script type="text/javascript">mbgc='f5f5f5';ww='160';mbc='cecece';bbc='3F79D5';bmobc='3b71c6';bbgc='4889F0';bmoc='3F79D5';bfc='FFFFFF';bmofc='ffffff';tlc='cecece';tc='6a6a6a';nc='6a6a6a';bc='6a6a6a';l='y';fs='16';fsb='13';bw='100';ff='4';lu='6a6a6a';pc='4889F0';wh='340';b='s'; pid='104537541227697934010';</script><script type="text/javascript" src="http://widgetsplus.com/google_plus_widget.js"></script> -->
                        </div>
                    </li>
                    <li id="archives-2" class="widget widget_archive">
                        <h2 class="widgettitle">Archives</h2>
                        <ul>
                            <li>
                                <a href="../10/index.html" title="October 2012"
                                    >October 2012</a
                                >
                            </li>
                            <li>
                                <a href="index.html" title="February 2012"
                                    >February 2012</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2011/04/index.html"
                                    title="April 2011"
                                    >April 2011</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2011/03/index.html"
                                    title="March 2011"
                                    >March 2011</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/09/index.html"
                                    title="September 2010"
                                    >September 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/08/index.html"
                                    title="August 2010"
                                    >August 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/05/index.html"
                                    title="May 2010"
                                    >May 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/04/index.html"
                                    title="April 2010"
                                    >April 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/03/index.html"
                                    title="March 2010"
                                    >March 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/02/index.html"
                                    title="February 2010"
                                    >February 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/01/index.html"
                                    title="January 2010"
                                    >January 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2009/09/index.html"
                                    title="September 2009"
                                    >September 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2009/05/index.html"
                                    title="May 2009"
                                    >May 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2009/04/index.html"
                                    title="April 2009"
                                    >April 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2009/01/index.html"
                                    title="January 2009"
                                    >January 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/12/index.html"
                                    title="December 2008"
                                    >December 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/11/index.html"
                                    title="November 2008"
                                    >November 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/10/index.html"
                                    title="October 2008"
                                    >October 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/09/index.html"
                                    title="September 2008"
                                    >September 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/08/index.html"
                                    title="August 2008"
                                    >August 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/07/index.html"
                                    title="July 2008"
                                    >July 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/06/index.html"
                                    title="June 2008"
                                    >June 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/05/index.html"
                                    title="May 2008"
                                    >May 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/04/index.html"
                                    title="April 2008"
                                    >April 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/03/index.html"
                                    title="March 2008"
                                    >March 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/02/index.html"
                                    title="February 2008"
                                    >February 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/01/index.html"
                                    title="January 2008"
                                    >January 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/11/index.html"
                                    title="November 2007"
                                    >November 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/10/index.html"
                                    title="October 2007"
                                    >October 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/09/index.html"
                                    title="September 2007"
                                    >September 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/08/index.html"
                                    title="August 2007"
                                    >August 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/07/index.html"
                                    title="July 2007"
                                    >July 2007</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li id="text-315934861" class="widget widget_text">
                        <div class="textwidget">
                            <a href="../../archive/index.html"
                                >The Older Archives</a
                            >
                        </div>
                    </li>
                    <li id="categories-1" class="widget widget_categories">
                        <h2 class="widgettitle">Categories</h2>
                        <ul>
                            <li class="cat-item cat-item-12">
                                <a
                                    href="../../category/erlang/index.html"
                                    title="View all posts filed under Erlang"
                                    >Erlang</a
                                >
                            </li>
                            <li class="cat-item cat-item-11">
                                <a
                                    href="../../category/html/index.html"
                                    title="View all posts filed under HTML"
                                    >HTML</a
                                >
                            </li>
                            <li class="cat-item cat-item-8">
                                <a
                                    href="../../category/javascript/index.html"
                                    title="View all posts filed under Javascript"
                                    >Javascript</a
                                >
                            </li>
                            <li class="cat-item cat-item-15">
                                <a
                                    href="../../category/licensing/index.html"
                                    title="View all posts filed under Licensing"
                                    >Licensing</a
                                >
                            </li>
                            <li class="cat-item cat-item-18">
                                <a
                                    href="../../category/mozilla/index.html"
                                    title="View all posts filed under Mozilla"
                                    >Mozilla</a
                                >
                            </li>
                            <li class="cat-item cat-item-5">
                                <a
                                    href="../../category/notech/index.html"
                                    title="View all posts filed under Non-technical"
                                    >Non-technical</a
                                >
                            </li>
                            <li class="cat-item cat-item-6">
                                <a
                                    href="../../category/olpc/index.html"
                                    title="View all posts filed under OLPC"
                                    >OLPC</a
                                >
                            </li>
                            <li class="cat-item cat-item-14">
                                <a
                                    href="../../category/packaging/index.html"
                                    title="View all posts filed under Packaging"
                                    >Packaging</a
                                >
                            </li>
                            <li class="cat-item cat-item-4">
                                <a
                                    href="../../category/politics/index.html"
                                    title="View all posts filed under Politics"
                                    >Politics</a
                                >
                            </li>
                            <li class="cat-item cat-item-3">
                                <a
                                    href="../../category/programming/index.html"
                                    title="View all posts filed under Programming"
                                    >Programming</a
                                >
                            </li>
                            <li class="cat-item cat-item-7">
                                <a
                                    href="../../category/python/index.html"
                                    title="View all posts filed under Python"
                                    >Python</a
                                >
                            </li>
                            <li class="cat-item cat-item-10">
                                <a
                                    href="../../category/ruby/index.html"
                                    title="View all posts filed under Ruby"
                                    >Ruby</a
                                >
                            </li>
                            <li class="cat-item cat-item-19">
                                <a
                                    href="../../category/security/index.html"
                                    title="View all posts filed under Security"
                                    >Security</a
                                >
                            </li>
                            <li class="cat-item cat-item-16">
                                <a
                                    href="../../category/silverlining.1"
                                    title="View all posts filed under Silver Lining"
                                    >Silver Lining</a
                                >
                            </li>
                            <li class="cat-item cat-item-20">
                                <a
                                    href="../../category/programming/testing/index.html"
                                    title="View all posts filed under Testing"
                                    >Testing</a
                                >
                            </li>
                            <li class="cat-item cat-item-9">
                                <a
                                    href="../../category/web/index.html"
                                    title="View all posts filed under Web"
                                    >Web</a
                                >
                            </li>
                            <li class="cat-item cat-item-13">
                                <a
                                    href="../../category/zopeplone/index.html"
                                    title="View all posts filed under Zope/Plone"
                                    >Zope/Plone</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li id="search-2" class="widget widget_search">
                        <form
                            id="searchform"
                            method="get"
                            action="../../index.html"
                        >
                            <div>
                                <input
                                    id="s"
                                    name="s"
                                    type="text"
                                    value=""
                                    tabindex="1"
                                    size="10"
                                />
                                <input
                                    id="searchsubmit"
                                    name="searchsubmit"
                                    type="submit"
                                    value="Find"
                                    tabindex="2"
                                />
                            </div>
                        </form>
                    </li>
                    <li
                        id="recent-posts-2"
                        class="widget widget_recent_entries"
                    >
                        <h2 class="widgettitle">Recent Posts</h2>
                        <ul>
                            <li>
                                <a
                                    href="../../index.html?p=291"
                                    title="Why doctest.js is better than Python&#8217;s doctest"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../index.html?p=283"
                                    title="Python Application Package"
                                    >Python Application Package</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../index.html?p=277"
                                    title="Git-as-sync, not source-control-as-deployment"
                                    >Git-as-sync, not
                                    source-control-as-deployment</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../index.html?p=253"
                                    title="My Unsolicited Advice For PyPy"
                                    >My Unsolicited Advice For PyPy</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../index.html?p=250"
                                    title="A Python Web Application Package and Format (we should make one)"
                                    >A Python Web Application Package and Format
                                    (we should make one)</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li
                        id="recent-comments-2"
                        class="widget widget_recent_comments"
                    >
                        <h2 class="widgettitle">Recent Comments</h2>
                        <ul id="recentcomments">
                            <li class="recentcomments">
                                <a
                                    href="http://www.mirsa.com.tr"
                                    rel="external nofollow"
                                    class="url"
                                    >havalandrma</a
                                >
                                on
                                <a
                                    href="../10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-228633"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                <a
                                    href="http://redealmeidense.com.br/portalx/modules/"
                                    rel="external nofollow"
                                    class="url"
                                    >this website</a
                                >
                                on
                                <a
                                    href="../10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-196267"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                Eric Pierce on
                                <a
                                    href="../10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195322"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                Paul Brian on
                                <a
                                    href="../10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195321"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                <a
                                    href="http://benjiyork.com"
                                    rel="external nofollow"
                                    class="url"
                                    >Benji York</a
                                >
                                on
                                <a
                                    href="../10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195320"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div id="footer">
                <p>
                    &copy; 2013 Ian<!--
Does this commenting make me evil?
			|
			Thanks, <a href="http://wordpress.org/" title="WordPress">WordPress</a>
			|
			<a href="http://www.plaintxt.org/themes/barthelme/" title="Barthelme for WordPress" rel="follow">Barthelme</a> theme by <a href="http://scottwallick.com/" title="scottwallick.com" rel="follow">Scott</a>
			| <!-- The following is a link to the theme author's sponsor. Please consider its smallness and that Scott was nice enough to make this theme publically available. -->
                    Sponsor:
                    <a
                        href="http://www.active-sandals.com/womreefsan.html"
                        title="Support: Reef Sandals"
                        >Reef Sandals</a
                    >
                    | Valid
                    <a
                        href="http://validator.w3.org/check?uri=http://blog.ianbicking.org&amp;outline=1&amp;verbose=1"
                        title="Valid XHTML 1.0 Strict"
                        rel="nofollow"
                        >XHTML</a
                    >
                    &amp;
                    <a
                        href="http://jigsaw.w3.org/css-validator/validator?uri=https://ianbicking.org/wp-content/themes/Barthelme-ianb/style.css&amp;profile=css2&amp;warning=no"
                        title="Valid CSS"
                        rel="nofollow"
                        >CSS</a
                    >
                    | --> RSS:
                    <a
                        href="../../feed/rss/index.html"
                        title="Ian Bicking: a blog RSS 2.0 (XML) Feed"
                        rel="alternate"
                        type="application/rss+xml"
                        >Posts</a
                    >
                    &amp;
                    <a
                        href="../../comments/feed/index.html"
                        title="Ian Bicking: a blog Comments RSS 2.0 (XML) Feed"
                        rel="alternate"
                        type="application/rss+xml"
                        >Comments</a
                    >
                </p>
            </div>
        </div>
        <!-- END WRAPPER -->

        <!-- Somehow 35 queries occured in 1.787 seconds. Magic! -->
        <!-- The "Barthelme" theme copyright (c) 2006 Scott Allan Wallick - http://www.plaintxt.org/themes/ -->

        <!-- Google Analytics -->
        <script
            src="http://www.google-analytics.com/urchin.js"
            type="text/javascript"
        ></script>
        <script type="text/javascript">
            _uacct = "UA-2442258-1";
            urchinTracker();
        </script>
    </body>
</html>
