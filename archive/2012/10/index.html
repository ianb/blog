<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <!-- MOBIFY - DO NOT ALTER - PASTE IMMEDIATELY AFTER OPENING HEAD TAG -->
        <script type="text/javascript">
            /*<![CDATA[*/ (function (a) {
                function b(a, b) {
                    if (+a) return ~a || (d.cookie = h + "=; path=/");
                    (j = d.createElement(e)),
                        (k = d.getElementsByTagName(e)[0]),
                        (j.src = a),
                        b && (j.onload = j.onerror = b),
                        k.parentNode.insertBefore(j, k);
                }
                function c() {
                    n.api || b(l.shift() || -1, c);
                }
                if (this.Mobify) return;
                var d = document,
                    e = "script",
                    f = "mobify",
                    g = "." + f + ".com/",
                    h = f + "-path",
                    i = g + "un" + f + ".js",
                    j,
                    k,
                    l = [!1, 1],
                    m,
                    n = (this.Mobify = {
                        points: [+new Date()],
                        tagVersion: [6, 0],
                    }),
                    o = /(; |#|&|^)mobify-path=([^&;]*)/g.exec(
                        location.hash + "; " + d.cookie
                    );
                o
                    ? (m = o[2]) &&
                      !+(m = sessionStorage[h] || m) &&
                      (l = [!0, "//preview" + g + escape(m)])
                    : ((l = a() || l),
                      l[0] && l.push("//cdn" + i, "//files01" + i)),
                    l.shift()
                        ? (d.write('<plaintext style="display:none;">'),
                          setTimeout(c))
                        : b(l[0]);
            })(function () {
                if (
                    /ip(hone|od)|android.*(mobile)|blackberry.*applewebkit/i.test(
                        navigator.userAgent
                    )
                ) {
                    return [
                        1,
                        "//cdn.mobify.com/sites/ians-blog/production/mobify.js",
                    ];
                }
            }); /*]]>*/
        </script>
        <!-- END MOBIFY -->
        <title>Ian Bicking: a blog :: 2012 :: October</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <meta name="generator" content="WordPress 3.4.2" />
        <!-- LEAVE FOR STATS -->
        <meta name="description" content="" />
        <link
            rel="stylesheet"
            title="plaintxtSimpler"
            href="../../wp-content/themes/Barthelme-ianb/style.css"
            type="text/css"
            media="all"
        />
        <link rel="start" href="../../index.html" title="Ian Bicking: a blog" />
        <link
            rel="alternate"
            type="application/atom+xml"
            title="Ian Bicking: a blog Atom Feed"
            href="../../feed/atom/index.html"
        />
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Ian Bicking: a blog RSS 2.0 Feed"
            href="../../feed/rss/index.html"
        />
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Ian Bicking: a blog Comments RSS 2.0 Feed"
            href="../../comments/feed/index.html"
        />
        <link
            rel="alternate"
            type="application/rdf+xml"
            title="Ian Bicking: a blog RSS 1.0"
            href="../../feed/rdf/index.html"
        />
        <link
            rel="alternate"
            type="text/xml"
            title="Ian Bicking: a blog RSS 0.92 Feed"
            href="../../feed/rss/index.html"
        />

        <link rel="archives" title="October 2012" href="index.html" />
        <link rel="archives" title="February 2012" href="../02/index.html" />
        <link
            rel="archives"
            title="April 2011"
            href="../../2011/04/index.html"
        />
        <link
            rel="archives"
            title="March 2011"
            href="../../2011/03/index.html"
        />
        <link
            rel="archives"
            title="September 2010"
            href="../../2010/09/index.html"
        />
        <link
            rel="archives"
            title="August 2010"
            href="../../2010/08/index.html"
        />
        <link rel="archives" title="May 2010" href="../../2010/05/index.html" />
        <link
            rel="archives"
            title="April 2010"
            href="../../2010/04/index.html"
        />
        <link
            rel="archives"
            title="March 2010"
            href="../../2010/03/index.html"
        />
        <link
            rel="archives"
            title="February 2010"
            href="../../2010/02/index.html"
        />
        <link
            rel="archives"
            title="January 2010"
            href="../../2010/01/index.html"
        />
        <link
            rel="archives"
            title="September 2009"
            href="../../2009/09/index.html"
        />
        <link rel="archives" title="May 2009" href="../../2009/05/index.html" />
        <link
            rel="archives"
            title="April 2009"
            href="../../2009/04/index.html"
        />
        <link
            rel="archives"
            title="January 2009"
            href="../../2009/01/index.html"
        />
        <link
            rel="archives"
            title="December 2008"
            href="../../2008/12/index.html"
        />
        <link
            rel="archives"
            title="November 2008"
            href="../../2008/11/index.html"
        />
        <link
            rel="archives"
            title="October 2008"
            href="../../2008/10/index.html"
        />
        <link
            rel="archives"
            title="September 2008"
            href="../../2008/09/index.html"
        />
        <link
            rel="archives"
            title="August 2008"
            href="../../2008/08/index.html"
        />
        <link
            rel="archives"
            title="July 2008"
            href="../../2008/07/index.html"
        />
        <link
            rel="archives"
            title="June 2008"
            href="../../2008/06/index.html"
        />
        <link rel="archives" title="May 2008" href="../../2008/05/index.html" />
        <link
            rel="archives"
            title="April 2008"
            href="../../2008/04/index.html"
        />
        <link
            rel="archives"
            title="March 2008"
            href="../../2008/03/index.html"
        />
        <link
            rel="archives"
            title="February 2008"
            href="../../2008/02/index.html"
        />
        <link
            rel="archives"
            title="January 2008"
            href="../../2008/01/index.html"
        />
        <link
            rel="archives"
            title="November 2007"
            href="../../2007/11/index.html"
        />
        <link
            rel="archives"
            title="October 2007"
            href="../../2007/10/index.html"
        />
        <link
            rel="archives"
            title="September 2007"
            href="../../2007/09/index.html"
        />
        <link
            rel="archives"
            title="August 2007"
            href="../../2007/08/index.html"
        />
        <link
            rel="archives"
            title="July 2007"
            href="../../2007/07/index.html"
        />
        <link
            rel="EditURI"
            type="application/rsd+xml"
            title="RSD"
            href="../../xmlrpc.php?rsd"
        />
        <link
            rel="wlwmanifest"
            type="application/wlwmanifest+xml"
            href="../../wp-includes/wlwmanifest.xml"
        />
        <meta name="generator" content="WordPress 3.4.2" />
        <link
            rel="stylesheet"
            href="../../wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"
            type="text/css"
        />
        <style type="text/css">
            .recentcomments a {
                display: inline !important;
                padding: 0 !important;
                margin: 0 !important;
            }
        </style>
        <style type="text/css" media="all">
            /*<![CDATA[*/
            body {
                font-size: 100%;
            }
            body {
                font-family: tahoma, geneva, sans-serif;
            }
            div.post-header,
            h2.post-title,
            p.post-date-single,
            h2.post-title-single,
            div.post-entry h1,
            div.post-entry h2,
            div.post-entry h3,
            div.post-entry h4,
            div.post-entry h5,
            div.post-entry h6,
            div.post-entry blockquote,
            div.post-footer,
            h3#comment-count,
            h4#comment-header,
            div#comments ol li p.comment-metadata,
            h4#respond {
                font-family: verdana, geneva, sans-serif;
            }
            div.post-entry p {
                text-align: left;
            }
            div#wrapper {
                width: 100%;
            }

            /*]]>*/
        </style>
    </head>
    <body>
        <div id="wrapper">
            <div
                id="header"
                onclick="location.href='https://ianbicking.org/';"
                style="cursor: pointer"
            >
                <h1 id="title">
                    <a href="../../index.html" title="Ian Bicking: a blog"
                        >Ian Bicking: a blog</a
                    >
                </h1>
                <p id="description"></p>
            </div>
            <!-- WP Theme Credits -->
            <div style="display: none">
                We can answer on question
                <a href="http://www.olnevhost.net/vps-hosting.html"
                    >what is VPS</a
                >? and what is
                <a href="http://www.olnevhost.net/dedicated-servers.html"
                    ><strong>cheap dedicated servers</strong></a
                >?
            </div>
            <!-- END HEADER -->
            <div id="container">
                <div id="content" class="narrowcolumn">
                    <p class="post-date-single">{ Monthly Archives }</p>
                    <h2 class="post-title-single">October 2012</h2>

                    <div id="post-291" class="post">
                        <div class="post-container">
                            <div class="post-content">
                                <h2 class="post-title">
                                    <a
                                        href="../../index.html?p=291"
                                        title="Permalink to Why doctest.js is better than Python&#8217;s doctest"
                                        rel="bookmark"
                                        >Why doctest.js is better than
                                        Python&#8217;s doctest</a
                                    >
                                </h2>
                                <div class="post-entry">
                                    <div class="document">
                                        <p>
                                            I&#8217;ve been trying, not too
                                            successfully I&#8217;m afraid, to
                                            get more people to use
                                            <a
                                                class="reference external"
                                                href="http://doctestjs.org"
                                                >doctest.js</a
                                            >. There&#8217;s probably a few
                                            reasons people don&#8217;t. They are
                                            all wrong! Doctest.js is the best!
                                        </p>
                                        <p>
                                            One issue in particular is that
                                            people (especially people in my
                                            Python-biased circles) are perhaps
                                            thrown off by Python&#8217;s
                                            doctest. I think Python&#8217;s
                                            doctest is pretty nice, I enjoy
                                            testing with it, but there&#8217;s
                                            no question that it has a lot of
                                            problems. I&#8217;ve even thought
                                            about trying to fix doctest, and
                                            even made a repository, but I only
                                            really got as far as
                                            <a
                                                class="reference external"
                                                href="https://github.com/ianb/doctest2/issues?direction=desc&amp;#038;sort=created&amp;#038;state=open"
                                                >creating a list of issues
                                                I&#8217;d like to fix</a
                                            >. But, like so many before me, I
                                            never actually <em>made</em> those
                                            fixes. Doctest has, in its life,
                                            only really had a single period of
                                            improvement (in the time leading to
                                            Python 2.4). That&#8217;s not a
                                            recipe for success.
                                        </p>
                                        <p>
                                            Of course doctest.js takes
                                            inspiration from Python&#8217;s
                                            doctest, but I wrote it as a real
                                            test environment, not for a minimal
                                            use case. In the process I fixed a
                                            bunch of issues with doctest, and in
                                            places Javascript has also provided
                                            helpful usability.
                                        </p>
                                        <p>Some issues:</p>
                                        <div
                                            class="section"
                                            id="doctest-js-output-is-predictable"
                                        >
                                            <h2>
                                                Doctest.js output is predictable
                                            </h2>
                                            <p>
                                                The classic pitfall of
                                                Python&#8217;s doctest is
                                                printing a dictionary:
                                            </p>
                                            <div
                                                class="dean_ch"
                                                style="white-space: wrap"
                                            >
                                                <br />
                                                &gt;&gt;&gt;
                                                <span class="kw1">print</span>
                                                <span class="br0">&#123;</span
                                                ><span class="st0"
                                                    >&quot;one&quot;</span
                                                >: <span class="nu0">1</span>,
                                                <span class="st0"
                                                    >&quot;two&quot;</span
                                                >: <span class="nu0">2</span
                                                ><span class="br0">&#125;</span
                                                ><br />
                                                <span class="br0">&#123;</span
                                                ><span class="st0">'two'</span>:
                                                <span class="nu0">2</span>,
                                                <span class="st0">'one'</span>:
                                                <span class="nu0">1</span
                                                ><span class="br0">&#125;</span
                                                ><br />
                                                &nbsp;
                                            </div>
                                            <p>
                                                The print order of a dictionary
                                                is arbitrary, based on a hash
                                                algorithm that can change, or
                                                mix things up as items are added
                                                or removed. And to make it
                                                worse, the output
                                                <em>usually</em> stable, such
                                                that you can write tests that
                                                unexpectibly fragile. But
                                                there&#8217;s no reason why
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >dict.__repr__</span
                                                    ></tt
                                                >
                                                <em>must</em> use an arbitrary
                                                order. Personally I take it as a
                                                bit of unfortunate laziness.
                                            </p>
                                            <p>
                                                If doctest had used
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >pprint</span
                                                    ></tt
                                                >
                                                for all of its printing it would
                                                have helped some. But not
                                                enough, because this kind of
                                                code is fairly common:
                                            </p>
                                            <div
                                                class="dean_ch"
                                                style="white-space: wrap"
                                            >
                                                <br />
                                                <span class="kw1">def</span>
                                                <span class="kw4">__repr__</span
                                                ><span class="br0">&#40;</span
                                                ><span class="kw2">self</span
                                                ><span class="br0">&#41;</span
                                                >:<br />
                                                &nbsp; &nbsp;
                                                <span class="kw1">return</span>
                                                <span class="st0"
                                                    >'&lt;ThisClass
                                                    attr=%r&gt;'</span
                                                >
                                                %
                                                <span class="kw2">self</span
                                                >.<span class="me1">attr</span
                                                ><br />
                                                &nbsp;
                                            </div>
                                            <p>
                                                and that
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >%r</span
                                                    ></tt
                                                >
                                                invokes a
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >repr()</span
                                                    ></tt
                                                >
                                                that cannot be overridden.
                                            </p>
                                            <p>
                                                In doctest.js I always try to
                                                make output predictable. One
                                                reason this is fairly easy is
                                                that there&#8217;s nothing like
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >repr()</span
                                                    ></tt
                                                >
                                                in Javascript, so doctest.js has
                                                its own implementation.
                                                It&#8217;s like I started with
                                                pprint and no other notion
                                                existed.
                                            </p>
                                        </div>
                                        <div class="section" id="good-matching">
                                            <h2>Good matching</h2>
                                            <p>
                                                In addition to unpredictable
                                                output, there&#8217;s also just
                                                hard-to-match output. Output
                                                might contain blank lines, for
                                                instance, and Python&#8217;s
                                                doctest requires a very ugly
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >&lt;BLANKLINE&gt;</span
                                                    ></tt
                                                >
                                                token to handle that. Whitespace
                                                might not be normalized. Maybe
                                                there&#8217;s boring output.
                                                Maybe there&#8217;s just a
                                                volatile item like a timestamp.
                                            </p>
                                            <p>
                                                Doctest.js includes, by default,
                                                ellipsis:
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >...</span
                                                    ></tt
                                                >
                                                matches any length of text. But
                                                it also includes another
                                                wildcard,
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >?</span
                                                    ></tt
                                                >, which matches just one number
                                                or word. This avoids cases when
                                                the use of
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >...</span
                                                    ></tt
                                                >
                                                swallows up too much when you
                                                just wanted to get a single
                                                word.
                                            </p>
                                            <p>
                                                Also doctest.js doesn&#8217;t
                                                use
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >...</span
                                                    ></tt
                                                >
                                                for other purposes. In
                                                Python&#8217;s doctest
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >...`</span
                                                    ></tt
                                                >
                                                is used for continuation lines,
                                                meaning you can&#8217;t just
                                                ignore output, like:
                                            </p>
                                            <div
                                                class="dean_ch"
                                                style="white-space: wrap"
                                            >
                                                <br />
                                                &gt;&gt;&gt;
                                                <span class="kw1">print</span>
                                                who_knows_what_this_returns<span
                                                    class="br0"
                                                    >&#40;</span
                                                ><span class="br0">&#41;</span
                                                ><br />
                                                ...<br />
                                                &nbsp;
                                            </div>
                                            <p>
                                                Or even worse, you can&#8217;t
                                                ignore the beginning of an item:
                                            </p>
                                            <div
                                                class="dean_ch"
                                                style="white-space: wrap"
                                            >
                                                <br />
                                                &gt;&gt;&gt;
                                                <span class="kw1">print</span>
                                                some_request<br />
                                                ...<br />
                                                <span class="me1">X</span
                                                >-Some-Header: foo<br />
                                                ...<br />
                                                &nbsp;
                                            </div>
                                            <p>
                                                The way I prefer to use
                                                doctest.js it doesn&#8217;t have
                                                <em>any</em> continuation line
                                                symbol (but if there is one,
                                                it&#8217;s
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >&gt;</span
                                                    ></tt
                                                >).
                                            </p>
                                            <p>
                                                Also doctest.js normalizes
                                                whitespace, normalizes
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >&quot;</span
                                                    ></tt
                                                >
                                                and
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >'</span
                                                    ></tt
                                                >, and just generally tries to
                                                be <em>reasonable</em>.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="doctest-js-tests-are-plain-javascript"
                                        >
                                            <h2>
                                                Doctest.js tests are plain
                                                Javascript
                                            </h2>
                                            <p>
                                                Not many editors know how to
                                                syntax highlight and check
                                                doctests, with their
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >&gt;&gt;&gt;</span
                                                    ></tt
                                                >
                                                in front of each line and so
                                                forth. And the whole thing is
                                                tweaky, you need to use a
                                                continuation (<tt
                                                    class="docutils literal"
                                                    ><span class="pre"
                                                        >...</span
                                                    ></tt
                                                >) on some lines, and start
                                                statements with
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >&gt;&gt;&gt;</span
                                                    ></tt
                                                >. It&#8217;s an awkward way to
                                                compose.
                                            </p>
                                            <p>
                                                Doctest.js started out with the
                                                same notion, though with
                                                different symbols (<tt
                                                    class="docutils literal"
                                                    ><span class="pre"
                                                        >$</span
                                                    ></tt
                                                >
                                                and
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >&gt;</span
                                                    ></tt
                                                >). But recently with the rise
                                                of a number of excellent parsers
                                                (I used
                                                <a
                                                    class="reference external"
                                                    href="http://esprima.org/"
                                                    >Esprima</a
                                                >) I&#8217;ve moved my own tests
                                                to another pattern:
                                            </p>
                                            <div
                                                class="dean_ch"
                                                style="white-space: wrap"
                                            >
                                                <br />
                                                <span class="kw1">print</span
                                                ><span class="br0">&#40;</span
                                                >something<span class="br0"
                                                    >&#40;</span
                                                ><span class="br0">&#41;</span
                                                ><span class="br0">&#41;</span
                                                ><br />
                                                // =&gt; expected output<br />
                                                &nbsp;
                                            </div>
                                            <p>
                                                This is already a fairly common
                                                way to write examples. Like how
                                                you may have read pre-Python
                                                pseudocode and thought:
                                                <em>that looks like Python!</em
                                                >: doctest.js looks like example
                                                pseudocode.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="doctest-js-tests-are-self-describing"
                                        >
                                            <h2>
                                                Doctest.js tests are
                                                self-describing
                                            </h2>
                                            <p>
                                                Python&#8217;s doctest has some
                                                options, some
                                                <em>important</em> options that
                                                effect the semantics of the
                                                test, that you can only turn on
                                                in the runner. The most
                                                important option is ELLIPSIS.
                                                Either your test was written to
                                                use ELLIPSIS or it wasn&#8217;t
                                                &#8211; that a test can&#8217;t
                                                self-describe its requirements
                                                means that test running is
                                                fragile.
                                            </p>
                                            <p>
                                                I made
                                                <a
                                                    class="reference external"
                                                    href="http://pypi.python.org/pypi/dtopt"
                                                    >the hackiest package
                                                    ever</a
                                                >
                                                to get around this in Python,
                                                but it&#8217;s hacky and lame.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="exception-handling-isn-t-special"
                                        >
                                            <h2>
                                                Exception handling isn&#8217;t
                                                special
                                            </h2>
                                            <p>
                                                Python&#8217;s doctest treats
                                                exceptions differently from
                                                other output. So if you print
                                                something before the exception,
                                                it is thrown away, never to be
                                                seen. And you can&#8217;t use
                                                some of the same matching
                                                techniques.
                                            </p>
                                            <p>
                                                Doctest.js just prints out
                                                exceptions, and it&#8217;s
                                                matched like anything else.
                                            </p>
                                            <p>
                                                This particular case is one of
                                                several places where it feels
                                                like Python&#8217;s doctest is
                                                just being obstinate. Doing it
                                                the right way isn&#8217;t
                                                harder. Python&#8217;s doctest
                                                makes
                                                <em>debugging</em> exception
                                                cases really hard.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="doctest-js-has-a-concept-of-abort"
                                        >
                                            <h2>
                                                Doctest.js has a concept of
                                                &quot;abort&quot;
                                            </h2>
                                            <p>
                                                I&#8217;m actually pretty okay
                                                with Python doctest&#8217;s
                                                notion that you just run all the
                                                tests, even when one fails.
                                                Getting too many failures is a
                                                bit of a nuisance, but
                                                it&#8217;s not
                                                <em>that bad</em>. But
                                                there&#8217;s no way to just
                                                give up, and there needs to be.
                                                If you are relying on something
                                                to be importable, or some
                                                service to be available,
                                                there&#8217;s no point in going
                                                on with the tests.
                                            </p>
                                            <p>
                                                Doctest.js lets you call
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >Abort()</span
                                                    ></tt
                                                >
                                                and further tests are cancelled.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="distinguishing-between-debugging-output-and-deliberate-output"
                                        >
                                            <h2>
                                                Distinguishing between debugging
                                                output and deliberate output
                                            </h2>
                                            <p>
                                                Maybe it&#8217;s my own fault
                                                for being a programming
                                                troglodite, but I use a lot of
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >print</span
                                                    ></tt
                                                >
                                                for debugging. This becomes a
                                                real problem with Python&#8217;s
                                                doctest, as it tracks all that
                                                printing and it causes tests to
                                                fail.
                                            </p>
                                            <p>
                                                Javascript has something
                                                <em>specifically for</em>
                                                printing debugging output:
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >console.log()</span
                                                    ></tt
                                                >. Doctest.js doesn&#8217;t mess
                                                with that, it adds a new
                                                function
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >print()</span
                                                    ></tt
                                                >. Only stuff that is printed
                                                (not logged) is treated as
                                                expected output. It&#8217;s like
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >console.log()</span
                                                    ></tt
                                                >
                                                goes to stderr and
                                                <tt class="docutils literal"
                                                    ><span class="pre"
                                                        >print()</span
                                                    ></tt
                                                >
                                                goes to stdout.
                                            </p>
                                            <p>
                                                Doctest.js also forces the
                                                developer to print everything
                                                they care about. For better or
                                                worse Javascript has many more
                                                expressions than Python
                                                (including assignments), so
                                                looking at the result of an
                                                expression isn&#8217;t a good
                                                clue for whether you
                                                <em>care</em> about the result
                                                of an expression. I&#8217;m not
                                                sure this is <em>better</em>,
                                                but it&#8217;s part of the
                                                difference.
                                            </p>
                                            <p>
                                                Doctest.js also groups your
                                                printed statements according to
                                                the example you are in (an
                                                example being a block of code
                                                and an expected output). This is
                                                much more helpful than watching
                                                a giant stream of output go to
                                                the console (the browser console
                                                or terminal).
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="doctest-js-handles-async-code"
                                        >
                                            <h2>
                                                Doctest.js handles async code
                                            </h2>
                                            <p>
                                                This admittedly isn&#8217;t that
                                                big a deal for Python, but for
                                                Javascript it is a real problem.
                                                Not a problem for doctest.js in
                                                particular, but a problem for
                                                any Javascript test framework.
                                                You want to test return values,
                                                but lots of functions
                                                don&#8217;t &quot;return&quot;,
                                                instead they call some callback
                                                or create some kind of promise
                                                object, and you have to test for
                                                side effects.
                                            </p>
                                            <p>
                                                Doctest.js I think has a
                                                <a
                                                    class="reference external"
                                                    href="http://doctestjs.org/tutorial.html#async"
                                                    >really great answer for
                                                    this</a
                                                >, which is not so much to say
                                                that Python&#8217;s doctest is
                                                so much worse, but in the
                                                context of Javascript doctest.js
                                                has something really useful and
                                                unique. If callback-driven async
                                                code had ever been very popular
                                                in Python then this sort of
                                                feature would be nice there too.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="the-browser-is-a-great-environment"
                                        >
                                            <h2>
                                                The browser is a great
                                                environment
                                            </h2>
                                            <p>
                                                A lot of where doctest.js is
                                                much better than Python&#8217;s
                                                doctest is simply that it has a
                                                much more powerful environment
                                                for displaying results. It can
                                                highlight failed or passing
                                                tests. When there&#8217;s a
                                                wildcard in expected output, it
                                                can show the actual output
                                                without adding any particular
                                                extra distraction. It can group
                                                console messages with the tests
                                                they go with. It can show
                                                <em>both</em> a simple failure
                                                message, and a detailed
                                                line-by-line comparison. All
                                                these details make it easy to
                                                identify what went wrong and fix
                                                it. The browser gives a rich and
                                                navigable interface.
                                            </p>
                                            <p>
                                                I&#8217;d <em>like</em> to get
                                                doctest.js working well on
                                                Node.js (right now it works, but
                                                is not appealing), but I just
                                                can&#8217;t bring myself to give
                                                up the browser. I have to figure
                                                out a good hybrid.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="python-s-doctest-lacks-a-champion"
                                        >
                                            <h2>
                                                Python&#8217;s doctest lacks a
                                                champion
                                            </h2>
                                            <p>
                                                This is ultimately the reason
                                                Python&#8217;s doctest has all
                                                these problems: no one cares
                                                about it, no one feels
                                                responsible for it, and no one
                                                feels empowered to make
                                                improvements to it. And to make
                                                things worse there is a cadre of
                                                people that will respond to
                                                suggestions with their own
                                                criticisms that doctest should
                                                never be used beyond its
                                                original niche, that it&#8217;s
                                                constraints are features.
                                            </p>
                                        </div>
                                        <div
                                            class="section"
                                            id="doctest-is-still-great"
                                        >
                                            <h2>Doctest is still great</h2>
                                            <p>
                                                I&#8217;m ragging on
                                                Python&#8217;s doctest only
                                                because I love it. I wish it was
                                                better, and I made doctest.js in
                                                a way I wish Python&#8217;s
                                                doctest was made. Doctest, and
                                                more generally
                                                example/expectation oriented
                                                code, is a great way to explain
                                                things, to make tests readable,
                                                to make test-driven development
                                                feasible, to create an
                                                environment that errs on the
                                                side of over-testing instead of
                                                under-testing, and to make
                                                failures and resolutions
                                                symmetric. It&#8217;s still
                                                <a
                                                    class="reference external"
                                                    href="../../behavior-driven-programming.html"
                                                    >vastly superior to BDD</a
                                                >, avoiding all BDD&#8217;s
                                                aping of readability while still
                                                embracing the sense of
                                                test-as-narrative.
                                            </p>
                                            <p>
                                                But, more to the point:
                                                <a
                                                    class="reference external"
                                                    href="http://doctestjs.org"
                                                    >use doctest.js</a
                                                >,
                                                <a
                                                    class="reference external"
                                                    href="http://doctestjs.org/tutorial.html"
                                                    >read the tutorial</a
                                                >, or
                                                <a
                                                    class="reference external"
                                                    href="http://doctestjs.org/try.html"
                                                    >try it in the browser</a
                                                >. I swear, it&#8217;s
                                                <em>really nice to use</em>.
                                            </p>
                                        </div>
                                    </div>
                                    <!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/"
    dc:identifier="https://ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/"
    dc:title="Why doctest.js is better than Python&#8217;s doctest"
    trackback:ping="https://ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/trackback/" />
</rdf:RDF> -->
                                </div>
                                <!-- END POST-ENTRY -->
                            </div>
                            <!-- END POST-CONTENT  -->
                        </div>
                        <!-- END-CONTAINER -->
                        <div class="post-header">
                            <h3 class="post-date">2012 10 02</h3>
                            <p class="post-categories">
                                <a
                                    href="../../category/javascript/index.html"
                                    title="View all posts in Javascript"
                                    rel="category tag"
                                    >Javascript</a
                                ><br /><a
                                    href="../../category/mozilla/index.html"
                                    title="View all posts in Mozilla"
                                    rel="category tag"
                                    >Mozilla</a
                                ><br /><a
                                    href="../../category/programming/index.html"
                                    title="View all posts in Programming"
                                    rel="category tag"
                                    >Programming</a
                                ><br /><a
                                    href="../../category/python/index.html"
                                    title="View all posts in Python"
                                    rel="category tag"
                                    >Python</a
                                >
                            </p>
                            <p class="post-comments">
                                <a
                                    href="../../index.html?p=291#comments"
                                    title="Comment on Why doctest.js is better than Python&#8217;s doctest"
                                    >Comments (19)</a
                                >
                            </p>
                            <p class="post-permalink">
                                <a
                                    href="../../index.html?p=291"
                                    title="Permalink to Why doctest.js is better than Python&#8217;s doctest"
                                    rel="permalink"
                                    >Permalink</a
                                >
                            </p>
                        </div>
                        <!-- END POST-FOOTER -->
                    </div>
                    <!-- END POST -->

                    <div class="navigation">
                        <div class="alignleft"></div>
                        <div class="alignright"></div>
                    </div>
                    <!-- END NAVIGATION -->
                </div>
                <!-- END CONTENT -->
            </div>
            <!-- END CONTAINER  -->

            <div id="sidebar">
                <ul>
                    <li id="home-link">
                        <h2>
                            <a
                                href="../../index.html"
                                title="Ian Bicking: a blog"
                                >Home</a
                            >
                        </h2>
                    </li>
                    <li id="text-315934862" class="widget widget_text">
                        <h2 class="widgettitle">About</h2>
                        <div class="textwidget">
                            Ian is a developer with Mozilla,
                            <a href="http://ianbicking.appspot.com/projects"
                                >Python open source developer</a
                            >, actually uses
                            <a
                                href="https://plus.google.com/u/0/104537541227697934010/posts"
                                >Google+</a
                            >
                            more than
                            <a href="http://twitter.com/ianbicking">twitter</a>
                            and lives in Minneapolis.<br />
                            <span
                                class="gittip-0001"
                                gittip-username="ianbicking"
                            ></span>
                            <script
                                id="gittip-0001"
                                src="https://www.gittip.com/assets/widgets/0001.js"
                            ></script>
                        </div>
                    </li>
                    <li id="text-315934863" class="widget widget_text">
                        <div class="textwidget">
                            <!-- <script type="text/javascript">mbgc='f5f5f5';ww='160';mbc='cecece';bbc='3F79D5';bmobc='3b71c6';bbgc='4889F0';bmoc='3F79D5';bfc='FFFFFF';bmofc='ffffff';tlc='cecece';tc='6a6a6a';nc='6a6a6a';bc='6a6a6a';l='y';fs='16';fsb='13';bw='100';ff='4';lu='6a6a6a';pc='4889F0';wh='340';b='s'; pid='104537541227697934010';</script><script type="text/javascript" src="http://widgetsplus.com/google_plus_widget.js"></script> -->
                        </div>
                    </li>
                    <li id="archives-2" class="widget widget_archive">
                        <h2 class="widgettitle">Archives</h2>
                        <ul>
                            <li>
                                <a href="index.html" title="October 2012"
                                    >October 2012</a
                                >
                            </li>
                            <li>
                                <a href="../02/index.html" title="February 2012"
                                    >February 2012</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2011/04/index.html"
                                    title="April 2011"
                                    >April 2011</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2011/03/index.html"
                                    title="March 2011"
                                    >March 2011</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/09/index.html"
                                    title="September 2010"
                                    >September 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/08/index.html"
                                    title="August 2010"
                                    >August 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/05/index.html"
                                    title="May 2010"
                                    >May 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/04/index.html"
                                    title="April 2010"
                                    >April 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/03/index.html"
                                    title="March 2010"
                                    >March 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/02/index.html"
                                    title="February 2010"
                                    >February 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2010/01/index.html"
                                    title="January 2010"
                                    >January 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2009/09/index.html"
                                    title="September 2009"
                                    >September 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2009/05/index.html"
                                    title="May 2009"
                                    >May 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2009/04/index.html"
                                    title="April 2009"
                                    >April 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2009/01/index.html"
                                    title="January 2009"
                                    >January 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/12/index.html"
                                    title="December 2008"
                                    >December 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/11/index.html"
                                    title="November 2008"
                                    >November 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/10/index.html"
                                    title="October 2008"
                                    >October 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/09/index.html"
                                    title="September 2008"
                                    >September 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/08/index.html"
                                    title="August 2008"
                                    >August 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/07/index.html"
                                    title="July 2008"
                                    >July 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/06/index.html"
                                    title="June 2008"
                                    >June 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/05/index.html"
                                    title="May 2008"
                                    >May 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/04/index.html"
                                    title="April 2008"
                                    >April 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/03/index.html"
                                    title="March 2008"
                                    >March 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/02/index.html"
                                    title="February 2008"
                                    >February 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2008/01/index.html"
                                    title="January 2008"
                                    >January 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/11/index.html"
                                    title="November 2007"
                                    >November 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/10/index.html"
                                    title="October 2007"
                                    >October 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/09/index.html"
                                    title="September 2007"
                                    >September 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/08/index.html"
                                    title="August 2007"
                                    >August 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../2007/07/index.html"
                                    title="July 2007"
                                    >July 2007</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li id="text-315934861" class="widget widget_text">
                        <div class="textwidget">
                            <a href="../../archive/index.html"
                                >The Older Archives</a
                            >
                        </div>
                    </li>
                    <li id="categories-1" class="widget widget_categories">
                        <h2 class="widgettitle">Categories</h2>
                        <ul>
                            <li class="cat-item cat-item-12">
                                <a
                                    href="../../category/erlang/index.html"
                                    title="View all posts filed under Erlang"
                                    >Erlang</a
                                >
                            </li>
                            <li class="cat-item cat-item-11">
                                <a
                                    href="../../category/html/index.html"
                                    title="View all posts filed under HTML"
                                    >HTML</a
                                >
                            </li>
                            <li class="cat-item cat-item-8">
                                <a
                                    href="../../category/javascript/index.html"
                                    title="View all posts filed under Javascript"
                                    >Javascript</a
                                >
                            </li>
                            <li class="cat-item cat-item-15">
                                <a
                                    href="../../category/licensing/index.html"
                                    title="View all posts filed under Licensing"
                                    >Licensing</a
                                >
                            </li>
                            <li class="cat-item cat-item-18">
                                <a
                                    href="../../category/mozilla/index.html"
                                    title="View all posts filed under Mozilla"
                                    >Mozilla</a
                                >
                            </li>
                            <li class="cat-item cat-item-5">
                                <a
                                    href="../../category/notech/index.html"
                                    title="View all posts filed under Non-technical"
                                    >Non-technical</a
                                >
                            </li>
                            <li class="cat-item cat-item-6">
                                <a
                                    href="../../category/olpc/index.html"
                                    title="View all posts filed under OLPC"
                                    >OLPC</a
                                >
                            </li>
                            <li class="cat-item cat-item-14">
                                <a
                                    href="../../category/packaging/index.html"
                                    title="View all posts filed under Packaging"
                                    >Packaging</a
                                >
                            </li>
                            <li class="cat-item cat-item-4">
                                <a
                                    href="../../category/politics/index.html"
                                    title="View all posts filed under Politics"
                                    >Politics</a
                                >
                            </li>
                            <li class="cat-item cat-item-3">
                                <a
                                    href="../../category/programming/index.html"
                                    title="View all posts filed under Programming"
                                    >Programming</a
                                >
                            </li>
                            <li class="cat-item cat-item-7">
                                <a
                                    href="../../category/python/index.html"
                                    title="View all posts filed under Python"
                                    >Python</a
                                >
                            </li>
                            <li class="cat-item cat-item-10">
                                <a
                                    href="../../category/ruby/index.html"
                                    title="View all posts filed under Ruby"
                                    >Ruby</a
                                >
                            </li>
                            <li class="cat-item cat-item-19">
                                <a
                                    href="../../category/security/index.html"
                                    title="View all posts filed under Security"
                                    >Security</a
                                >
                            </li>
                            <li class="cat-item cat-item-16">
                                <a
                                    href="../../category/silverlining.1"
                                    title="View all posts filed under Silver Lining"
                                    >Silver Lining</a
                                >
                            </li>
                            <li class="cat-item cat-item-20">
                                <a
                                    href="../../category/programming/testing/index.html"
                                    title="View all posts filed under Testing"
                                    >Testing</a
                                >
                            </li>
                            <li class="cat-item cat-item-9">
                                <a
                                    href="../../category/web/index.html"
                                    title="View all posts filed under Web"
                                    >Web</a
                                >
                            </li>
                            <li class="cat-item cat-item-13">
                                <a
                                    href="../../category/zopeplone/index.html"
                                    title="View all posts filed under Zope/Plone"
                                    >Zope/Plone</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li id="search-2" class="widget widget_search">
                        <form
                            id="searchform"
                            method="get"
                            action="../../index.html"
                        >
                            <div>
                                <input
                                    id="s"
                                    name="s"
                                    type="text"
                                    value=""
                                    tabindex="1"
                                    size="10"
                                />
                                <input
                                    id="searchsubmit"
                                    name="searchsubmit"
                                    type="submit"
                                    value="Find"
                                    tabindex="2"
                                />
                            </div>
                        </form>
                    </li>
                    <li
                        id="recent-posts-2"
                        class="widget widget_recent_entries"
                    >
                        <h2 class="widgettitle">Recent Posts</h2>
                        <ul>
                            <li>
                                <a
                                    href="../../index.html?p=291"
                                    title="Why doctest.js is better than Python&#8217;s doctest"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../index.html?p=283"
                                    title="Python Application Package"
                                    >Python Application Package</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../index.html?p=277"
                                    title="Git-as-sync, not source-control-as-deployment"
                                    >Git-as-sync, not
                                    source-control-as-deployment</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../index.html?p=253"
                                    title="My Unsolicited Advice For PyPy"
                                    >My Unsolicited Advice For PyPy</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../index.html?p=250"
                                    title="A Python Web Application Package and Format (we should make one)"
                                    >A Python Web Application Package and Format
                                    (we should make one)</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li
                        id="recent-comments-2"
                        class="widget widget_recent_comments"
                    >
                        <h2 class="widgettitle">Recent Comments</h2>
                        <ul id="recentcomments">
                            <li class="recentcomments">
                                <a
                                    href="http://www.mirsa.com.tr"
                                    rel="external nofollow"
                                    class="url"
                                    >havalandrma</a
                                >
                                on
                                <a
                                    href="02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-228633"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                <a
                                    href="http://redealmeidense.com.br/portalx/modules/"
                                    rel="external nofollow"
                                    class="url"
                                    >this website</a
                                >
                                on
                                <a
                                    href="02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-196267"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                Eric Pierce on
                                <a
                                    href="02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195322"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                Paul Brian on
                                <a
                                    href="02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195321"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                <a
                                    href="http://benjiyork.com"
                                    rel="external nofollow"
                                    class="url"
                                    >Benji York</a
                                >
                                on
                                <a
                                    href="02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195320"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div id="footer">
                <p>
                    &copy; 2013 Ian<!--
Does this commenting make me evil?
			|
			Thanks, <a href="http://wordpress.org/" title="WordPress">WordPress</a>
			|
			<a href="http://www.plaintxt.org/themes/barthelme/" title="Barthelme for WordPress" rel="follow">Barthelme</a> theme by <a href="http://scottwallick.com/" title="scottwallick.com" rel="follow">Scott</a>
			| <!-- The following is a link to the theme author's sponsor. Please consider its smallness and that Scott was nice enough to make this theme publically available. -->
                    Sponsor:
                    <a
                        href="http://www.active-sandals.com/womreefsan.html"
                        title="Support: Reef Sandals"
                        >Reef Sandals</a
                    >
                    | Valid
                    <a
                        href="http://validator.w3.org/check?uri=http://blog.ianbicking.org&amp;outline=1&amp;verbose=1"
                        title="Valid XHTML 1.0 Strict"
                        rel="nofollow"
                        >XHTML</a
                    >
                    &amp;
                    <a
                        href="http://jigsaw.w3.org/css-validator/validator?uri=https://ianbicking.org/wp-content/themes/Barthelme-ianb/style.css&amp;profile=css2&amp;warning=no"
                        title="Valid CSS"
                        rel="nofollow"
                        >CSS</a
                    >
                    | --> RSS:
                    <a
                        href="../../feed/rss/index.html"
                        title="Ian Bicking: a blog RSS 2.0 (XML) Feed"
                        rel="alternate"
                        type="application/rss+xml"
                        >Posts</a
                    >
                    &amp;
                    <a
                        href="../../comments/feed/index.html"
                        title="Ian Bicking: a blog Comments RSS 2.0 (XML) Feed"
                        rel="alternate"
                        type="application/rss+xml"
                        >Comments</a
                    >
                </p>
            </div>
        </div>
        <!-- END WRAPPER -->

        <!-- Somehow 35 queries occured in 1.191 seconds. Magic! -->
        <!-- The "Barthelme" theme copyright (c) 2006 Scott Allan Wallick - http://www.plaintxt.org/themes/ -->

        <!-- Google Analytics -->
        <script
            src="http://www.google-analytics.com/urchin.js"
            type="text/javascript"
        ></script>
        <script type="text/javascript">
            _uacct = "UA-2442258-1";
            urchinTracker();
        </script>
    </body>
</html>
