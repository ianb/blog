<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Re: Python templating languages</title>
        <link rel="stylesheet" href="WK/default.css" type="text/css" />
        <link
            rel="alternate"
            type="application/rss+xml"
            title="New Posts"
            href="https://ianbicking.org/feeds/new_pages.xml"
        />
    </head>
    <body color="black" bgcolor="white">
        <h1 id="header">
            <a href="index.html">Ian Bicking: the old part of his blog</a>
        </h1>

        <div style="float: right">
            <script type="text/javascript">
                google_ad_client = "pub-2913402032659646";
                google_ad_width = 120;
                google_ad_height = 600;
                google_ad_format = "120x600_as";
                google_ad_type = "text";
                google_ad_channel = "";
                google_color_border = "336699";
                google_color_bg = "FFFFFF";
                google_color_link = "0000FF";
                google_color_text = "000000";
                google_color_url = "008000";
                //-->
            </script>
        </div>
        <h1>Re: Python templating languages</h1>
        <p>
            Just looked at
            <a
                href="http://80.65.228.140:2290//blog/europython2004/paper/#learning-curve"
                >Python Templating Languages</a
            >. I'm familiar with the main three (DTML, ZPT, and Cheetah). I
            assume the fourth (STL) is written by the author. I don't really
            agree with the way the paper lays out the issues, though it appears
            to be a draft. Here's how I'd score it (leaving out STL, which I
            don't know about): table.comparison td { border: 1px #666666 solid;
            }
        </p>

        <table class="comparison">
            <th></th>
            <th>Cheetah</th>
            <th>DTML</th>
            <th>ZPT</th>

            <tr>
                <td>Documentation</td>
                <td>3</td>
                <td>2</td>
                <td>2</td>
            </tr>

            <tr>
                <td colspan="4">
                    How can the
                    <a href="http://cheetahtemplate.org/docs/users_guide_html/"
                        >Cheetah</a
                    >
                    <a href="http://cheetahtemplate.org/docs/devel_guide_html/"
                        >docs</a
                    >
                    not get a 3? ZPT is generally better documented than DTML,
                    as it has a more easily documented scope, but it's a close
                    call. They both have a considerable quantity of
                    documentation, but both suffer from a lack of
                    well-structured documentation, and have poorly documented
                    corners. The internals (analogous to what Cheetah's
                    Developers' Guide covers) are not documented much at all --
                    probably because they are meant only for a single
                    environment (Zope). ZPT and DTML are documented in many
                    books, but the books tend to be spotty.
                </td>
            </tr>

            <tr>
                <td>Community</td>
                <td>2</td>
                <td>2</td>
                <td>3</td>
            </tr>

            <tr>
                <td>Easiness to fix errors</td>
                <td>1</td>
                <td>0</td>
                <td>3</td>
            </tr>

            <tr>
                <td colspan="4">
                    Debugging Cheetah means reading through the generated Python
                    source, which isn't so good. There are also some misleading
                    error messages that can occur. So that's not so hot. Still
                    better than the travesty that is DTML. ZPT does really well,
                    though -- excellent tracebacks, helpful parse errors.
                </td>
            </tr>

            <tr>
                <td>Easiness to update</td>
                <td colspan="3">I don't really get this one</td>
            </tr>

            <tr>
                <td>Easiness to refactor</td>
                <td colspan="3">
                    This one is subtle, and depends on a lot more than just the
                    templating mechanism. It's too hard to judge for me.
                </td>
            </tr>

            <tr>
                <td>Learning curve</td>
                <td>2</td>
                <td>2</td>
                <td>1</td>
            </tr>

            <tr>
                <td colspan="4">
                    I think the imperative style of Cheetah and DTML is easier
                    to understand, at least for someone that works with HTML
                    textually (i.e., not through a WYSIWYG editor or other
                    structured editor). Cheetah is also easier for a Python
                    programmer -- probably easier than DTML in this case --
                    because it parallels Python. ZPT's promise of allowing
                    people to edit code with a WYSIWYG editor has not panned
                    out, and I don't think it is a practical goal at this time.
                </td>
            </tr>

            <tr>
                <td>Allow embedded code</td>
                <td>2</td>
                <td>0</td>
                <td>2</td>
            </tr>

            <tr>
                <td colspan="4">
                    I
                    <a
                        href="http://blog.colorstudy.com/ianb/weblog/2003/10/31.html#P23"
                        >disagree with the author</a
                    >
                    on fundamentals here -- I think embedded code is good,
                    though potentially dangerous. I think ZPT makes a pretty
                    good compromise here, though depending on how you structure
                    your code, Cheetah could be better. I can't really decide.
                    However, DTML's embedded code is a travesty. STL's lack of
                    simple operators (like not:) is nothing to be proud of --
                    ZPT's tags are all there for a reason, and I've used all of
                    them, and it's not because I'm breaking the MVC barrier. As
                    I've gotten more used to ZPT, I rely on Python Scripts more
                    and ZPT less for calculations, but I still use Python often
                    in ZPT -- how else can you make a
                    <tt>&lt;select&gt;</tt> element?
                </td>
            </tr>

            <tr>
                <td>Is the template valid HTML</td>
                <td>1</td>
                <td>0</td>
                <td>3</td>
            </tr>

            <tr>
                <td colspan="4">
                    Cheetah actually can be valid HTML, depending on your
                    template, while DTML cannot. And DTML's interaction with
                    HTML is obnoxious, e.g.:
                    <tt>&lt;a href="&lt;dtml-var a_url url_quote&gt;"&gt;</tt>.
                    That's just horrid. There's also a downside that the author
                    doesn't mention, that Cheetah and DTML can be used to create
                    non-HTML (email, config files, etc), while ZPT cannot.
                </td>
            </tr>

            <tr>
                <td>Elegance</td>
                <td>2</td>
                <td>0</td>
                <td>2</td>
            </tr>

            <tr>
                <td colspan="4">
                    This is obviously a subjective measure. I can only say that
                    DTML sucks from many perspectives, while Cheetah and ZPT
                    suck only from a few perspectives. ZPT is tiresome to write.
                    Cheetah allows invalid markup. DTML is tiresome to write
                    <b>and</b> allows invalid markup. And so on.
                </td>
            </tr>

            <tr>
                <td>Render speed</td>
                <td>3</td>
                <td>2</td>
                <td>1</td>
            </tr>

            <tr>
                <td colspan="4">
                    I'm guessing here, but these are from my general experience.
                    Cheetah compiles to Python, so it's very fast (well, at
                    least comparable to Python). DTML is interpreted, but ZPT is
                    noticeably slower.
                </td>
            </tr>
        </table>

        <p>
            There are perhaps some other important templating languages out
            there. DTML <i>isn't</i> an important language.
            <b>No one should use DTML</b>, unless you are developing a legacy
            Zope application. Or, sadly, when generating email or SQL in Zope,
            but that's just an unfortunate corner case. No one outside of Zope
            can reasonably use DTML (and there's no reason to). ZPT is the way
            to go (and it can be used outside of Zope:
            <a href="http://zpt.sf.net">zpt.sf.net</a>,
            <a href="http://www.owlfish.com/software/simpleTAL/">SimpleTAL</a>).
        </p>

        <p>
            Some other, more interesting templating languages might be
            <a href="http://spyce.sourceforge.net/">Spyce</a>, which embeds
            Python in the markup (as easy to learn as Python, but obviously with
            issues), or <a href="http://htmltmpl.sourceforge.net/">htmltmpl</a>,
            which is interesting in that it supports Python and PHP, and is a
            better example than DTML of a tag-based templating language. There's
            also
            <a
                href="http://nevow.com/Nevow2004Tutorial.html#html-based-templates"
                >Nevow</a
            >, for another ZPT-style templating system. Finally, there's a
            <a
                href="http://www.python.org/cgi-bin/moinmoin/WebProgramming#head-9d0636d6da8e88f8f09de1454c5961b44183b04d"
                >list</a
            >
            of templating languages on the Python Wiki, though it's not
            complete.
        </p>

        <div class="dates" align="right">
            Created 18 Jun '04<br />
            Modified 14 Dec '04
        </div>
        <hr noshade />
        <h3 id="comments">Comments:</h3>
        <blockquote>
            I edit ZPT in GoLive often. It took only some minor coaxing and you
            do have to keep an eye on what's going on when working in visual
            mode, but it *can* work.
            <br />

            <br />
            Beyond that, ZPT has really really gelled in my brain, with or
            without a visual or structured editor. It is a weird learning curve
            as it's a style that's somewhere between imperative structures like
            Cheetah and whatever XSLT is.
            <br />

            <br />
            Thanks to ZPT, I've stopped treating HTML textually, almost
            completely. Each select widget, hyperlink, becomes a living
            breathing object instead of merely a placeholder for a value to be
            inserted. I really like that it allows me to do this without my
            having to wrap my head around more painful DOM concepts.
            <br />

            <br />
            ZPT *can* be used to make non-HTML files, but it's painful and is
            stepping outside its design goals. But it can be done (I see people
            do it on occasion, and I'm always shocked).
            <br />

            <br />
            I especially agree with you on ZPT's compromise on embedded code.
            The TALES engine (which potentially allows other expression
            languages to be installed) is a really nice feature, and I like that
            you can use Python to do complex conditionals, extra formatting, and
            so on, without yet another micro-language having to be invented. The
            TALES engine also allows the actual TAL language definition to
            remain quite small and simple.
            <br />

            <br />
            With very few exceptions, all of my sites have been much easier to
            maintain since moving to ZPT, and it's been a lot easier to work
            with our design team. The developers still add in almost all of the
            TAL/METAL statements when they hand us their designs, but the big
            savings tend to come when we have to do major design changes.
            <div align="right">
                <a href="https://ianbicking.org/comment174.html" rel="nofollow"
                    >#</a
                >
                <a href="http://toulouse.amber.org/">Jeffrey Shell</a>
            </div>
            <hr noshade />
            em.py is also a nice and fast templating system.
            <div align="right">
                <a href="https://ianbicking.org/comment175.html" rel="nofollow"
                    >#</a
                >
                Frank
            </div>
            <hr noshade />
            When I was looking for a new templating system for
            <a href="http://roundup.sf.net/" target="_blank">Roundup</a>, I
            settled on ZPT pretty quickly. I have the occasional Roundup user
            who complains about the complexity (while, at the same time, being
            able to get the job done), but most users are happy with it. The
            i18n stuff in ZPT can be fiddly though.
            <br />

            <br />
            Personally, the ZPT design (TAL, TALES, METAL) just work for me.
            <br />

            <br />
            One issue that's come up in Roundup though is templating of plain
            text. As Jeffrey points out, non (HT+X)ML is something that ZPT is
            definitely *not* targetted at (and is why DTML persists in Zope, as
            you point out). Still looking for something elegant there -- I
            wonder if anyone's implemented a perl-format-alike in Python...
            <br />

            <br />
            Note that SimpleTAL isn't a complete implementation, and isn't as
            mature. It's definitely usable, and is getting more mature though.
            <div align="right">
                <a href="https://ianbicking.org/comment176.html" rel="nofollow"
                    >#</a
                >
                <a href="http://www.mechanicalcat.net/richard/log"
                    >Richard Jones</a
                >
            </div>
            <hr noshade />
            Ian: "There's also Nevow, for another ZPT-style templating system."
            <br />

            <br />
            Nitpick: I think this mischaracterises Nevow somewhat, as there's a
            significant difference in how Nevow (specifically Nevow.renderer)
            and ZPT work. While ZPT keeps its basic flow control structures into
            HTML templates, Nevow does all flow control from Python via a
            programmatic interface. Templating systems like Nevow, PyMeld and my
            HTMLTemplate are conceptually closer to DOM and desktop-GUI systems
            than to macro-descended/influenced embedded templating
            language-based systems like PHP, Cheetah, TAL, etc.
            <br />

            <br />
            (Historical note: It was actually ZPT that gave me the original idea
            for HTMLTemplate. I just took the custom tag attributes and
            callback-into-Python concepts, boiled them down as far as they could
            go, and fused them to what I already knew about DOM and application
            scripting.)
            <br />

            <br />
            BTW, I'm not sure why the paper's author classes STL with PyMeld, as
            STL falls into the embedded language camp. He also seems to suggest
            that PyMeld is templating language-based, which it's not. Anyway, I
            thought the paper read more like a puff-piece for STL than a
            objective assessment of the full templating engine arena. Not that I
            object to puff per-se, but I do think it should have provided a full
            disclosure so readers will know where the author is coming from. A
            pity, as with all the different templating systems currently
            floating about it would be nice to have a really good, objective
            comparison to help both developers and users judge their pros and
            cons better.
            <div align="right">
                <a href="https://ianbicking.org/comment177.html" rel="nofollow"
                    >#</a
                >
                <a href="http://freespace.virgin.net/hamish.sanderson/">has</a>
            </div>
            <hr noshade />
            I have bloged this at
            <br />

            <br />
            <a
                href="http://davew.typepad.com/42/2004/06/ian_bicking_pyt.html"
                target="_blank"
                >http://davew.typepad.com/42/2004/06/ian_bicking_pyt.html</a
            >
            <br />

            <br />
            Tried trackback and it did not work.
            <div align="right">
                <a href="https://ianbicking.org/comment178.html" rel="nofollow"
                    >#</a
                >
                <a href="http://davew.typepad.com/42">Dave Warnock</a>
            </div>
            <hr noshade />
            I wanted to find out more about STL, but Olivier Guilloux's article
            didn't appear to provide a reference. However he mentions that STL
            is used by the itools community. It turns out that STL is part of J
            David Ibáñez's itools package.
            <div align="right">
                <a href="https://ianbicking.org/comment179.html" rel="nofollow"
                    >#</a
                >
                Hamish Lawson
            </div>
            <hr noshade />
            I'm always amused to see that "you can't generate plain text with a
            ZPT" given that I first read this immediately after editing an ZPT
            that did exactly that. It's certainly hammering a square peg into a
            round hole, though.
            <br />

            <br />
            I really like ZPTs. I'm not sure why, I guess it's because they were
            designed by people who actually knew what a templating system was
            FOR.
            <div align="right">
                <a href="https://ianbicking.org/comment180.html" rel="nofollow"
                    >#</a
                >
                <a href="http://starship.python.net/crew/mwh">Michael Hudson</a>
            </div>
            <hr noshade />
            One of my needs is to place style information into HTML. My
            <br />
            application uses wxPython which in turn uses wxWidgets. The
            <br />
            wxWidgets HTML viewer does not support style sheets, or the
            <br />
            class attribute. This is actually the hard part. The templating
            <br />
            itself is actually easy.
            <br />

            <br />
            This is what I do at the moment:
            <br />

            <br />
            - First pass over the template using xyaptu from the Python
            <br />
            cookbook. This is an example template:
            <br />

            <br />
            <a
                href="http://cvs.sf.net/viewcvs.py/bitpim/bitpim/resources/pblayout.xy?view=markup"
                target="_blank"
                >http://cvs.sf.net/viewcvs.py/bitpim/bitpim/resources/pblayout.xy?view=markup</a
            >
            <br />

            <br />
            In particular note that I do use class attributes which
            <br />
            are ignored by the wxWidgets HTML viewer.
            <br />

            <br />
            - Do a second pass using HTMLParser.HTMLParser which generates a
            <br />
            tree of the document structure (it also requires the HTML to
            <br />
            be perfect with *all* tags having matching closes. I then have
            <br />
            a file that defines styles.
            <br />

            <br />
            <a
                href="http://cvs.sf.net/viewcvs.py/bitpim/bitpim/resources/styles.xy?view=markup"
                target="_blank"
                >http://cvs.sf.net/viewcvs.py/bitpim/bitpim/resources/styles.xy?view=markup</a
            >
            <br />

            <br />
            That says where to inject style information. The dict says what
            <br />
            attributes to add to the tag the class was found in (the '' case)
            <br />
            and then also lists how tags contained within should be modified.
            <br />
            Later down there are also tags that get added.
            <br />

            <br />

            <br />
            So I have a fairly big mess. I am having to simulate style-sheets,
            <br />
            produce 100% correct HTML and also have various value formatting
            <br />
            functions all over the place.
            <br />

            <br />
            I actually like PHP's Smarty the best, mainly for the modifiers
            <br />
            and being able to do things like capture.
            <br />
            <div align="right">
                <a href="https://ianbicking.org/comment181.html" rel="nofollow"
                    >#</a
                >
                <a href="http://bitpim.sf.net">Roger Binns</a>
            </div>
            <hr noshade />

            <div class="document">
                <p>
                    For repetitively updated information, specifically
                    server-pushed real-time industrial process displays, I think
                    that PyMeld is particularly appropriate (and elegant in its
                    Pythonic simplicity). The same approach for (X)HTML extends
                    automatically to SVG, whose future blending is represented
                    by recent Firefox/Mozilla development. Additionally, any
                    other templating scheme can still be used to publish
                    &quot;snapshots&quot; of the displays as well.
                </p>
            </div>
            <div align="right">
                <a
                    href="https://ianbicking.org/re-python-templating-languages-comment-1.html"
                    rel="nofollow"
                    >#</a
                >
                <a href="http://njp.us">Norm Petterson</a>
            </div>
            <hr noshade />
            <blockquote>
                <div class="document">
                    <p>
                        I love PyMeld and think its a fantastic system, but in
                        real life situations it is extremely slow in my
                        experience. At some stage I will try and do some formal
                        benchmarks but for a recent project (<a
                            class="reference"
                            href="http://muti.co.za"
                            >http://muti.co.za</a
                        >) I started off using PyMeld and then abandoned it. I
                        found that in generating a table with multiple rows
                        (around 30 or so) using the recipe described by the
                        PyMeld author, it was two orders of magnitude slower
                        than Pythons &quot;%&quot; native templates.
                    </p>
                    <p>
                        I then tried Cheetah, and although it is faster than
                        PyMeld to my horror I found that it is 1 order of
                        magnitude slower than straight &quot;%&quot; templates.
                        This was Cheetah 1.0 (At the time I did this 2.0RC1 was
                        out but I didnt try it). I at first thought this was
                        because I wasnt using the compilation functionality but
                        I found that compiling the templates produced very
                        little difference with the same 30 line table.
                    </p>
                    <p>
                        I also tried the new Python 2.4 template engine in the
                        string module, and this was disapointing in that it was
                        marginally slower than % templates and also has no
                        support for numeric formatting. I probably could have
                        used Cheetah but I am very picky about performance and
                        in the end I could not justify an order of magnitude
                        performance hit so I am using straight % templates until
                        I can find a higher performing template engine.
                    </p>
                </div>
                <div align="right">
                    <a
                        href="https://ianbicking.org/re-python-templating-languages-comment-2.html"
                        rel="nofollow"
                        >#</a
                    >
                    <a href="http://muti.co.za">thakadu</a>
                </div>
                <hr noshade />
                <blockquote>
                    <div class="document">
                        <p>
                            <a
                                class="reference"
                                href="http://www.plope.com/software/meld3"
                                >meld3</a
                            >
                            might be faster than PyMeld. For Cheetah, you lose a
                            lot of performance with NameMapper -- if you don't
                            use it (try taking out $'s) it might speed up
                            significantly.
                        </p>
                    </div>
                    <div align="right">
                        <a
                            href="https://ianbicking.org/re-python-templating-languages-comment-3.html"
                            rel="nofollow"
                            >#</a
                        >
                        Ian Bicking
                    </div>
                    <hr noshade />
                </blockquote>
            </blockquote>
        </blockquote>
    </body>
</html>
