<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <!-- MOBIFY - DO NOT ALTER - PASTE IMMEDIATELY AFTER OPENING HEAD TAG -->
        <script type="text/javascript">
            /*<![CDATA[*/ (function (a) {
                function b(a, b) {
                    if (+a) return ~a || (d.cookie = h + "=; path=/");
                    (j = d.createElement(e)),
                        (k = d.getElementsByTagName(e)[0]),
                        (j.src = a),
                        b && (j.onload = j.onerror = b),
                        k.parentNode.insertBefore(j, k);
                }
                function c() {
                    n.api || b(l.shift() || -1, c);
                }
                if (this.Mobify) return;
                var d = document,
                    e = "script",
                    f = "mobify",
                    g = "." + f + ".com/",
                    h = f + "-path",
                    i = g + "un" + f + ".js",
                    j,
                    k,
                    l = [!1, 1],
                    m,
                    n = (this.Mobify = {
                        points: [+new Date()],
                        tagVersion: [6, 0],
                    }),
                    o = /(; |#|&|^)mobify-path=([^&;]*)/g.exec(
                        location.hash + "; " + d.cookie
                    );
                o
                    ? (m = o[2]) &&
                      !+(m = sessionStorage[h] || m) &&
                      (l = [!0, "//preview" + g + escape(m)])
                    : ((l = a() || l),
                      l[0] && l.push("//cdn" + i, "//files01" + i)),
                    l.shift()
                        ? (d.write('<plaintext style="display:none;">'),
                          setTimeout(c))
                        : b(l[0]);
            })(function () {
                if (
                    /ip(hone|od)|android.*(mobile)|blackberry.*applewebkit/i.test(
                        navigator.userAgent
                    )
                ) {
                    return [
                        1,
                        "//cdn.mobify.com/sites/ians-blog/production/mobify.js",
                    ];
                }
            }); /*]]>*/
        </script>
        <!-- END MOBIFY -->
        <title>Ian Bicking: a blog :: Decorators and Descriptors</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <meta name="generator" content="WordPress 3.4.2" />
        <!-- LEAVE FOR STATS -->
        <meta name="description" content="" />
        <link
            rel="stylesheet"
            title="plaintxtSimpler"
            href="../../../../wp-content/themes/Barthelme-ianb/style.css"
            type="text/css"
            media="all"
        />
        <link
            rel="start"
            href="../../../../index.html"
            title="Ian Bicking: a blog"
        />
        <link
            rel="alternate"
            type="application/atom+xml"
            title="Ian Bicking: a blog Atom Feed"
            href="../../../../feed/atom/index.html"
        />
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Ian Bicking: a blog RSS 2.0 Feed"
            href="../../../../feed/rss/index.html"
        />
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Ian Bicking: a blog Comments RSS 2.0 Feed"
            href="../../../../comments/feed/index.html"
        />
        <link
            rel="alternate"
            type="application/rdf+xml"
            title="Ian Bicking: a blog RSS 1.0"
            href="../../../../feed/rdf/index.html"
        />
        <link
            rel="alternate"
            type="text/xml"
            title="Ian Bicking: a blog RSS 0.92 Feed"
            href="../../../../feed/rss/index.html"
        />

        <link
            rel="archives"
            title="October 2012"
            href="../../../../2012/10/index.html"
        />
        <link
            rel="archives"
            title="February 2012"
            href="../../../../2012/02/index.html"
        />
        <link
            rel="archives"
            title="April 2011"
            href="../../../../2011/04/index.html"
        />
        <link
            rel="archives"
            title="March 2011"
            href="../../../../2011/03/index.html"
        />
        <link
            rel="archives"
            title="September 2010"
            href="../../../../2010/09/index.html"
        />
        <link
            rel="archives"
            title="August 2010"
            href="../../../../2010/08/index.html"
        />
        <link
            rel="archives"
            title="May 2010"
            href="../../../../2010/05/index.html"
        />
        <link
            rel="archives"
            title="April 2010"
            href="../../../../2010/04/index.html"
        />
        <link
            rel="archives"
            title="March 2010"
            href="../../../../2010/03/index.html"
        />
        <link
            rel="archives"
            title="February 2010"
            href="../../../../2010/02/index.html"
        />
        <link
            rel="archives"
            title="January 2010"
            href="../../../../2010/01/index.html"
        />
        <link
            rel="archives"
            title="September 2009"
            href="../../../../2009/09/index.html"
        />
        <link
            rel="archives"
            title="May 2009"
            href="../../../../2009/05/index.html"
        />
        <link
            rel="archives"
            title="April 2009"
            href="../../../../2009/04/index.html"
        />
        <link
            rel="archives"
            title="January 2009"
            href="../../../../2009/01/index.html"
        />
        <link
            rel="archives"
            title="December 2008"
            href="../../../12/index.html"
        />
        <link
            rel="archives"
            title="November 2008"
            href="../../../11/index.html"
        />
        <link rel="archives" title="October 2008" href="../../index.html" />
        <link
            rel="archives"
            title="September 2008"
            href="../../../09/index.html"
        />
        <link
            rel="archives"
            title="August 2008"
            href="../../../08/index.html"
        />
        <link rel="archives" title="July 2008" href="../../../07/index.html" />
        <link rel="archives" title="June 2008" href="../../../06/index.html" />
        <link rel="archives" title="May 2008" href="../../../05/index.html" />
        <link rel="archives" title="April 2008" href="../../../04/index.html" />
        <link rel="archives" title="March 2008" href="../../../03/index.html" />
        <link
            rel="archives"
            title="February 2008"
            href="../../../02/index.html"
        />
        <link
            rel="archives"
            title="January 2008"
            href="../../../01/index.html"
        />
        <link
            rel="archives"
            title="November 2007"
            href="../../../../2007/11/index.html"
        />
        <link
            rel="archives"
            title="October 2007"
            href="../../../../2007/10/index.html"
        />
        <link
            rel="archives"
            title="September 2007"
            href="../../../../2007/09/index.html"
        />
        <link
            rel="archives"
            title="August 2007"
            href="../../../../2007/08/index.html"
        />
        <link
            rel="archives"
            title="July 2007"
            href="../../../../2007/07/index.html"
        />
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Ian Bicking: a blog &raquo; Decorators and Descriptors Comments Feed"
            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/feed/"
        />
        <link
            rel="EditURI"
            type="application/rsd+xml"
            title="RSD"
            href="../../../../xmlrpc.php?rsd"
        />
        <link
            rel="wlwmanifest"
            type="application/wlwmanifest+xml"
            href="../../../../wp-includes/wlwmanifest.xml"
        />
        <link
            rel="prev"
            title="The Philosophy of Deliverance"
            href="../../06/the-philosophy-of-deliverance/index.html"
        />
        <link
            rel="next"
            title="Hypertext-driven URLs"
            href="../hypertext-driven-urls/index.html"
        />
        <meta name="generator" content="WordPress 3.4.2" />
        <link rel="canonical" href="index.html" />
        <link rel="shortlink" href="https://ianbicking.org/?p=80" />
        <link
            rel="stylesheet"
            href="../../../../wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"
            type="text/css"
        />
        <style type="text/css">
            .recentcomments a {
                display: inline !important;
                padding: 0 !important;
                margin: 0 !important;
            }
        </style>
        <style type="text/css" media="all">
            /*<![CDATA[*/
            body {
                font-size: 100%;
            }
            body {
                font-family: tahoma, geneva, sans-serif;
            }
            div.post-header,
            h2.post-title,
            p.post-date-single,
            h2.post-title-single,
            div.post-entry h1,
            div.post-entry h2,
            div.post-entry h3,
            div.post-entry h4,
            div.post-entry h5,
            div.post-entry h6,
            div.post-entry blockquote,
            div.post-footer,
            h3#comment-count,
            h4#comment-header,
            div#comments ol li p.comment-metadata,
            h4#respond {
                font-family: verdana, geneva, sans-serif;
            }
            div.post-entry p {
                text-align: left;
            }
            div#wrapper {
                width: 100%;
            }

            /*]]>*/
        </style>
    </head>
    <body>
        <div id="wrapper">
            <div
                id="header"
                onclick="location.href='https://ianbicking.org/';"
                style="cursor: pointer"
            >
                <h1 id="title">
                    <a href="../../../../index.html" title="Ian Bicking: a blog"
                        >Ian Bicking: a blog</a
                    >
                </h1>
                <p id="description"></p>
            </div>
            <!-- WP Theme Credits -->
            <div style="display: none">
                We can answer on question
                <a href="http://www.olnevhost.net/vps-hosting.html"
                    >what is VPS</a
                >? and what is
                <a href="http://www.olnevhost.net/dedicated-servers.html"
                    ><strong>cheap dedicated servers</strong></a
                >?
            </div>
            <!-- END HEADER -->
            <div id="container">
                <div id="content" class="widecolumn">
                    <div id="post-80" class="post single-post">
                        <p class="post-date-single">{ 2008 10 24 }</p>
                        <h2 class="post-title-single">
                            Decorators and Descriptors
                        </h2>
                        <div class="post-entry">
                            <div class="document">
                                <p>
                                    So,
                                    <a
                                        class="reference external"
                                        href="http://www.python.org/dev/peps/pep-0318/"
                                        >decorators</a
                                    >
                                    are neat (maybe check out a
                                    <a
                                        class="reference external"
                                        href="http://www.artima.com/weblogs/viewpost.jsp?thread=240808"
                                        >new tutorial on them</a
                                    >).
                                    <a
                                        class="reference external"
                                        href="http://users.rcn.com/python/download/Descriptor.htm"
                                        >Descriptors</a
                                    >
                                    are neat but may seem hard (though they
                                    hardly take a long time to describe).
                                    Sometimes these two things intersect, and
                                    this post describes how.
                                </p>
                                <p>
                                    Here&#8217;s an example decorator where this
                                    comes up. First, we want something that
                                    looks like a WSGI application:
                                </p>
                                <div class="dean_ch" style="white-space: wrap">
                                    <br />
                                    <span class="kw1">def</span>
                                    application<span class="br0">&#40;</span
                                    >environ, start_response<span class="br0"
                                        >&#41;</span
                                    >:<br />
                                    &nbsp; &nbsp; start_response<span
                                        class="br0"
                                        >&#40;</span
                                    ><span class="st0">'200 OK'</span>,
                                    <span class="br0">&#91;</span
                                    ><span class="br0">&#40;</span
                                    ><span class="st0">'content-type'</span>,
                                    <span class="st0">'text/html'</span
                                    ><span class="br0">&#41;</span
                                    ><span class="br0">&#93;</span
                                    ><span class="br0">&#41;</span><br />
                                    &nbsp; &nbsp;
                                    <span class="kw1">return</span>
                                    <span class="br0">&#91;</span
                                    ><span class="st0">'hi!'</span
                                    ><span class="br0">&#93;</span><br />
                                    &nbsp;
                                </div>
                                <p>But we want to use WebOb, like:</p>
                                <div class="dean_ch" style="white-space: wrap">
                                    <br />
                                    <span class="kw1">from</span> webob
                                    <span class="kw1">import</span> Request,
                                    Response<br />
                                    <span class="kw1">def</span>
                                    application<span class="br0">&#40;</span
                                    >environ, start_response<span class="br0"
                                        >&#41;</span
                                    >:<br />
                                    &nbsp; &nbsp; req = Request<span class="br0"
                                        >&#40;</span
                                    >environ<span class="br0">&#41;</span><br />
                                    &nbsp; &nbsp; resp = Response<span
                                        class="br0"
                                        >&#40;</span
                                    ><span class="st0">'hi!'</span
                                    ><span class="br0">&#41;</span><br />
                                    &nbsp; &nbsp;
                                    <span class="kw1">return</span> resp<span
                                        class="br0"
                                        >&#40;</span
                                    >environ, start_response<span class="br0"
                                        >&#41;</span
                                    ><br />
                                    &nbsp;
                                </div>
                                <p>
                                    (We don&#8217;t use
                                    <tt class="docutils literal"
                                        ><span class="pre">req</span></tt
                                    >
                                    in this example, but of course you probably
                                    would in a real WSGI application)
                                </p>
                                <p>
                                    Now
                                    <tt class="docutils literal"
                                        ><span class="pre">req</span>
                                        <span class="pre">=</span>
                                        <span class="pre"
                                            >Request(environ)</span
                                        ></tt
                                    >
                                    is boilerplate, and it&#8217;d be nicer to
                                    just do
                                    <tt class="docutils literal"
                                        ><span class="pre">return</span>
                                        <span class="pre">resp</span></tt
                                    >
                                    instead of
                                    <tt class="docutils literal"
                                        ><span class="pre">return</span>
                                        <span class="pre">resp(environ,</span>
                                        <span class="pre"
                                            >start_response)</span
                                        ></tt
                                    >. So let&#8217;s make a decorator to do
                                    that:
                                </p>
                                <div class="dean_ch" style="white-space: wrap">
                                    <br />
                                    <span class="kw1">class</span> wsgiapp<span
                                        class="br0"
                                        >&#40;</span
                                    ><span class="kw2">object</span
                                    ><span class="br0">&#41;</span>:<br />
                                    &nbsp; &nbsp; <span class="kw1">def</span>
                                    <span class="kw4">__init__</span
                                    ><span class="br0">&#40;</span
                                    ><span class="kw2">self</span>, func<span
                                        class="br0"
                                        >&#41;</span
                                    >:<br />
                                    &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw2">self</span>.<span
                                        class="me1"
                                        >func</span
                                    >
                                    = func<br />
                                    &nbsp; &nbsp; <span class="kw1">def</span>
                                    <span class="kw4">__call__</span
                                    ><span class="br0">&#40;</span
                                    ><span class="kw2">self</span>, environ,
                                    start_response<span class="br0">&#41;</span
                                    >:<br />
                                    &nbsp; &nbsp; &nbsp; &nbsp; resp =
                                    <span class="kw2">self</span>.<span
                                        class="me1"
                                        >func</span
                                    ><span class="br0">&#40;</span>Request<span
                                        class="br0"
                                        >&#40;</span
                                    >environ<span class="br0">&#41;</span
                                    ><span class="br0">&#41;</span><br />
                                    &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw1">return</span> resp<span
                                        class="br0"
                                        >&#40;</span
                                    >environ, start_response<span class="br0"
                                        >&#41;</span
                                    ><br />
                                    <br />
                                    @<span class="co1">wsgiapp</span><br />
                                    <span class="kw1">def</span>
                                    application<span class="br0">&#40;</span
                                    >req<span class="br0">&#41;</span>:<br />
                                    &nbsp; &nbsp;
                                    <span class="kw1">return</span>
                                    Response<span class="br0">&#40;</span
                                    ><span class="st0">'hi!'</span
                                    ><span class="br0">&#41;</span><br />
                                    &nbsp;
                                </div>
                                <p>
                                    If you don&#8217;t understand what happened
                                    there, go read up on decorators.<br />
                                    Now, what if you want to decorate a method?
                                    For instance:
                                </p>
                                <div class="dean_ch" style="white-space: wrap">
                                    <br />
                                    <span class="kw1">class</span>
                                    Application<span class="br0">&#40;</span
                                    ><span class="kw2">object</span
                                    ><span class="br0">&#41;</span>:<br />
                                    &nbsp; &nbsp; <span class="kw1">def</span>
                                    <span class="kw4">__init__</span
                                    ><span class="br0">&#40;</span
                                    ><span class="kw2">self</span>, text<span
                                        class="br0"
                                        >&#41;</span
                                    >:<br />
                                    &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw2">self</span>.<span
                                        class="me1"
                                        >text</span
                                    >
                                    = text<br />
                                    &nbsp; &nbsp; @<span class="co1"
                                        >wsgiapp</span
                                    ><br />
                                    &nbsp; &nbsp; <span class="kw1">def</span>
                                    <span class="kw4">__call__</span
                                    ><span class="br0">&#40;</span
                                    ><span class="kw2">self</span>, req<span
                                        class="br0"
                                        >&#41;</span
                                    >:<br />
                                    &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw1">return</span>
                                    Response<span class="br0">&#40;</span
                                    ><span class="kw2">self</span>.<span
                                        class="me1"
                                        >text</span
                                    ><span class="br0">&#41;</span><br />
                                    application = Application<span class="br0"
                                        >&#40;</span
                                    ><span class="st0">'hi!'</span
                                    ><span class="br0">&#41;</span><br />
                                    &nbsp;
                                </div>
                                <p>
                                    This won&#8217;t <em>quite</em> work,
                                    because
                                    <tt class="docutils literal"
                                        ><span class="pre"
                                            >&#64;wsgiapp</span
                                        ></tt
                                    >
                                    will call
                                    <tt class="docutils literal"
                                        ><span class="pre"
                                            >Application.__call__(req)</span
                                        ></tt
                                    >
                                    &#8212; with <em>no self argument</em>. This
                                    is generally a problem with any decorator
                                    that changes the signature, because the
                                    signature for methods has this extra
                                    <tt class="docutils literal"
                                        ><span class="pre">self</span></tt
                                    >
                                    argument. Descriptors can handle this. First
                                    we&#8217;ll have the same
                                    <tt class="docutils literal"
                                        ><span class="pre">wsgiapp</span></tt
                                    >
                                    definition as we had before, but we&#8217;ll
                                    add the magic descriptor method
                                    <tt class="docutils literal"
                                        ><span class="pre">__get__</span></tt
                                    >:
                                </p>
                                <div class="dean_ch" style="white-space: wrap">
                                    <br />
                                    <span class="kw1">class</span> wsgiapp<span
                                        class="br0"
                                        >&#40;</span
                                    ><span class="kw2">object</span
                                    ><span class="br0">&#41;</span>:<br />
                                    &nbsp; &nbsp; <span class="kw1">def</span>
                                    <span class="kw4">__init__</span
                                    ><span class="br0">&#40;</span
                                    ><span class="kw2">self</span>, func<span
                                        class="br0"
                                        >&#41;</span
                                    >:<br />
                                    &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw2">self</span>.<span
                                        class="me1"
                                        >func</span
                                    >
                                    = func<br />
                                    &nbsp; &nbsp; <span class="kw1">def</span>
                                    <span class="kw4">__call__</span
                                    ><span class="br0">&#40;</span
                                    ><span class="kw2">self</span>, environ,
                                    start_response<span class="br0">&#41;</span
                                    >:<br />
                                    &nbsp; &nbsp; &nbsp; &nbsp; resp =
                                    <span class="kw2">self</span>.<span
                                        class="me1"
                                        >func</span
                                    ><span class="br0">&#40;</span>Request<span
                                        class="br0"
                                        >&#40;</span
                                    >environ<span class="br0">&#41;</span
                                    ><span class="br0">&#41;</span><br />
                                    &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw1">return</span> resp<span
                                        class="br0"
                                        >&#40;</span
                                    >environ, start_response<span class="br0"
                                        >&#41;</span
                                    ><br />
                                    &nbsp; &nbsp; <span class="kw1">def</span>
                                    <span class="kw4">__get__</span
                                    ><span class="br0">&#40;</span
                                    ><span class="kw2">self</span>, obj,
                                    <span class="kw2">type</span>=<span
                                        class="kw2"
                                        >None</span
                                    ><span class="br0">&#41;</span>:<br />
                                    &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw1">if</span> obj
                                    <span class="kw1">is</span>
                                    <span class="kw2">None</span>:<br />
                                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw1">return</span>
                                    <span class="kw2">self</span><br />
                                    &nbsp; &nbsp; &nbsp; &nbsp; new_func =
                                    <span class="kw2">self</span>.<span
                                        class="me1"
                                        >func</span
                                    >.<span class="kw4">__get__</span
                                    ><span class="br0">&#40;</span>obj,
                                    <span class="kw2">type</span
                                    ><span class="br0">&#41;</span><br />
                                    &nbsp; &nbsp; &nbsp; &nbsp;
                                    <span class="kw1">return</span>
                                    <span class="kw2">self</span>.__class__<span
                                        class="br0"
                                        >&#40;</span
                                    >new_func<span class="br0">&#41;</span
                                    ><br />
                                    &nbsp;
                                </div>
                                <p>So, to explain:</p>
                                <p>
                                    When you get an attribute from an instance,
                                    like
                                    <tt class="docutils literal"
                                        ><span class="pre"
                                            >Application().__call__</span
                                        ></tt
                                    >, Python will check if the object that was
                                    fetched has a
                                    <tt class="docutils literal"
                                        ><span class="pre">__get__</span></tt
                                    >
                                    method. If it does, it will call that method
                                    and use the result of that method.
                                </p>
                                <p>This part:</p>
                                <div class="dean_ch" style="white-space: wrap">
                                    <br />
                                    <span class="kw1">if</span> obj
                                    <span class="kw1">is</span>
                                    <span class="kw2">None</span>:<br />
                                    &nbsp; &nbsp;
                                    <span class="kw1">return</span>
                                    <span class="kw2">self</span><br />
                                    &nbsp;
                                </div>
                                <p>
                                    is what happens when you do
                                    <tt class="docutils literal"
                                        ><span class="pre"
                                            >Application.__call__</span
                                        ></tt
                                    >
                                    &#8212; in other words, when get a class
                                    attribute. In that case
                                    <tt class="docutils literal"
                                        ><span class="pre">obj</span></tt
                                    >
                                    (self) will be None, and it will just return
                                    the descriptor (it <em>could</em> do
                                    something else, like in
                                    <a
                                        class="reference external"
                                        href="http://svn.colorstudy.com/home/ianb/recipes/classinstance.py"
                                        >this example</a
                                    >, but usually it doesn&#8217;t).
                                </p>
                                <p>
                                    Functions already have a
                                    <tt class="docutils literal"
                                        ><span class="pre">__get__</span></tt
                                    >
                                    method. You can try it yourself:
                                </p>
                                <div class="dean_ch" style="white-space: wrap">
                                    <br />
                                    &gt;&gt;&gt;
                                    <span class="kw1">def</span> example<span
                                        class="br0"
                                        >&#40;</span
                                    >*args<span class="br0">&#41;</span>:<br />
                                    ... &nbsp; &nbsp;
                                    <span class="kw1">print</span>
                                    <span class="st0">'got'</span>, args<br />
                                    &gt;&gt;&gt; example_bound = example.<span
                                        class="kw4"
                                        >__get__</span
                                    ><span class="br0">&#40;</span
                                    ><span class="nu0">1</span
                                    ><span class="br0">&#41;</span><br />
                                    &gt;&gt;&gt; example_bound<span class="br0"
                                        >&#40;</span
                                    ><span class="st0">'test'</span
                                    ><span class="br0">&#41;</span><br />
                                    got <span class="br0">&#40;</span
                                    ><span class="nu0">1</span>,
                                    <span class="st0">'test'</span
                                    ><span class="br0">&#41;</span><br />
                                    &nbsp;
                                </div>
                                <p>
                                    So in the example with
                                    <tt class="docutils literal"
                                        ><span class="pre">wsgiapp</span></tt
                                    >
                                    we are just changing the decorator to wrap
                                    the new <em>bound</em> function instead of
                                    the old unbound function. This allows
                                    <tt class="docutils literal"
                                        ><span class="pre">wsgiapp</span></tt
                                    >
                                    to be compatible with both plain functions
                                    and methods. In fact, it would probably be
                                    preferable to <em>always</em> call
                                    <tt class="docutils literal"
                                        ><span class="pre"
                                            >func.__get__(obj,</span
                                        >
                                        <span class="pre">type)</span></tt
                                    >
                                    (even if
                                    <tt class="docutils literal"
                                        ><span class="pre">obj</span>
                                        <span class="pre">is</span>
                                        <span class="pre">None</span></tt
                                    >), as then we could also wrap class methods
                                    or other kinds of descriptors.
                                </p>
                            </div>
                            <p>
                                Automatically generated list of related posts:
                            </p>
                            <ol>
                                <li>
                                    <a
                                        href="../../../../2009/05/22/webob-decorator/index.html"
                                        rel="bookmark"
                                        title="WebOb decorator"
                                        >WebOb decorator</a
                                    >
                                    <small
                                        >Lately I&#8217;ve been writing a few
                                        applications (e.g., PickyWiki
                                        and...</small
                                    >
                                </li>
                                <li>
                                    <a
                                        href="../../../../2007/08/10/defaults-inheritance/index.html"
                                        rel="bookmark"
                                        title="Defaults &amp; Inheritance"
                                        >Defaults &#038; Inheritance</a
                                    >
                                    <small
                                        >I thought I&#8217;d note a way I try to
                                        make...</small
                                    >
                                </li>
                                <li>
                                    <a
                                        href="../../../../2010/03/12/a-webob-app-example/index.html"
                                        rel="bookmark"
                                        title="What Does A WebOb App Look Like?"
                                        >What Does A WebOb App Look Like?</a
                                    >
                                    <small
                                        >Lately I&#8217;ve been writing code
                                        using WebOb and just a...</small
                                    >
                                </li>
                                <li>
                                    <a
                                        href="../../../09/08/inverted-partials/index.html"
                                        rel="bookmark"
                                        title="Inverted Partials"
                                        >Inverted Partials</a
                                    >
                                    <small
                                        >I was talking with a coworker some time
                                        ago about...</small
                                    >
                                </li>
                                <li>
                                    <a
                                        href="../../../../2007/08/08/opening-python-classes/index.html"
                                        rel="bookmark"
                                        title="Opening Python Classes"
                                        >Opening Python Classes</a
                                    >
                                    <small
                                        >So, I was reading through comments to
                                        despam my old...</small
                                    >
                                </li>
                            </ol>
                        </div>
                        <!-- END POST-ENTRY  -->
                        <!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://ianbicking.org/2008/10/24/decorators-and-descriptors/"
    dc:identifier="https://ianbicking.org/2008/10/24/decorators-and-descriptors/"
    dc:title="Decorators and Descriptors"
    trackback:ping="https://ianbicking.org/2008/10/24/decorators-and-descriptors/trackback/" />
</rdf:RDF> -->
                        <div class="post-footer">
                            <p>
                                Posted by Ian Bicking on Friday, October 24th,
                                2008, at 12:18 am, and filed under
                                <a
                                    href="../../../../category/python/index.html"
                                    title="View all posts in Python"
                                    rel="category tag"
                                    >Python</a
                                >.
                            </p>
                            <p>
                                Comments have a
                                <a
                                    href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/feed/"
                                    >feed</a
                                >.
                            </p>
                        </div>
                        <!-- END POST-FOOTER -->
                    </div>
                    <!-- END POST -->

                    <div id="comments">
                        <h4 id="comments">17 Comments</h4>
                        <ul class="commentlist">
                            <li
                                class="comment even thread-even depth-1"
                                id="comment-54810"
                            >
                                <div
                                    id="div-comment-54810"
                                    class="comment-body"
                                >
                                    <div class="comment-author vcard">
                                        <img
                                            alt=""
                                            src="http://1.gravatar.com/avatar/b4bc128655739e58e2a52b1c4b37ff41?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                            class="avatar avatar-32 photo"
                                            height="32"
                                            width="32"
                                        />
                                        <cite class="fn">Ben</cite>
                                        <span class="says">says:</span>
                                    </div>

                                    <div class="comment-meta commentmetadata">
                                        <a
                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-54810"
                                        >
                                            October 24, 2008 at 2:28 am</a
                                        >
                                    </div>

                                    <p>
                                        Fascinating post Ian, thanks!
                                        Descriptors and decorators can be so
                                        helpful make code cleaner and more
                                        decoupled, it&#8217;s a shame they are
                                        perceived as so &#8220;difficult&#8221;.
                                        They do take a bit of effort to learn I
                                        guess, but it&#8217;s WELL worth it!
                                        [ed. note: correction applied, thanks]
                                    </p>

                                    <p>Cheers, Ben</p>

                                    <div class="reply"></div>
                                </div>
                            </li>
                            <li
                                class="comment odd alt thread-odd thread-alt depth-1"
                                id="comment-54812"
                            >
                                <div
                                    id="div-comment-54812"
                                    class="comment-body"
                                >
                                    <div class="comment-author vcard">
                                        <img
                                            alt=""
                                            src="http://1.gravatar.com/avatar/b4bc128655739e58e2a52b1c4b37ff41?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                            class="avatar avatar-32 photo"
                                            height="32"
                                            width="32"
                                        />
                                        <cite class="fn">Ben</cite>
                                        <span class="says">says:</span>
                                    </div>

                                    <div class="comment-meta commentmetadata">
                                        <a
                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-54812"
                                        >
                                            October 24, 2008 at 2:51 am</a
                                        >
                                    </div>

                                    <p>
                                        I&#8217;ve just had a play with some of
                                        this&#8230; It never occured to me but
                                        you can use this to make new methods
                                        <strong>after</strong> instantiation:
                                    </p>

                                    <pre><code>class deco(object):

    def __init__(self, func):
        self.func = func

    def __call__(self, *args, **kwargs):
        resp = self.func(*args, **kwargs)
        return resp

    def __get__(self, obj, type=None):
        if obj is None:
            return self
        new_func = self.func.__get__(obj, type)
        return self.__class__(new_func)


class test_obj(object):
    pass

t = test_obj()

t.times2 = deco(lambda self, arg: arg*2).__get__(t)
</code></pre>

                                    <p>
                                        <code>t.times2(4)</code> now acts like a
                                        normal method and gives <code>8</code>.
                                    </p>

                                    <div class="reply"></div>
                                </div>
                            </li>
                            <li
                                class="comment even thread-even depth-1"
                                id="comment-54822"
                            >
                                <div
                                    id="div-comment-54822"
                                    class="comment-body"
                                >
                                    <div class="comment-author vcard">
                                        <img
                                            alt=""
                                            src="http://1.gravatar.com/avatar/7e268ac4664c1efdb66fb3a5110332bd?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                            class="avatar avatar-32 photo"
                                            height="32"
                                            width="32"
                                        />
                                        <cite class="fn">Schuyler</cite>
                                        <span class="says">says:</span>
                                    </div>

                                    <div class="comment-meta commentmetadata">
                                        <a
                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-54822"
                                        >
                                            October 24, 2008 at 7:56 am</a
                                        >
                                    </div>

                                    <p>
                                        I don&#8217;t quite understand it all
                                        yet, but this solves an old problem I
                                        had in TurboGears where I was trying to
                                        abstract controllers. I would make a
                                        class Foo, and ran up against this:
                                    </p>

                                    <pre><code>class Foo:
     def bar(self,x):
         return x*3

class Baz:
     #what some TG decorators do:
     foo = Foo()
     foo.bar.expose = True

Traceback (most recent call last):
  File "", line 1, in ?
  File "", line 4, in Baz
AttributeError: 'instancemethod' object has no attribute 'expose'
</code></pre>

                                    <p>
                                        I came up with an ugly hack making them
                                        all static methods, but with
                                        <a href="index.html#comment-54812"
                                            >Ben&#8217;s deco class</a
                                        >, I can now do this and it all works:
                                    </p>

                                    <pre><code>class Foo:
    @deco
    def bar(self,x):
        return x*3

class Baz:
    foo = Foo()
    foo.bar.expose = True
</code></pre>

                                    <div class="reply"></div>
                                </div>
                            </li>
                            <li
                                class="comment odd alt thread-odd thread-alt depth-1"
                                id="comment-54831"
                            >
                                <div
                                    id="div-comment-54831"
                                    class="comment-body"
                                >
                                    <div class="comment-author vcard">
                                        <img
                                            alt=""
                                            src="http://1.gravatar.com/avatar/34602bcf1d503a187ba73d6bcdcbcb9e?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                            class="avatar avatar-32 photo"
                                            height="32"
                                            width="32"
                                        />
                                        <cite class="fn"
                                            ><a
                                                href="http://blog.poundbang.in"
                                                rel="external nofollow"
                                                class="url"
                                                >Harish Mallipeddi</a
                                            ></cite
                                        >
                                        <span class="says">says:</span>
                                    </div>

                                    <div class="comment-meta commentmetadata">
                                        <a
                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-54831"
                                        >
                                            October 24, 2008 at 12:34 pm</a
                                        >
                                    </div>

                                    <p>I think it should be</p>

                                    <p>
                                        <code
                                            >application = Application("some
                                            text")</code
                                        >
                                    </p>

                                    <p>instead of</p>

                                    <p>
                                        <code>application = Application</code>
                                    </p>

                                    <p>[fixed, thanks!]</p>

                                    <div class="reply"></div>
                                </div>
                            </li>
                            <li
                                class="comment even thread-even depth-1"
                                id="comment-54907"
                            >
                                <div
                                    id="div-comment-54907"
                                    class="comment-body"
                                >
                                    <div class="comment-author vcard">
                                        <img
                                            alt=""
                                            src="http://1.gravatar.com/avatar/3d9b2df0d1610c9418ba9e9013dbd418?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                            class="avatar avatar-32 photo"
                                            height="32"
                                            width="32"
                                        />
                                        <cite class="fn">Ali</cite>
                                        <span class="says">says:</span>
                                    </div>

                                    <div class="comment-meta commentmetadata">
                                        <a
                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-54907"
                                        >
                                            October 26, 2008 at 12:32 am</a
                                        >
                                    </div>

                                    <p>
                                        In the first decorator (class wsgiapp),
                                        <strong>call</strong> takes two
                                        arguments other than self (environ,
                                        response). But the function it&#8217;s
                                        decorating, application, takes just one
                                        parameter. Is this right?
                                    </p>

                                    <div class="reply"></div>
                                </div>
                            </li>
                            <li
                                class="comment odd alt thread-odd thread-alt depth-1 parent"
                                id="comment-54930"
                            >
                                <div
                                    id="div-comment-54930"
                                    class="comment-body"
                                >
                                    <div class="comment-author vcard">
                                        <img
                                            alt=""
                                            src="http://0.gravatar.com/avatar/619ea274d3ac8f15f9f243689e68d61d?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                            class="avatar avatar-32 photo"
                                            height="32"
                                            width="32"
                                        />
                                        <cite class="fn">ale</cite>
                                        <span class="says">says:</span>
                                    </div>

                                    <div class="comment-meta commentmetadata">
                                        <a
                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-54930"
                                        >
                                            October 26, 2008 at 7:00 pm</a
                                        >
                                    </div>

                                    <p>
                                        Very nice. It does seem like the
                                        <code>__get__</code> method of the
                                        decorator would get called on every call
                                        of the wrapped method though. Would
                                        there be any way of instantiating the
                                        bound method on first call and on all
                                        subsequent calls just using the
                                        previously instantiated method?
                                    </p>

                                    <div class="reply"></div>
                                </div>
                                <ul class="children">
                                    <li
                                        class="comment even depth-2 parent"
                                        id="comment-124084"
                                    >
                                        <div
                                            id="div-comment-124084"
                                            class="comment-body"
                                        >
                                            <div class="comment-author vcard">
                                                <img
                                                    alt=""
                                                    src="http://1.gravatar.com/avatar/ba2a22f8523b3bfb06107ba792792140?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                    class="avatar avatar-32 photo"
                                                    height="32"
                                                    width="32"
                                                />
                                                <cite class="fn"
                                                    >chris jones</cite
                                                >
                                                <span class="says">says:</span>
                                            </div>

                                            <div
                                                class="comment-meta commentmetadata"
                                            >
                                                <a
                                                    href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-124084"
                                                >
                                                    August 15, 2009 at 1:17
                                                    pm</a
                                                >
                                            </div>

                                            <p>
                                                Ale, I&#8217;ve tried everything
                                                to accomplish that and have not
                                                succeeded due to
                                                &#95;&#95;get&#95;&#95; living
                                                on the class and not the
                                                instance. For example, you could
                                                do this:
                                            </p>

                                            <pre><code>class deco(object):

    def __init__(self, func):
        self.func = func

    def __call__(self, arg):
        return self.func(arg)

    def __get__(self, obj, type=None):
        self.func = self.func.__get__(obj, type)
        del deco.__get__
        return self
</code></pre>

                                            <p>
                                                This will re-bind the inner
                                                function to the obj instance and
                                                then remove the
                                                &#95;&#95;get&#95;&#95; method,
                                                however you just monkey-patched
                                                your decorator &#8212; meaning
                                                <em
                                                    >you can only decorate one
                                                    function</em
                                                >. Not very useful, obviously.
                                                The reason this works is the
                                                reason you have to instantiate
                                                on every call: Descriptors
                                                operate on the class level.
                                            </p>

                                            <p>
                                                To be honest, I think it makes
                                                more sense to decorate instance
                                                methods with
                                                <em>functional</em> rather than
                                                class-based decorators. For one,
                                                it does not have the problem of
                                                the unbound method failing to
                                                pass implicit self. Second of
                                                all, decorating is inherently a
                                                functional operation. Wrapping
                                                the whole thing in a class with
                                                &#95;&#95;call&#95;&#95; defined
                                                is just ugly and confusing IMO.
                                                Then on top of that, overriding
                                                &#95;&#95;get&#95;&#95; to
                                                re-bind the function is a hack;
                                                one that could have significant
                                                performance implications if
                                                called in a tight loop.
                                            </p>

                                            <div class="reply"></div>
                                        </div>
                                        <ul class="children">
                                            <li
                                                class="comment odd alt depth-3 parent"
                                                id="comment-124087"
                                            >
                                                <div
                                                    id="div-comment-124087"
                                                    class="comment-body"
                                                >
                                                    <div
                                                        class="comment-author vcard"
                                                    >
                                                        <img
                                                            alt=""
                                                            src="http://1.gravatar.com/avatar/ba2a22f8523b3bfb06107ba792792140?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                            class="avatar avatar-32 photo"
                                                            height="32"
                                                            width="32"
                                                        />
                                                        <cite class="fn"
                                                            >chris jones</cite
                                                        >
                                                        <span class="says"
                                                            >says:</span
                                                        >
                                                    </div>

                                                    <div
                                                        class="comment-meta commentmetadata"
                                                    >
                                                        <a
                                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-124087"
                                                        >
                                                            August 15, 2009 at
                                                            1:27 pm</a
                                                        >
                                                    </div>

                                                    <p>
                                                        Hmm.. thought about this
                                                        some more. You could
                                                        always just use
                                                        &#95;&#95;get&#95;&#95;
                                                        to stash the self
                                                        object, and pass it
                                                        explicitly in the
                                                        wrapped function.
                                                        I&#8217;m not sure if
                                                        this performs better or
                                                        not, but it&#8217;s at
                                                        least easier to
                                                        understand:
                                                    </p>

                                                    <pre><code>class deco(object):

    def __init__(self, func):
        self.func = func
        self.obj = None

    def __call__(self, arg):
        return self.func(self.obj, arg)

    def __get__(self, obj, type=None):
        self.obj = obj
        return self
</code></pre>

                                                    <div class="reply"></div>
                                                </div>
                                                <ul class="children">
                                                    <li
                                                        class="comment even depth-4 parent"
                                                        id="comment-138730"
                                                    >
                                                        <div
                                                            id="div-comment-138730"
                                                            class="comment-body"
                                                        >
                                                            <div
                                                                class="comment-author vcard"
                                                            >
                                                                <img
                                                                    alt=""
                                                                    src="http://0.gravatar.com/avatar/af78619231b186055bdd40c5057af17d?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                                    class="avatar avatar-32 photo"
                                                                    height="32"
                                                                    width="32"
                                                                />
                                                                <cite class="fn"
                                                                    >Mathieu</cite
                                                                >
                                                                <span
                                                                    class="says"
                                                                    >says:</span
                                                                >
                                                            </div>

                                                            <div
                                                                class="comment-meta commentmetadata"
                                                            >
                                                                <a
                                                                    href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-138730"
                                                                >
                                                                    November 18,
                                                                    2009 at
                                                                    12:01 am</a
                                                                >
                                                            </div>

                                                            <p>
                                                                Your solution is
                                                                a bit of a hack
                                                                but I like it
                                                                better. The
                                                                problem with the
                                                                __get __ method
                                                                originally
                                                                suggested is
                                                                that it does
                                                                &#8220;return
                                                                self.__class
                                                                __(new_func)&#8221;.
                                                                This will cause
                                                                a new instance
                                                                of the class to
                                                                be created again
                                                                and again&#8230;
                                                            </p>

                                                            <div
                                                                class="reply"
                                                            ></div>
                                                        </div>
                                                        <ul class="children">
                                                            <li
                                                                class="comment odd alt depth-5"
                                                                id="comment-138836"
                                                            >
                                                                <div
                                                                    id="div-comment-138836"
                                                                    class="comment-body"
                                                                >
                                                                    <div
                                                                        class="comment-author vcard"
                                                                    >
                                                                        <img
                                                                            alt=""
                                                                            src="http://1.gravatar.com/avatar/75e7095602861915110e37614633b036?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                                            class="avatar avatar-32 photo"
                                                                            height="32"
                                                                            width="32"
                                                                        />
                                                                        <cite
                                                                            class="fn"
                                                                            >Chris
                                                                            Jones</cite
                                                                        >
                                                                        <span
                                                                            class="says"
                                                                            >says:</span
                                                                        >
                                                                    </div>

                                                                    <div
                                                                        class="comment-meta commentmetadata"
                                                                    >
                                                                        <a
                                                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-138836"
                                                                        >
                                                                            November
                                                                            19,
                                                                            2009
                                                                            at
                                                                            4:51
                                                                            am</a
                                                                        >
                                                                    </div>

                                                                    <p>
                                                                        Indeed,
                                                                        but any
                                                                        solution
                                                                        is going
                                                                        to be a
                                                                        hack
                                                                        because
                                                                        it&#8217;s
                                                                        working
                                                                        around
                                                                        what is
                                                                        (IMO) a
                                                                        bug in
                                                                        Python
                                                                        class-based
                                                                        decorators.
                                                                    </p>

                                                                    <p>
                                                                        I got
                                                                        around
                                                                        to
                                                                        benchmarking
                                                                        this
                                                                        and,
                                                                        surprisingly,
                                                                        creating
                                                                        a new
                                                                        class on
                                                                        each
                                                                        call is
                                                                        actually
                                                                        <em
                                                                            >less
                                                                            expensive</em
                                                                        >
                                                                        than the
                                                                        extra
                                                                        attribute
                                                                        access,
                                                                        even
                                                                        with
                                                                        &#95;&#95;slots&#95;&#95;
                                                                        defined.
                                                                        I&#8217;m
                                                                        guessing
                                                                        this has
                                                                        to do
                                                                        with
                                                                        behind-the-scenes
                                                                        MRO
                                                                        stuff
                                                                        going
                                                                        on. The
                                                                        difference
                                                                        is very
                                                                        slight
                                                                        and
                                                                        probably
                                                                        isn&#8217;t
                                                                        a
                                                                        practical
                                                                        consideration,
                                                                        but just
                                                                        throwing
                                                                        that out
                                                                        there.
                                                                        Here&#8217;s
                                                                        the code
                                                                        and
                                                                        results
                                                                        (CPython
                                                                        2.6 on
                                                                        single-core
                                                                        i386):
                                                                    </p>

                                                                    <pre><code>$ python test.py
30.59: MakeNewClass
30.48: MakeNewClass_Slots
33.97: StashObject
33.69: StashObject_Slots

$ cat test.py
import sys
import time

class MakeNewClass(object):
    def __init__(self, func):
        self.func = func
    def __call__(self):
        self.func()
    def __get__(self, obj, type):
        return self.__class__(self.func.__get__(obj, type))

class MakeNewClass_Slots(object):
    __slots__ = ('func',)
    def __init__(self, func):
        self.func = func
    def __call__(self):
        self.func()
    def __get__(self, obj, type):
        return self.__class__(self.func.__get__(obj, type))

class StashObject(object):
    def __init__(self, func):
        self.func = func
    def __call__(self):
        self.func(self.obj)
    def __get__(self, obj, type):
        self.obj = obj
        return self

class StashObject_Slots(object):
    __slots__ = ('func', 'obj')
    def __init__(self, func):
        self.func = func
    def __call__(self):
        self.func(self.obj)
    def __get__(self, obj, type):
        self.obj = obj
        return self

class Test(object):
    @MakeNewClass
    def test_a(self):
        pass
    @MakeNewClass_Slots
    def test_b(self):
        pass
    @StashObject
    def test_c(self):
        pass
    @StashObject_Slots
    def test_d(self):
        pass

t = Test()
for func in t.test_a, t.test_b, t.test_c, t.test_d:
    start = time.time()
    for i in xrange(30000000):
        func()
    print '%.2f: %s' % (time.time() - start, func.__class__.__name__)
</code></pre>

                                                                    <div
                                                                        class="reply"
                                                                    ></div>
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li
                                                class="comment even depth-3 parent"
                                                id="comment-124137"
                                            >
                                                <div
                                                    id="div-comment-124137"
                                                    class="comment-body"
                                                >
                                                    <div
                                                        class="comment-author vcard"
                                                    >
                                                        <img
                                                            alt=""
                                                            src="http://0.gravatar.com/avatar/619ea274d3ac8f15f9f243689e68d61d?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                            class="avatar avatar-32 photo"
                                                            height="32"
                                                            width="32"
                                                        />
                                                        <cite class="fn"
                                                            >Ale</cite
                                                        >
                                                        <span class="says"
                                                            >says:</span
                                                        >
                                                    </div>

                                                    <div
                                                        class="comment-meta commentmetadata"
                                                    >
                                                        <a
                                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-124137"
                                                        >
                                                            August 16, 2009 at
                                                            3:59 am</a
                                                        >
                                                    </div>

                                                    <p>Chris says</p>

                                                    <pre><code>This will re-bind the inner function to the obj instance and then
remove the __get__ method, however you just monkey-patched your
decorator — meaning you can only decorate one function. Not very
useful, obviously
</code></pre>

                                                    <p>
                                                        From my point of view,
                                                        very useful, since that
                                                        means that if you
                                                        transform it from a
                                                        class to a function that
                                                        returns a class, you are
                                                        set.
                                                    </p>

                                                    <p>ie</p>

                                                    <pre><code>def deco():
    class inner(object):

        def __init__(self, func):
            self.func = func

        def __call__(self, arg):
            return self.func(arg)

        def __get__(self, obj, type=None):
            self.func = self.func.__get__(obj, type)
            del self.__class__.__get__
            return self
    return inner
</code></pre>

                                                    <p>
                                                        Seems to work well, even
                                                        though it&#8217;s an
                                                        uglyish syntax.
                                                    </p>

                                                    <p>
                                                        Using a class decorator
                                                        makes it a little more
                                                        succinct:
                                                    </p>

                                                    <pre><code>def classIsADescriptorDecorator(klass):
    def __init__(self, func):
        self.func = func

    def __get__(self, obj, type=None):
        self.func = self.func.__get__(obj, type)
        del self.__class__.__get__
        return self

    klass.__init__ = __init__
    klass.__get__ = __get__

    return klass

def deco():
    @classIsADescriptorDecorator
    class inner(object):
        def __call__(self, arg):
            return self.func(arg)
</code></pre>

                                                    <p>
                                                        And further, increasing
                                                        the magic quotient by
                                                        creating a new class on
                                                        the fly, we can make it
                                                        shorter:
                                                    </p>

                                                    <pre><code>def decorate(klass):
    newType = type('newType', klass.__class__.__bases__, dict(klass.__dict__))
    return classIsADescriptorDecorator(newType)
</code></pre>

                                                    <p>
                                                        which can be used as
                                                        following:
                                                    </p>

                                                    <pre><code>class Printer(object):
    def __call__(self, arg):
         print arg
         return self.func(arg)


@decorate(Printer)
def notAPrinter(arg):
     print "I'm not a printer: %s" % arg
</code></pre>

                                                    <p>
                                                        This last one looks
                                                        fragile.
                                                    </p>

                                                    <div class="reply"></div>
                                                </div>
                                                <ul class="children">
                                                    <li
                                                        class="comment odd alt depth-4 parent"
                                                        id="comment-124274"
                                                    >
                                                        <div
                                                            id="div-comment-124274"
                                                            class="comment-body"
                                                        >
                                                            <div
                                                                class="comment-author vcard"
                                                            >
                                                                <img
                                                                    alt=""
                                                                    src="http://1.gravatar.com/avatar/75e7095602861915110e37614633b036?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                                    class="avatar avatar-32 photo"
                                                                    height="32"
                                                                    width="32"
                                                                />
                                                                <cite class="fn"
                                                                    >chris
                                                                    jones</cite
                                                                >
                                                                <span
                                                                    class="says"
                                                                    >says:</span
                                                                >
                                                            </div>

                                                            <div
                                                                class="comment-meta commentmetadata"
                                                            >
                                                                <a
                                                                    href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-124274"
                                                                >
                                                                    August 17,
                                                                    2009 at
                                                                    10:36 am</a
                                                                >
                                                            </div>

                                                            <p>
                                                                Yeah, I guess my
                                                                point is you
                                                                could just use a
                                                                function instead
                                                                of a class in
                                                                the first place
                                                                and not bother
                                                                with any of
                                                                this. This
                                                                problem comes up
                                                                every so often
                                                                and it seems
                                                                like people
                                                                forget you can
                                                                do that, because
                                                                they get so
                                                                invested in
                                                                solving the
                                                                bound/unbound
                                                                method problem.
                                                                When you think
                                                                about it, adding
                                                                &#95;&#95;call&#95;&#95;
                                                                to the class
                                                                instance is just
                                                                pretending
                                                                it&#8217;s a
                                                                function.
                                                                Here&#8217;s how
                                                                I would write
                                                                the original
                                                                decorator:
                                                            </p>

                                                            <pre><code>def wsgiapp(func):
    def inner(self, environ, start_response):
        resp = func(self, Request(environ))
        return resp(environ, start_response)
    return inner
</code></pre>

                                                            <p>
                                                                Does the same
                                                                thing, no magic.
                                                            </p>

                                                            <p>
                                                                I suppose
                                                                class-based
                                                                deco&#8217;s are
                                                                useful if your
                                                                decorator needs
                                                                to save state
                                                                between calls or
                                                                share it with
                                                                other decorated
                                                                functions, but
                                                                there are other
                                                                ways to do that,
                                                                such as having
                                                                the inner
                                                                function close
                                                                over a dict.
                                                                IMO, decorators
                                                                are a functional
                                                                idiom and trying
                                                                to force them to
                                                                work as an
                                                                object by
                                                                introducing all
                                                                this magic might
                                                                not be the best
                                                                practical
                                                                solution,
                                                                although
                                                                it&#8217;s a fun
                                                                exercise in
                                                                python internal
                                                                hacking.
                                                            </p>

                                                            <div
                                                                class="reply"
                                                            ></div>
                                                        </div>
                                                        <ul class="children">
                                                            <li
                                                                class="comment even depth-5"
                                                                id="comment-124388"
                                                            >
                                                                <div
                                                                    id="div-comment-124388"
                                                                    class="comment-body"
                                                                >
                                                                    <div
                                                                        class="comment-author vcard"
                                                                    >
                                                                        <img
                                                                            alt=""
                                                                            src="http://0.gravatar.com/avatar/619ea274d3ac8f15f9f243689e68d61d?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                                            class="avatar avatar-32 photo"
                                                                            height="32"
                                                                            width="32"
                                                                        />
                                                                        <cite
                                                                            class="fn"
                                                                            >Ale</cite
                                                                        >
                                                                        <span
                                                                            class="says"
                                                                            >says:</span
                                                                        >
                                                                    </div>

                                                                    <div
                                                                        class="comment-meta commentmetadata"
                                                                    >
                                                                        <a
                                                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-124388"
                                                                        >
                                                                            August
                                                                            18,
                                                                            2009
                                                                            at
                                                                            4:08
                                                                            am</a
                                                                        >
                                                                    </div>

                                                                    <p>
                                                                        Using
                                                                        the
                                                                        function
                                                                        you
                                                                        suggest
                                                                        will
                                                                        work for
                                                                        method
                                                                        decorating
                                                                        but not
                                                                        for
                                                                        function
                                                                        decorating.
                                                                        That was
                                                                        the
                                                                        point of
                                                                        using a
                                                                        descriptor
                                                                        and the
                                                                        reason
                                                                        to go
                                                                        with a
                                                                        class;
                                                                        it can
                                                                        handle
                                                                        both
                                                                        cases
                                                                    </p>

                                                                    <div
                                                                        class="reply"
                                                                    ></div>
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li
                                        class="comment byuser comment-author-ianb bypostauthor odd alt depth-2 parent"
                                        id="comment-124094"
                                    >
                                        <div
                                            id="div-comment-124094"
                                            class="comment-body"
                                        >
                                            <div class="comment-author vcard">
                                                <img
                                                    alt=""
                                                    src="http://0.gravatar.com/avatar/cc8334869c9d2a9e603017f2da805eb3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                    class="avatar avatar-32 photo"
                                                    height="32"
                                                    width="32"
                                                />
                                                <cite class="fn"
                                                    ><a
                                                        href="../../../../index.html"
                                                        rel="external nofollow"
                                                        class="url"
                                                        >Ian Bicking</a
                                                    ></cite
                                                >
                                                <span class="says">says:</span>
                                            </div>

                                            <div
                                                class="comment-meta commentmetadata"
                                            >
                                                <a
                                                    href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-124094"
                                                >
                                                    August 15, 2009 at 2:14
                                                    pm</a
                                                >
                                            </div>

                                            <p>
                                                You can kind of do this, but
                                                it&#8217;s difficult. Your
                                                descriptor would have to know
                                                the attribute it was bound to.
                                                So you might do:
                                            </p>

                                            <pre><code>class cache_descriptor(object):
    def __init__(self, attr, descriptor):
        self.attr = attr
        self.descriptor = descriptor
    def __get__(self, obj, type=None):
        result = self.descriptor.__get__(obj, type)
        if obj is not None:
            obj.__dict__[self.attr] = result
        return result
    def __set__(self, obj, value):
        self.descriptor.__set__(obj, value)
    def __delete__(self, obj):
        self.descriptor.__delete__(obj)
</code></pre>

                                            <p>
                                                Then you could do something
                                                like:
                                            </p>

                                            <pre><code>class MyThingy(object):
    @whatever
    def __call__(self, ...): ...
    __call__ = cache_descriptor('__call__', __call__)
</code></pre>

                                            <p>Or maybe separately:</p>

                                            <pre><code>def cache_descriptors(cls, *methods):
    for method in methods:
        setattr(cls, method, cache_descriptor(method, getattr(cls, method)))

class MyThingy(object): ...
cache_descriptors(MyThingy, '__call__', 'something_else', ...)
</code></pre>

                                            <p>
                                                I don&#8217;t cache these values
                                                in WebOb, but I do use a pattern
                                                of nested descriptors
                                                (<code>webob.converter</code>).
                                            </p>

                                            <div class="reply"></div>
                                        </div>
                                        <ul class="children">
                                            <li
                                                class="comment even depth-3"
                                                id="comment-159737"
                                            >
                                                <div
                                                    id="div-comment-159737"
                                                    class="comment-body"
                                                >
                                                    <div
                                                        class="comment-author vcard"
                                                    >
                                                        <img
                                                            alt=""
                                                            src="http://0.gravatar.com/avatar/67948daaccf4a831fb6ed67ff89193f3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                                            class="avatar avatar-32 photo"
                                                            height="32"
                                                            width="32"
                                                        />
                                                        <cite class="fn"
                                                            ><a
                                                                href="http://simonsapin.info/"
                                                                rel="external nofollow"
                                                                class="url"
                                                                >Simon Sapin</a
                                                            ></cite
                                                        >
                                                        <span class="says"
                                                            >says:</span
                                                        >
                                                    </div>

                                                    <div
                                                        class="comment-meta commentmetadata"
                                                    >
                                                        <a
                                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-159737"
                                                        >
                                                            April 18, 2010 at
                                                            5:33 pm</a
                                                        >
                                                    </div>

                                                    <p>
                                                        If the decorated objects
                                                        are functions (or
                                                        methods), they have a
                                                        <code>__name__</code>
                                                        attribute, so you don’t
                                                        need to pass explicitly
                                                        the name to the
                                                        descriptor. The
                                                        cached_property class in
                                                        Armin Ronacher’s
                                                        Werkzeug uses it:
                                                    </p>

                                                    <pre><code>class cached_property(object):
    """A decorator that converts a function into a lazy property.  The
    function wrapped is called the first time to retrieve the result
    and then that calculated result is used the next time you access
    the value::

        class Foo(object):

            @cached_property
            def foo(self):
                # calculate something important here
                return 42

    The class has to have a `__dict__` in order for this property to
    work.
    """

    # implementation detail: this property is implemented as non-data
    # descriptor.  non-data descriptors are only invoked if there is
    # no entry with the same name in the instance's __dict__.
    # this allows us to completely get rid of the access function call
    # overhead.  If one choses to invoke __get__ by hand the property
    # will still work as expected because the lookup logic is replicated
    # in __get__ for manual invocation.

    def __init__(self, func, name=None, doc=None):
        self.__name__ = name or func.__name__
        self.__module__ = func.__module__
        self.__doc__ = doc or func.__doc__
        self.func = func

    def __get__(self, obj, type=None):
        if obj is None:
            return self
        value = obj.__dict__.get(self.__name__, _missing)
        if value is _missing:
            value = self.func(obj)
            obj.__dict__[self.__name__] = value
        return value
</code></pre>

                                                    <div class="reply"></div>
                                                </div>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li
                                class="comment odd alt thread-even depth-1"
                                id="comment-54951"
                            >
                                <div
                                    id="div-comment-54951"
                                    class="comment-body"
                                >
                                    <div class="comment-author vcard">
                                        <img
                                            alt=""
                                            src="http://1.gravatar.com/avatar/dd1a815ca3634ab75bd9c92a719005d5?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                            class="avatar avatar-32 photo"
                                            height="32"
                                            width="32"
                                        />
                                        <cite class="fn"
                                            ><a
                                                href="http://self.maluke.com/"
                                                rel="external nofollow"
                                                class="url"
                                                >Sergey Schetinin</a
                                            ></cite
                                        >
                                        <span class="says">says:</span>
                                    </div>

                                    <div class="comment-meta commentmetadata">
                                        <a
                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-54951"
                                        >
                                            October 27, 2008 at 2:31 am</a
                                        >
                                    </div>

                                    <p>
                                        If anyone is interested, here&#8217;s a
                                        set of decorators I&#8217;m using all
                                        the time:
                                        <a
                                            href="http://svn.pythonpaste.org/Paste/WebOb/contrib/decorators.py"
                                            rel="nofollow"
                                            >http://svn.pythonpaste.org/Paste/WebOb/contrib/decorators.py</a
                                        >
                                    </p>

                                    <div class="reply"></div>
                                </div>
                            </li>
                            <li
                                class="comment even thread-odd thread-alt depth-1"
                                id="comment-104706"
                            >
                                <div
                                    id="div-comment-104706"
                                    class="comment-body"
                                >
                                    <div class="comment-author vcard">
                                        <img
                                            alt=""
                                            src="http://1.gravatar.com/avatar/154e8bddff46717ed8cca0582fee90f6?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG"
                                            class="avatar avatar-32 photo"
                                            height="32"
                                            width="32"
                                        />
                                        <cite class="fn">Profjim</cite>
                                        <span class="says">says:</span>
                                    </div>

                                    <div class="comment-meta commentmetadata">
                                        <a
                                            href="https://ianbicking.org/2008/10/24/decorators-and-descriptors/comment-page-1/#comment-104706"
                                        >
                                            May 4, 2009 at 6:31 pm</a
                                        >
                                    </div>

                                    <p>
                                        @Schuyler: here&#8217;s why I think your
                                        use case for @deco is working.
                                    </p>

                                    <p>You originally tried:</p>

                                    <p>
                                        class Foo: def bar(self,x): return x*3
                                    </p>

                                    <p>
                                        class Baz: #what some TG decorators do:
                                        foo = Foo() foo.bar.expose = True
                                    </p>

                                    <p>
                                        which gave you an AttributeError:
                                        &#8216;instancemethod&#8217; object has
                                        no attribute &#8216;expose&#8217;.
                                    </p>

                                    <p>
                                        What&#8217;s going on here is that
                                        foo.bar is a bound method
                                        (isinstance(foo.bar, types.MethodType))
                                        and neither they (nor unbound methods
                                        like Foo.bar) have
                                        <strong>dict</strong>&#8216;s. Hence you
                                        can&#8217;t assign new attributes to
                                        them.
                                    </p>

                                    <p>
                                        When you use the @deco technique
                                        instead:
                                    </p>

                                    <p>
                                        class Foo: @deco def bar(self,x): return
                                        x*3
                                    </p>

                                    <p>
                                        class Baz: foo = Foo() foo.bar.expose =
                                        True
                                    </p>

                                    <p>
                                        now foo.bar is no longer a method.
                                        Instead, it&#8217;s an attribute of foo
                                        which has a deco object as its value.
                                        This object does have a
                                        <strong>dict</strong> and can be
                                        assigned arbitrary new attributes, like
                                        expose.
                                    </p>

                                    <div class="reply"></div>
                                </div>
                            </li>
                        </ul>

                        <div class="navigation">
                            <div class="alignleft"></div>
                            <div class="alignright"></div>
                        </div>
                    </div>

                    <div class="navigation">
                        <div class="nav-left">
                            &laquo;
                            <a
                                href="../../06/the-philosophy-of-deliverance/index.html"
                                rel="prev"
                                >The Philosophy of Deliverance</a
                            >
                        </div>
                        <div class="nav-right">
                            <a
                                href="../hypertext-driven-urls/index.html"
                                rel="next"
                                >Hypertext-driven URLs</a
                            >
                            &raquo;
                        </div>
                    </div>
                    <!-- END NAVIGATION -->
                </div>
                <!-- END CONTENT -->
            </div>
            <!-- END CONTAINER  -->

            <div id="sidebar">
                <ul>
                    <li id="home-link">
                        <h2>
                            <a
                                href="../../../../index.html"
                                title="Ian Bicking: a blog"
                                >Home</a
                            >
                        </h2>
                    </li>
                    <li id="text-315934862" class="widget widget_text">
                        <h2 class="widgettitle">About</h2>
                        <div class="textwidget">
                            Ian is a developer with Mozilla,
                            <a href="http://ianbicking.appspot.com/projects"
                                >Python open source developer</a
                            >, actually uses
                            <a
                                href="https://plus.google.com/u/0/104537541227697934010/posts"
                                >Google+</a
                            >
                            more than
                            <a href="http://twitter.com/ianbicking">twitter</a>
                            and lives in Minneapolis.<br />
                            <span
                                class="gittip-0001"
                                gittip-username="ianbicking"
                            ></span>
                            <script
                                id="gittip-0001"
                                src="https://www.gittip.com/assets/widgets/0001.js"
                            ></script>
                        </div>
                    </li>
                    <li id="text-315934863" class="widget widget_text">
                        <div class="textwidget">
                            <!-- <script type="text/javascript">mbgc='f5f5f5';ww='160';mbc='cecece';bbc='3F79D5';bmobc='3b71c6';bbgc='4889F0';bmoc='3F79D5';bfc='FFFFFF';bmofc='ffffff';tlc='cecece';tc='6a6a6a';nc='6a6a6a';bc='6a6a6a';l='y';fs='16';fsb='13';bw='100';ff='4';lu='6a6a6a';pc='4889F0';wh='340';b='s'; pid='104537541227697934010';</script><script type="text/javascript" src="http://widgetsplus.com/google_plus_widget.js"></script> -->
                        </div>
                    </li>
                    <li id="archives-2" class="widget widget_archive">
                        <h2 class="widgettitle">Archives</h2>
                        <ul>
                            <li>
                                <a
                                    href="../../../../2012/10/index.html"
                                    title="October 2012"
                                    >October 2012</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2012/02/index.html"
                                    title="February 2012"
                                    >February 2012</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2011/04/index.html"
                                    title="April 2011"
                                    >April 2011</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2011/03/index.html"
                                    title="March 2011"
                                    >March 2011</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2010/09/index.html"
                                    title="September 2010"
                                    >September 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2010/08/index.html"
                                    title="August 2010"
                                    >August 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2010/05/index.html"
                                    title="May 2010"
                                    >May 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2010/04/index.html"
                                    title="April 2010"
                                    >April 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2010/03/index.html"
                                    title="March 2010"
                                    >March 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2010/02/index.html"
                                    title="February 2010"
                                    >February 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2010/01/index.html"
                                    title="January 2010"
                                    >January 2010</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2009/09/index.html"
                                    title="September 2009"
                                    >September 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2009/05/index.html"
                                    title="May 2009"
                                    >May 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2009/04/index.html"
                                    title="April 2009"
                                    >April 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2009/01/index.html"
                                    title="January 2009"
                                    >January 2009</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../12/index.html"
                                    title="December 2008"
                                    >December 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../11/index.html"
                                    title="November 2008"
                                    >November 2008</a
                                >
                            </li>
                            <li>
                                <a href="../../index.html" title="October 2008"
                                    >October 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../09/index.html"
                                    title="September 2008"
                                    >September 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../08/index.html"
                                    title="August 2008"
                                    >August 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../07/index.html"
                                    title="July 2008"
                                    >July 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../06/index.html"
                                    title="June 2008"
                                    >June 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../05/index.html"
                                    title="May 2008"
                                    >May 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../04/index.html"
                                    title="April 2008"
                                    >April 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../03/index.html"
                                    title="March 2008"
                                    >March 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../02/index.html"
                                    title="February 2008"
                                    >February 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../01/index.html"
                                    title="January 2008"
                                    >January 2008</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2007/11/index.html"
                                    title="November 2007"
                                    >November 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2007/10/index.html"
                                    title="October 2007"
                                    >October 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2007/09/index.html"
                                    title="September 2007"
                                    >September 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2007/08/index.html"
                                    title="August 2007"
                                    >August 2007</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../2007/07/index.html"
                                    title="July 2007"
                                    >July 2007</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li id="text-315934861" class="widget widget_text">
                        <div class="textwidget">
                            <a href="../../../../archive/index.html"
                                >The Older Archives</a
                            >
                        </div>
                    </li>
                    <li id="categories-1" class="widget widget_categories">
                        <h2 class="widgettitle">Categories</h2>
                        <ul>
                            <li class="cat-item cat-item-12">
                                <a
                                    href="../../../../category/erlang/index.html"
                                    title="View all posts filed under Erlang"
                                    >Erlang</a
                                >
                            </li>
                            <li class="cat-item cat-item-11">
                                <a
                                    href="../../../../category/html/index.html"
                                    title="View all posts filed under HTML"
                                    >HTML</a
                                >
                            </li>
                            <li class="cat-item cat-item-8">
                                <a
                                    href="../../../../category/javascript/index.html"
                                    title="View all posts filed under Javascript"
                                    >Javascript</a
                                >
                            </li>
                            <li class="cat-item cat-item-15">
                                <a
                                    href="../../../../category/licensing/index.html"
                                    title="View all posts filed under Licensing"
                                    >Licensing</a
                                >
                            </li>
                            <li class="cat-item cat-item-18">
                                <a
                                    href="../../../../category/mozilla/index.html"
                                    title="View all posts filed under Mozilla"
                                    >Mozilla</a
                                >
                            </li>
                            <li class="cat-item cat-item-5">
                                <a
                                    href="../../../../category/notech/index.html"
                                    title="View all posts filed under Non-technical"
                                    >Non-technical</a
                                >
                            </li>
                            <li class="cat-item cat-item-6">
                                <a
                                    href="../../../../category/olpc/index.html"
                                    title="View all posts filed under OLPC"
                                    >OLPC</a
                                >
                            </li>
                            <li class="cat-item cat-item-14">
                                <a
                                    href="../../../../category/packaging/index.html"
                                    title="View all posts filed under Packaging"
                                    >Packaging</a
                                >
                            </li>
                            <li class="cat-item cat-item-4">
                                <a
                                    href="../../../../category/politics/index.html"
                                    title="View all posts filed under Politics"
                                    >Politics</a
                                >
                            </li>
                            <li class="cat-item cat-item-3">
                                <a
                                    href="../../../../category/programming/index.html"
                                    title="View all posts filed under Programming"
                                    >Programming</a
                                >
                            </li>
                            <li class="cat-item cat-item-7">
                                <a
                                    href="../../../../category/python/index.html"
                                    title="View all posts filed under Python"
                                    >Python</a
                                >
                            </li>
                            <li class="cat-item cat-item-10">
                                <a
                                    href="../../../../category/ruby/index.html"
                                    title="View all posts filed under Ruby"
                                    >Ruby</a
                                >
                            </li>
                            <li class="cat-item cat-item-19">
                                <a
                                    href="../../../../category/security/index.html"
                                    title="View all posts filed under Security"
                                    >Security</a
                                >
                            </li>
                            <li class="cat-item cat-item-16">
                                <a
                                    href="../../../../category/silverlining.1"
                                    title="View all posts filed under Silver Lining"
                                    >Silver Lining</a
                                >
                            </li>
                            <li class="cat-item cat-item-20">
                                <a
                                    href="../../../../category/programming/testing/index.html"
                                    title="View all posts filed under Testing"
                                    >Testing</a
                                >
                            </li>
                            <li class="cat-item cat-item-9">
                                <a
                                    href="../../../../category/web/index.html"
                                    title="View all posts filed under Web"
                                    >Web</a
                                >
                            </li>
                            <li class="cat-item cat-item-13">
                                <a
                                    href="../../../../category/zopeplone/index.html"
                                    title="View all posts filed under Zope/Plone"
                                    >Zope/Plone</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li id="search-2" class="widget widget_search">
                        <form
                            id="searchform"
                            method="get"
                            action="../../../../index.html"
                        >
                            <div>
                                <input
                                    id="s"
                                    name="s"
                                    type="text"
                                    value=""
                                    tabindex="1"
                                    size="10"
                                />
                                <input
                                    id="searchsubmit"
                                    name="searchsubmit"
                                    type="submit"
                                    value="Find"
                                    tabindex="2"
                                />
                            </div>
                        </form>
                    </li>
                    <li
                        id="recent-posts-2"
                        class="widget widget_recent_entries"
                    >
                        <h2 class="widgettitle">Recent Posts</h2>
                        <ul>
                            <li>
                                <a
                                    href="../../../../index.html?p=291"
                                    title="Why doctest.js is better than Python&#8217;s doctest"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../index.html?p=283"
                                    title="Python Application Package"
                                    >Python Application Package</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../index.html?p=277"
                                    title="Git-as-sync, not source-control-as-deployment"
                                    >Git-as-sync, not
                                    source-control-as-deployment</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../index.html?p=253"
                                    title="My Unsolicited Advice For PyPy"
                                    >My Unsolicited Advice For PyPy</a
                                >
                            </li>
                            <li>
                                <a
                                    href="../../../../index.html?p=250"
                                    title="A Python Web Application Package and Format (we should make one)"
                                    >A Python Web Application Package and Format
                                    (we should make one)</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li
                        id="recent-comments-2"
                        class="widget widget_recent_comments"
                    >
                        <h2 class="widgettitle">Recent Comments</h2>
                        <ul id="recentcomments">
                            <li class="recentcomments">
                                <a
                                    href="http://www.mirsa.com.tr"
                                    rel="external nofollow"
                                    class="url"
                                    >havalandırma</a
                                >
                                on
                                <a
                                    href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-228633"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                <a
                                    href="http://redealmeidense.com.br/portalx/modules/"
                                    rel="external nofollow"
                                    class="url"
                                    >this website</a
                                >
                                on
                                <a
                                    href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-196267"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                Eric Pierce on
                                <a
                                    href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195322"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                Paul Brian on
                                <a
                                    href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195321"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                            <li class="recentcomments">
                                <a
                                    href="http://benjiyork.com"
                                    rel="external nofollow"
                                    class="url"
                                    >Benji York</a
                                >
                                on
                                <a
                                    href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195320"
                                    >Why doctest.js is better than
                                    Python&#8217;s doctest</a
                                >
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div id="footer">
                <p>
                    &copy; 2013 Ian Bicking<!--
Does this commenting make me evil?
			|
			Thanks, <a href="http://wordpress.org/" title="WordPress">WordPress</a>
			|
			<a href="http://www.plaintxt.org/themes/barthelme/" title="Barthelme for WordPress" rel="follow">Barthelme</a> theme by <a href="http://scottwallick.com/" title="scottwallick.com" rel="follow">Scott</a>
			| <!-- The following is a link to the theme author's sponsor. Please consider its smallness and that Scott was nice enough to make this theme publically available. -->
                    Sponsor:
                    <a
                        href="http://www.active-sandals.com/womreefsan.html"
                        title="Support: Reef Sandals"
                        >Reef Sandals</a
                    >
                    | Valid
                    <a
                        href="http://validator.w3.org/check?uri=http://blog.ianbicking.org&amp;outline=1&amp;verbose=1"
                        title="Valid XHTML 1.0 Strict"
                        rel="nofollow"
                        >XHTML</a
                    >
                    &amp;
                    <a
                        href="http://jigsaw.w3.org/css-validator/validator?uri=https://ianbicking.org/wp-content/themes/Barthelme-ianb/style.css&amp;profile=css2&amp;warning=no"
                        title="Valid CSS"
                        rel="nofollow"
                        >CSS</a
                    >
                    | --> RSS:
                    <a
                        href="../../../../feed/rss/index.html"
                        title="Ian Bicking: a blog RSS 2.0 (XML) Feed"
                        rel="alternate"
                        type="application/rss+xml"
                        >Posts</a
                    >
                    &amp;
                    <a
                        href="../../../../comments/feed/index.html"
                        title="Ian Bicking: a blog Comments RSS 2.0 (XML) Feed"
                        rel="alternate"
                        type="application/rss+xml"
                        >Comments</a
                    >
                </p>
            </div>
        </div>
        <!-- END WRAPPER -->

        <!-- Somehow 44 queries occured in 1.773 seconds. Magic! -->
        <!-- The "Barthelme" theme copyright (c) 2006 Scott Allan Wallick - http://www.plaintxt.org/themes/ -->
        <script
            type="text/javascript"
            src="../../../../wp-includes/js/comment-reply.js?ver=3.4.2"
        ></script>

        <!-- Google Analytics -->
        <script
            src="http://www.google-analytics.com/urchin.js"
            type="text/javascript"
        ></script>
        <script type="text/javascript">
            _uacct = "UA-2442258-1";
            urchinTracker();
        </script>
    </body>
</html>
