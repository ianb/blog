<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- MOBIFY - DO NOT ALTER - PASTE IMMEDIATELY AFTER OPENING HEAD TAG -->
<script type="text/javascript">/*<![CDATA[*/(function(a){function b(a,b){if(+a)return~a||(d.cookie=h+"=; path=/");j=d.createElement(e),k=d.getElementsByTagName(e)[0],j.src=a,b&&(j.onload=j.onerror=b),k.parentNode.insertBefore(j,k)}function c(){n.api||b(l.shift()||-1,c)}if(this.Mobify)return;var d=document,e="script",f="mobify",g="."+f+".com/",h=f+"-path",i=g+"un"+f+".js",j,k,l=[!1,1],m,n=this.Mobify={points:[+(new Date)],tagVersion:[6,0]},o=/(; |#|&|^)mobify-path=([^&;]*)/g.exec(location.hash+"; "+d.cookie);o?(m=o[2])&&!+(m=sessionStorage[h]||m)&&(l=[!0,"//preview"+g+escape(m)]):(l=a()||l,l[0]&&l.push("//cdn"+i,"//files01"+i)),l.shift()?(d.write('<plaintext style="display:none;">'),setTimeout(c)):b(l[0])})(function(){if(/ip(hone|od)|android.*(mobile)|blackberry.*applewebkit/i.test(navigator.userAgent)){return[1,"//cdn.mobify.com/sites/ians-blog/production/mobify.js"]}})/*]]>*/</script>
<!-- END MOBIFY -->
	<title>Ian Bicking: a blog   ::  Web</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="generator" content="WordPress 3.4.2" /><!-- LEAVE FOR STATS -->
	<meta name="description" content="" />
	<link rel="stylesheet" title="plaintxtSimpler" href="../../../../wp-content/themes/Barthelme-ianb/style.css" type="text/css" media="all" />
	<link rel="start" href="../../../../index.html" title="Ian Bicking: a blog" />
	<link rel="alternate" type="application/atom+xml" title="Ian Bicking: a blog Atom Feed" href="../../../../feed/atom/index.html" />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog RSS 2.0 Feed" href="../../../../feed/rss/index.html" />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog Comments RSS 2.0 Feed" href="../../../../comments/feed/index.html" />
	<link rel="alternate" type="application/rdf+xml" title="Ian Bicking: a blog RSS 1.0" href="../../../../feed/rdf/index.html" />
	<link rel="alternate" type="text/xml" title="Ian Bicking: a blog RSS 0.92 Feed" href="../../../../feed/rss/index.html" />
	<link rel="pingback" href="../../../../xmlrpc.php" />
	<link rel="openid.server" href="http://www.myopenid.com/server" />
	<link rel="openid.delegate" href="http://ianb.myopenid.com" />
        <link rel="me" type="text/html" href="http://www.google.com/profiles/ianbicking"/>
		<link rel='archives' title='October 2012' href='../../../../2012/10/index.html' />
	<link rel='archives' title='February 2012' href='../../../../2012/02/index.html' />
	<link rel='archives' title='April 2011' href='../../../../2011/04/index.html' />
	<link rel='archives' title='March 2011' href='../../../../2011/03/index.html' />
	<link rel='archives' title='September 2010' href='../../../../2010/09/index.html' />
	<link rel='archives' title='August 2010' href='../../../../2010/08/index.html' />
	<link rel='archives' title='May 2010' href='../../../../2010/05/index.html' />
	<link rel='archives' title='April 2010' href='../../../../2010/04/index.html' />
	<link rel='archives' title='March 2010' href='../../../../2010/03/index.html' />
	<link rel='archives' title='February 2010' href='../../../../2010/02/index.html' />
	<link rel='archives' title='January 2010' href='../../../../2010/01/index.html' />
	<link rel='archives' title='September 2009' href='../../../../2009/09/index.html' />
	<link rel='archives' title='May 2009' href='../../../../2009/05/index.html' />
	<link rel='archives' title='April 2009' href='../../../../2009/04/index.html' />
	<link rel='archives' title='January 2009' href='../../../../2009/01/index.html' />
	<link rel='archives' title='December 2008' href='../../../../2008/12/index.html' />
	<link rel='archives' title='November 2008' href='../../../../2008/11/index.html' />
	<link rel='archives' title='October 2008' href='../../../../2008/10/index.html' />
	<link rel='archives' title='September 2008' href='../../../../2008/09/index.html' />
	<link rel='archives' title='August 2008' href='../../../../2008/08/index.html' />
	<link rel='archives' title='July 2008' href='../../../../2008/07/index.html' />
	<link rel='archives' title='June 2008' href='../../../../2008/06/index.html' />
	<link rel='archives' title='May 2008' href='../../../../2008/05/index.html' />
	<link rel='archives' title='April 2008' href='../../../../2008/04/index.html' />
	<link rel='archives' title='March 2008' href='../../../../2008/03/index.html' />
	<link rel='archives' title='February 2008' href='../../../../2008/02/index.html' />
	<link rel='archives' title='January 2008' href='../../../../2008/01/index.html' />
	<link rel='archives' title='November 2007' href='../../../../2007/11/index.html' />
	<link rel='archives' title='October 2007' href='../../../../2007/10/index.html' />
	<link rel='archives' title='September 2007' href='../../../../2007/09/index.html' />
	<link rel='archives' title='August 2007' href='../../../../2007/08/index.html' />
	<link rel='archives' title='July 2007' href='../../../../2007/07/index.html' />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog &raquo; Web Category Feed" href="../../feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 3.4.2" />
<link rel="stylesheet" href="../../../../wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"  type="text/css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
        <style type="text/css" media="all">
/*<![CDATA[*/
body { font-size: 100%; }
body { font-family: tahoma, geneva, sans-serif; }
div.post-header, h2.post-title, p.post-date-single, h2.post-title-single, div.post-entry h1, div.post-entry h2, div.post-entry h3, div.post-entry h4, div.post-entry h5, div.post-entry h6, div.post-entry blockquote, div.post-footer, h3#comment-count, h4#comment-header, div#comments ol li p.comment-metadata, h4#respond { font-family: verdana, geneva, sans-serif; }
div.post-entry p { text-align: left; }
div#wrapper { width: 100%; }

/*]]>*/
</style>
</head>
<body>

<div id="wrapper">

	<div id="header" onclick="location.href='http://blog.ianbicking.org/';" style="cursor:pointer;">
		<h1 id="title"><a href="../../../../index.html" title="Ian Bicking: a blog">Ian Bicking: a blog</a></h1>
		<p id="description"></p>
	</div>
<!-- WP Theme Credits -->
<div style="display: none;">We can answer on question <a href="http://www.olnevhost.net/vps-hosting.html">what is VPS</a>? and
what is <a href="http://www.olnevhost.net/dedicated-servers.html"><strong>cheap dedicated servers</strong></a>?</div>
<!-- END HEADER -->
<div id="container">
	<div id="content" class="narrowcolumn">


				
		<p class="post-date-single">{ Category Archives }</p>
		<h2 class="post-title-single">Web</h2>		

				
		<div id="post-168" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2010/03/03/toppcloud-renamed-to-silver-lining/index.html" title="Permalink to toppcloud renamed to Silver Lining" rel="bookmark">toppcloud renamed to Silver Lining</a></h2>
					<div class="post-entry">
						<div class="document">
<p>After some pondering at PyCon, I decided on a new name for toppcloud: <strong>Silver Lining</strong>.  I&#8217;ll credit a mysterious commenter &quot;david&quot; with the name idea.  The command line is simply <tt class="docutils literal"><span class="pre">silver</span></tt> &#8212; <tt class="docutils literal"><span class="pre">silver</span> <span class="pre">update</span></tt> has a nice ring to it.</p>
<p>There&#8217;s a new site: <a class="reference external" href="http://cloudsilverlining.org">cloudsilverlining.org</a>; not notably different than the old site, just a new name.  The product is self-hosting now, using a <a class="reference external" href="http://bitbucket.org/ianb/silverlining/">simple app</a> that runs after every commit to regenerate the docs, and with a small extension to Silver Lining itself (to make it easier to host static files).  Now that it has a real name I also gave it a <a class="reference external" href="http://groups.google.com/group/silverlining-dev">real mailing list</a>.</p>
<p>Silver Lining also has its <a class="reference external" href="http://bitbucket.org/ianb/silverlining/src/tip/tests/functional/runtest.py">first test</a>.  Not an impressive test, but a test.  I&#8217;m hoping with a <a class="reference external" href="http://mail-archives.apache.org/mod_mbox/incubator-libcloud/201003.mbox/browser">VM-based libcloud backend</a> that a full integration test can run in a reasonable amount of time.  <em>Some</em> unit tests would be possible, but so far most of the bugs have been interaction bugs so I think integration tests will have to pull most of the weight.  (A continuous integration rig will be very useful; I am not sure if Silver Lining can self-host that, though it&#8217;d be nice/clever if it could.)</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/03/03/toppcloud-renamed-to-silver-lining/"
    dc:identifier="http://blog.ianbicking.org/2010/03/03/toppcloud-renamed-to-silver-lining/"
    dc:title="toppcloud renamed to Silver Lining"
    trackback:ping="http://blog.ianbicking.org/2010/03/03/toppcloud-renamed-to-silver-lining/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 03 03</h3>
				<p class="post-categories"><a href="../../../packaging/index.html" title="View all posts in Packaging" rel="category tag">Packaging</a><br/><a href="../../../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="../../../python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../../../silverlining.1" title="View all posts in Silver Lining" rel="category tag">Silver Lining</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2010/03/03/toppcloud-renamed-to-silver-lining/index.html#comments" title="Comment on toppcloud renamed to Silver Lining">Comments (7)</a></p>
				<p class="post-permalink"><a href="../../../../2010/03/03/toppcloud-renamed-to-silver-lining/index.html" title="Permalink to toppcloud renamed to Silver Lining" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-164" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2010/03/01/throw-out-your-frameworks-forms-included/index.html" title="Permalink to Throw out your frameworks! (forms included)" rel="bookmark">Throw out your frameworks! (forms included)</a></h2>
					<div class="post-entry">
						<div class="document">
<p>No, I should say <em>forms particularly</em>.</p>
<p>I have lots of things to blog about, but nothing makes me want to blog like <em>code</em>.  Ideas are hard, code is easy.  So when I saw <a class="reference external" href="http://jacobian.org/writing/dynamic-form-generation/">Jacob&#8217;s writeup about dynamic Django form generation</a> I felt a desire to respond.  I didn&#8217;t see the form panel at PyCon (I intended to but I hardly saw <em>any</em> talks at PyCon, and yet still didn&#8217;t even see a good number of the people I wanted to see), but as the author of an <a class="reference external" href="http://formencode.org/htmlfill.html">ungenerator</a> and as a general <a class="reference external" href="../../../../on-form-libraries.html">form library skeptic</a> I have a somewhat different perspective on the topic.</p>
<p>The example created for the panel might display that perspective.  You should go read <a class="reference external" href="http://jacobian.org/writing/dynamic-form-generation/">Jacob&#8217;s description</a>; but basically it&#8217;s a simple registration form with a dynamic set of questions to ask.</p>
<p>I have created a <a class="reference external" href="http://svn.colorstudy.com/home/ianb/formencode_answer.py">complete example</a>, because I wanted to be sure I wasn&#8217;t skipping anything, but I&#8217;ll present a trimmed-down version.</p>
<p>First, the basic control logic:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> webob.<span class="me1">dec</span> <span class="kw1">import</span> wsgify<br />
<span class="kw1">from</span> webob <span class="kw1">import</span> exc<br />
<span class="kw1">from</span> formencode <span class="kw1">import</span> htmlfill<br />
<br />
@<span class="co1">wsgify</span><br />
<span class="kw1">def</span> questioner<span class="br0">&#40;</span>req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; questions = get_questions<span class="br0">&#40;</span>req<span class="br0">&#41;</span> <span class="co1"># This is provided as part of the example</span><br />
&nbsp; &nbsp; <span class="kw1">if</span> req.<span class="me1">method</span> == <span class="st0">'POST'</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; errors = validate<span class="br0">&#40;</span>req, questions<span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw1">not</span> errors:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ... <span class="me1">save</span> response ...<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPFound</span><span class="br0">&#40;</span>location=<span class="st0">'/thanks'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">else</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; errors = <span class="br0">&#123;</span><span class="br0">&#125;</span><br />
&nbsp; &nbsp; <span class="co1">## Here's the &quot;form generation&quot;:</span><br />
&nbsp; &nbsp; page = page_template.<span class="me1">substitute</span><span class="br0">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; action=req.<span class="me1">url</span>,<br />
&nbsp; &nbsp; &nbsp; &nbsp; questions=questions<span class="br0">&#41;</span><br />
&nbsp; &nbsp; page = htmlfill.<span class="me1">render</span><span class="br0">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; page,<br />
&nbsp; &nbsp; &nbsp; &nbsp; defaults=req.<span class="me1">POST</span>,<br />
&nbsp; &nbsp; &nbsp; &nbsp; errors=errors<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">return</span> Response<span class="br0">&#40;</span>page<span class="br0">&#41;</span><br />
<br />
<span class="kw1">def</span> validate<span class="br0">&#40;</span>req, questions<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="co1"># All manual, but do it however you want:</span><br />
&nbsp; &nbsp; errors = <span class="br0">&#123;</span><span class="br0">&#125;</span><br />
&nbsp; &nbsp; form = req.<span class="me1">POST</span><br />
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>form.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'password'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">and</span> form<span class="br0">&#91;</span><span class="st0">'password'</span><span class="br0">&#93;</span> != form.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'password_confirm'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; errors<span class="br0">&#91;</span><span class="st0">'password_confirm'</span><span class="br0">&#93;</span> = <span class="st0">'Passwords do not match'</span><br />
&nbsp; &nbsp; fields = questions + <span class="br0">&#91;</span><span class="st0">'username'</span>, <span class="st0">'password'</span><span class="br0">&#93;</span><br />
&nbsp; &nbsp; <span class="kw1">for</span> field <span class="kw1">in</span> fields:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw1">not</span> form.<span class="me1">get</span><span class="br0">&#40;</span>field<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; errors<span class="br0">&#91;</span>field<span class="br0">&#93;</span> = <span class="st0">'Please enter a value'</span><br />
&nbsp; &nbsp; <span class="kw1">return</span> errors<br />
&nbsp;</div>
<p>I&#8217;ve just manually handled validation here.  I don&#8217;t feel like doing it with FormEncode.  Manual validation isn&#8217;t that big a deal; FormEncode would just produce the same <tt class="docutils literal"><span class="pre">errors</span></tt> dictionary anyway.  In this case (as in many form validation cases) you can&#8217;t do better than hand-written validation code: it&#8217;s shorter, more self-contained, and easier to tweak.</p>
<p>After validation the template is rendered:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
page = page_template.<span class="me1">substitute</span><span class="br0">&#40;</span><br />
&nbsp; &nbsp; action=req.<span class="me1">url</span>,<br />
&nbsp; &nbsp; questions=questions<span class="br0">&#41;</span><br />
&nbsp;</div>
<p>I&#8217;m using <a class="reference external" href="http://pythonpaste.org/tempita/">Tempita</a>, but it really doesn&#8217;t matter.  The template looks like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;form action=<span class="st0">&quot;{{action}}&quot;</span> method=<span class="st0">&quot;POST&quot;</span>&gt;<br />
New Username: &lt;input <span class="kw2">type</span>=<span class="st0">&quot;text&quot;</span> name=<span class="st0">&quot;username&quot;</span>&gt;&lt;br /&gt;<br />
Password: &lt;input <span class="kw2">type</span>=<span class="st0">&quot;password&quot;</span> name=<span class="st0">&quot;password&quot;</span>&gt;&lt;br /&gt;<br />
Repeat Password:<br />
&nbsp; &lt;input <span class="kw2">type</span>=<span class="st0">&quot;password&quot;</span> name=<span class="st0">&quot;password_confirm&quot;</span>&gt;&lt;br /&gt;<br />
<span class="br0">&#123;</span><span class="br0">&#123;</span><span class="kw1">for</span> question <span class="kw1">in</span> questions<span class="br0">&#125;</span><span class="br0">&#125;</span><br />
&nbsp; <span class="br0">&#123;</span><span class="br0">&#123;</span>question<span class="br0">&#125;</span><span class="br0">&#125;</span>: &lt;input <span class="kw2">type</span>=<span class="st0">&quot;text&quot;</span> name=<span class="st0">&quot;{{question}}&quot;</span>&gt;&lt;br /&gt;<br />
<span class="br0">&#123;</span><span class="br0">&#123;</span>endfor<span class="br0">&#125;</span><span class="br0">&#125;</span><br />
&lt;input <span class="kw2">type</span>=<span class="st0">&quot;submit&quot;</span>&gt;<br />
&lt;/form&gt;<br />
&nbsp;</div>
<p>Note that the only &quot;logic&quot; here is to render the form to include fields for all the questions.  Obviously this produces an ugly form, but it&#8217;s <em>very obvious</em> how you make this form pretty, and how to tweak it in any way you might want.  Also if you have deeper dynamicism (e.g., <tt class="docutils literal"><span class="pre">get_questions</span></tt> start returning the type of response required, or weird validation, or whatever) it&#8217;s <em>very obvious</em> where that change would go: display logic goes in the form, validation logic goes in that validate function.</p>
<p>This just gives you the raw form.  You wouldn&#8217;t need a template at all if it wasn&#8217;t for the dynamicism.  Everything else is added when the form is &quot;filled&quot;:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
page = htmlfill.<span class="me1">render</span><span class="br0">&#40;</span><br />
&nbsp; &nbsp; page,<br />
&nbsp; &nbsp; defaults=req.<span class="me1">POST</span>,<br />
&nbsp; &nbsp; errors=errors<span class="br0">&#41;</span><br />
&nbsp;</div>
<p>How exactly you want to calculate <tt class="docutils literal"><span class="pre">defaults</span></tt> is up to the application; you might want query string variables to be able to pre-fill the form (use <tt class="docutils literal"><span class="pre">req.params</span></tt>), you might want the form bare to start (like here with <tt class="docutils literal"><span class="pre">req.POST</span></tt>), you can easily implement wizards by stuffing <tt class="docutils literal"><span class="pre">req.POST</span></tt> into the session to repeat a form, you might read the defaults out of a user object to make this an edit form.  And errors are just handled automatically, inserted into the HTML with appropriate CSS classes.</p>
<p>A great aspect of this <em>pattern</em> if you use it (I&#8217;m not even sure it deserves the moniker <em>library</em>): when <a class="reference external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/forms.html#forms">HTML 5 Forms</a> finally come around and we can all stop doing this stupid server-side overthought nonsense, <strong>you</strong> won&#8217;t have overthought your forms.  Your mind will be free and ready to accept that the world has actually become simpler, not more complicated, and that there is knowledge worth forgetting (forms are so freakin&#8217; stupid!)  If at all possible, dodging complexity is far better than cleverly responding to complexity.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/03/01/throw-out-your-frameworks-forms-included/"
    dc:identifier="http://blog.ianbicking.org/2010/03/01/throw-out-your-frameworks-forms-included/"
    dc:title="Throw out your frameworks! (forms included)"
    trackback:ping="http://blog.ianbicking.org/2010/03/01/throw-out-your-frameworks-forms-included/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 03 01</h3>
				<p class="post-categories"><a href="../../../html/index.html" title="View all posts in HTML" rel="category tag">HTML</a><br/><a href="../../../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="../../../python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2010/03/01/throw-out-your-frameworks-forms-included/index.html#comments" title="Comment on Throw out your frameworks! (forms included)">Comments (27)</a></p>
				<p class="post-permalink"><a href="../../../../2010/03/01/throw-out-your-frameworks-forms-included/index.html" title="Permalink to Throw out your frameworks! (forms included)" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-158" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2010/02/10/why-toppcloud-not-agnostic/index.html" title="Permalink to Why toppcloud (Silver Lining) will not be agnostic" rel="bookmark">Why toppcloud (Silver Lining) will not be agnostic</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I haven&#8217;t received a great deal of <em>specific</em> feedback on toppcloud (<strong>update</strong>: renamed Silver Lining), only a few people (Ben Bangert, Jorge Vargas) seem to have really dived deeply into it.  But &#8212; and this is not unexpected &#8212; I have already gotten several requests about making it more agnostic with respect to&#8230; stuff.  Maybe that it not (at least forever) require Ubuntu.  Or maybe that it should support different process models (e.g., threaded and multiple processes).  Or other versions of Python.</p>
<p>The more I think about it, and the more I work with the tool, the more confident I am that toppcloud should not be agnostic on these issues.  This is not so much about an &quot;opinionated&quot; tool; toppcloud is not actually very opinionated.  It&#8217;s about a well-understood system.</p>
<p>For instance, Ben noticed a problem recently with <a class="reference external" href="http://code.google.com/p/modwsgi/issues/detail?id=177">weird import errors</a>.  I don&#8217;t know <em>quite</em> why mod_wsgi has this particular problem (when other WSGI servers that I&#8217;ve used haven&#8217;t), but the fix isn&#8217;t that hard.  So Ben <a class="reference external" href="http://bitbucket.org/ianb/toppcloud/changeset/27a470352a5e/">committed a fix</a> and the problem went away.</p>
<p>Personally I think this is a bug with mod_wsgi.  Maybe it&#8217;s also a Python bug.  But it doesn&#8217;t really matter.  When a bug exists it &quot;belongs&quot; to everyone who encounters it.</p>
<p>toppcloud is not intended to be a transparent system.  When it&#8217;s working correctly, you should be able to ignore most of the system and concentrate on the relatively simple abstractions given to your application.  So if the configuration reveals this particular bug in Python/mod_wsgi, then the bug is essentially a toppcloud bug, and toppcloud should (and <em>can</em>) fix it.</p>
<p>A more flexible system can ignore such problems as being &quot;somewhere else&quot; in the system.  Or, if you don&#8217;t define these problems as someone else&#8217;s problem, then a more flexible system is essentially always broken somewhere; there is always some untested combination, some new component, or some old component that might get pushed into the mix.  Fixes for one person&#8217;s problem may introduce a new problem in someone else&#8217;s stack.  Some fixes aren&#8217;t even clear.  toppcloud has Varnish in place, so it&#8217;s quite clear where a <a class="reference external" href="http://bitbucket.org/ianb/toppcloud/changeset/614d5366be67/">fix related to Django and Varnish configuration goes</a>.  If these were each components developed by different people at different times (like with buildout recipes) then fixing something like this could get complicated.</p>
<p>So I feel very resolved: toppcloud will hardcode everything it possibly can.  Python 2.6 and only 2.6!  (Until 2.7, but then <strong>only 2.7</strong>!).  Only Varnish/Apache/mod_wsgi.  I haven&#8217;t figured out threads/processes exactly, but once I do, there will be only one way!  And if I get it wrong, then everyone (<strong>everyone</strong>) will have to switch when it is corrected!  Because I&#8217;d much rather have a system that is inflexible than one that doesn&#8217;t work.  With a clear and solid design I think it is feasible to get this to work, and that is no small feat.</p>
<p>Relatedly, <a class="reference external" href="../../../../2010/02/09/leaving-topp/comment-page-1/index.html#comment-151194">I think I&#8217;m going to change the name of toppcloud</a>, so ideas are welcome!</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/02/10/why-toppcloud-not-agnostic/"
    dc:identifier="http://blog.ianbicking.org/2010/02/10/why-toppcloud-not-agnostic/"
    dc:title="Why toppcloud (Silver Lining) will not be agnostic"
    trackback:ping="http://blog.ianbicking.org/2010/02/10/why-toppcloud-not-agnostic/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 02 10</h3>
				<p class="post-categories"><a href="../../../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="../../../python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../../../silverlining.1" title="View all posts in Silver Lining" rel="category tag">Silver Lining</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2010/02/10/why-toppcloud-not-agnostic/index.html#comments" title="Comment on Why toppcloud (Silver Lining) will not be agnostic">Comments (23)</a></p>
				<p class="post-permalink"><a href="../../../../2010/02/10/why-toppcloud-not-agnostic/index.html" title="Permalink to Why toppcloud (Silver Lining) will not be agnostic" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-149" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2010/02/06/weave-client-side-data/index.html" title="Permalink to Weave: valuable client-side data" rel="bookmark">Weave: valuable client-side data</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;ve been looking at <a class="reference external" href="https://mozillalabs.com/weave/">Weave</a> some lately.  The large-print summary on the page is <em>Synchronize Your Firefox Experience Across Desktop and Mobile</em>.  Straight forward enough.</p>
<p>Years and years ago I stopped really using bookmarks.  You lose them moving from machine to machine (which Weave could help), but mostly I stopped using them because it was too hard to (a) identify interesting content and place it into a taxonomy and (b) predict what I would later be interested in.  If I wanted to refer to something I&#8217;d seen before there&#8217;s a good chance I wouldn&#8217;t have saved it, while my bookmarks would be flooded with things that time would show were of transient interest.</p>
<p>So&#8230; synchronizing bookmarks, eh.  Saved form data and logins?  Sure, that&#8217;s handy.  It would make browsing on multiple machines <em>nicer</em>.  But it feels more like a handy tweak.</p>
<p>All my <em>really</em> useful data is kept on servers, categorized and protected by a user account.  Why is that?  Well, of course, where else would you keep it?  In cookies?  Ha!</p>
<p>Why not in cookies?  So many reasons&#8230; because cookies are opaque and can&#8217;t hold much data, can&#8217;t be exchanged, and probably worst of all they just disappear randomly.</p>
<p>What if cookies weren&#8217;t so impossibly lame for holding important data?  Suddenly sync seems much more interesting.  Instead of storing documents and data on a website, the website could put all that data right into your browser.  And conveniently <a class="reference external" href="http://en.wikipedia.org/wiki/DOM_storage">HTML 5 has an API for that</a>.  Everyone thinks about that API as a way of handling off-line caching, because while it handles many problems with cookies it doesn&#8217;t handle the problem of data disappearing as you move between computers and browser.  That&#8217;s where Weave synchronization could change things.  I don&#8217;t think this technique is something appropriate for every app (maybe not most apps), but it could allow a new class of applications.</p>
<p>Advantages: web development and scaling becomes easy.  If you store data in the browser scaling is almost free; serving static pages is a Solved Problem.  Development is easier because development and deployment of HTML and Javascript is pretty easy.  Forking is easy &#8212; just copy all the resources.  So long as you don&#8217;t hardcode absolute links into your Javascript, you can even just save from the browser and get a working local copy of the application.</p>
<p>Disadvantages: another silo.  You might complain about Facebook keeping everyone&#8217;s data, but the data in Facebook is <em>still</em> more transparent than data held in files or locally with a browser.  Let&#8217;s say you create a word processor that uses local storage for all its documents.  If you stored that document online sharing and collaboration would be really easy; but with it stored locally the act of sharing is not as automatic, and collaboration is <em>very hard</em>.  Sure, the &quot;user&quot; is in &quot;control&quot; of their data, but that would be more true on paper than in practice.  Building collaboration on top of local storage is hard, and without that&#8230; maybe it&#8217;s not that interesting?</p>
<p>Anyway, there is an interesting (but maybe Much Too Hard) problem in there.  (DVCS in the browser?)</p>
<p><strong>Update</strong>: in <a class="reference external" href="http://www.azarask.in/blog/post/you-centric-a-sketch-of-the-future-of-browsers/">this video</a> Aza talks about just what I talk about here.  A few months ago.  The Weave APIs also allude to things like this, including collaboration.  So&#8230; they are on it!</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/02/06/weave-client-side-data/"
    dc:identifier="http://blog.ianbicking.org/2010/02/06/weave-client-side-data/"
    dc:title="Weave: valuable client-side data"
    trackback:ping="http://blog.ianbicking.org/2010/02/06/weave-client-side-data/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 02 06</h3>
				<p class="post-categories"><a href="../../../html/index.html" title="View all posts in HTML" rel="category tag">HTML</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2010/02/06/weave-client-side-data/index.html#comments" title="Comment on Weave: valuable client-side data">Comments (2)</a></p>
				<p class="post-permalink"><a href="../../../../2010/02/06/weave-client-side-data/index.html" title="Permalink to Weave: valuable client-side data" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-143" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2010/02/05/toppcloud-and-django/index.html" title="Permalink to toppcloud (Silver Lining) and Django" rel="bookmark">toppcloud (Silver Lining) and Django</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I wrote up instructions on using <a class="reference external" href="../../../../2010/01/29/new-way-to-deploy-web-apps/index.html">toppcloud</a> (<strong>update</strong>: renamed Silver Lining) with Django.  They are <a class="reference external" href="http://toppcloud.colorstudy.com/django-quickstart.html">up on the site</a> (where they will be updated in the future), but I&#8217;ll drop them here too&#8230;</p>
<div class="section" id="creating-a-layout">
<h2>Creating a Layout</h2>
<p>First thing you have to do (after installing toppcloud of course) is create an environment for your new application.  Do that like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ toppcloud init sampleapp<br />
&nbsp;</div>
<p>This creates a directory <tt class="docutils literal"><span class="pre">sampleapp/</span></tt> with a basic layout.  The first thing we&#8217;ll do is set up version control for our project. For the sake of documentation, imagine you go to <a class="reference external" href="http://bitbucket.org">bitbucket</a> and create two new repositories, one called <tt class="docutils literal"><span class="pre">sampleapp</span></tt> and another called <tt class="docutils literal"><span class="pre">sampleapp-lib</span></tt> (and for the examples we&#8217;ll use the username <tt class="docutils literal"><span class="pre">USER</span></tt>).</p>
<p>We&#8217;ll go into our new environment and use these:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ <span class="kw3">cd</span> sampleapp<br />
$ hg clone http://bitbucket.<span class="me1">org</span>/USER/sampleapp src/sampleapp<br />
$ rm -r lib/python/<br />
$ hg clone http://bitbucket.<span class="me1">org</span>/USER/sampleapp-lib lib/python<br />
$ mkdir lib/python/bin/<br />
$ echo <span class="st0">&quot;syntax: glob<br />
bin/python*<br />
bin/activate<br />
bin/activate_this.py<br />
bin/pip<br />
bin/easy_install*<br />
&quot;</span> &gt; lib/python/.<span class="me1">hgignore</span><br />
$ mv bin/* lib/python/bin/<br />
$ rmdir bin/<br />
$ ln -s lib/python/bin bin<br />
&nbsp;</div>
<p>Now there is a basic layout setup, with all your libraries going into the <tt class="docutils literal"><span class="pre">sampleapp-lib</span></tt> repository, and your main application in the <tt class="docutils literal"><span class="pre">sampleapp</span></tt> repository.</p>
<p>Next we&#8217;ll install Django:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ source bin/activate<br />
$ pip install Django<br />
&nbsp;</div>
<p>Then we&#8217;ll set up a standard Django site:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ <span class="kw3">cd</span> src/sampleapp<br />
$ django-admin.<span class="me1">py</span> sampleapp<br />
&nbsp;</div>
<p>Also we&#8217;d like to be able to import this file.  It&#8217;d be nice if there was a <tt class="docutils literal"><span class="pre">setup.py</span></tt> file, and we could run <tt class="docutils literal"><span class="pre">pip</span> <span class="pre">-e</span> <span class="pre">src/sampleapp</span></tt>, but <tt class="docutils literal"><span class="pre">django-admin.py</span></tt> doesn&#8217;t create that itself.  Instead we&#8217;ll get that on the import path more manually with a <tt class="docutils literal"><span class="pre">.pth</span></tt> file:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ echo <span class="st0">&quot;../../src/sampleapp&quot;</span> &gt; lib/python/sampleapp.<span class="me1">pth</span><br />
&nbsp;</div>
<p>Also there&#8217;s the tricky <tt class="docutils literal"><span class="pre">$DJANGO_SETTINGS_MODULE</span></tt> that you might have had problems with before.  We&#8217;ll use the file <tt class="docutils literal"><span class="pre">lib/python/toppcustomize.py</span></tt> (which is imported everytime Python is started) to make sure that is always set:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ echo <span class="st0">&quot;import os<br />
os.environ['DJANGO_SETTINGS_MODULE'] = 'sampleapp.settings'<br />
&quot;</span> &gt; lib/python/toppcustomize.<span class="me1">py</span><br />
&nbsp;</div>
<p>Also we have a file <tt class="docutils literal"><span class="pre">src/sampleapp/sampleapp/manage.py</span></tt>, and that file doesn&#8217;t work <em>quite</em> how we&#8217;d like.  Instead we&#8217;ll put a file into <tt class="docutils literal"><span class="pre">bin/manage.py</span></tt> that does the same thing:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ rm sampleapp/manage.<span class="me1">py</span><br />
$ <span class="kw3">cd</span> ../..<br />
$ echo <span class="st0">'#!/usr/bin/env python<br />
from django.core.management import execute_manager<br />
from sampleapp import settings<br />
if __name__ == &quot;__main__&quot;:<br />
&nbsp; &nbsp; execute_manager(settings)<br />
'</span> &gt; bin/manage.<span class="me1">py</span><br />
$ chmod +x bin/manage.<span class="me1">py</span><br />
&nbsp;</div>
<p>Now, if you were just using plain Django you&#8217;d do something like run <tt class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">runserver</span></tt>.  But we&#8217;ll be using <tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">serve</span></tt> instead, which means we have to set up the two other files toppcloud needs: <tt class="docutils literal"><span class="pre">app.ini</span></tt> and the runner.  Here&#8217;s a simple <tt class="docutils literal"><span class="pre">app.ini</span></tt>:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ echo <span class="st0">'[production]<br />
app_name = sampleapp<br />
version = 1<br />
runner = src/sampleapp/toppcloud-runner.py<br />
'</span> &gt; src/sampleapp/toppcloud-app.<span class="me1">ini</span><br />
$ rm app.<span class="me1">ini</span><br />
$ ln -s src/sampleapp/toppcloud-app.<span class="me1">ini</span> app.<span class="me1">ini</span><br />
&nbsp;</div>
<p>The file <em>must</em> be in the &quot;root&quot; of your application, and named <tt class="docutils literal"><span class="pre">app.ini</span></tt>, but it&#8217;s good to keep it in version control, so we set it up with a symlink.</p>
<p>It also refers to a &quot;runner&quot;, which is the Python file that loads up the WSGI application.  This looks about the same for any Django application, and we&#8217;ll put it in <tt class="docutils literal"><span class="pre">src/sampleapp/toppcloud-runner.py</span></tt>:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ echo <span class="st0">'import django.core.handlers.wsgi<br />
application = django.core.handlers.wsgi.WSGIHandler()<br />
'</span> &gt; src/sampleapp/toppcloud-runner.<span class="me1">py</span><br />
&nbsp;</div>
<p>Now if you want to run the application, you can:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ toppcloud serve .<br />
&nbsp;</div>
<p>This will load it up on <tt class="docutils literal"><span class="pre">http://localhost:8080</span></tt>, and serve up a boring page.  To do something interesting we&#8217;ll want to use a database.</p>
</div>
<div class="section" id="setting-up-a-database">
<h2>Setting Up A Database</h2>
<p>At the moment the only good database to use is PostgreSQL with the PostGIS extensions.  Add this line to <tt class="docutils literal"><span class="pre">app.ini</span></tt>:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
service.<span class="me1">postgis</span> =<br />
&nbsp;</div>
<p>This makes the database &quot;available&quot; to the application.  For development you still have to set it up yourself.  You should create a database <tt class="docutils literal"><span class="pre">sampleapp</span></tt> on your computer.</p>
<p>Next, we&#8217;ll need to change <tt class="docutils literal"><span class="pre">settings.py</span></tt> to use the new database configuration.  Here&#8217;s the lines that you&#8217;ll see:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
DATABASE_ENGINE = <span class="st0">''</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1"># 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.</span><br />
DATABASE_NAME = <span class="st0">''</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1"># Or path to database file if using sqlite3.</span><br />
DATABASE_USER = <span class="st0">''</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1"># Not used with sqlite3.</span><br />
DATABASE_PASSWORD = <span class="st0">''</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1"># Not used with sqlite3.</span><br />
DATABASE_HOST = <span class="st0">''</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1"># Set to empty string for localhost. Not used with sqlite3.</span><br />
DATABASE_PORT = <span class="st0">''</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1"># Set to empty string for default. Not used with sqlite3.</span><br />
&nbsp;</div>
<p>First add this to the top of the file:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">import</span> <span class="kw3">os</span><br />
&nbsp;</div>
<p>Then you&#8217;ll change those lines to:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
DATABASE_ENGINE = <span class="st0">'postgresql_psycopg2'</span><br />
DATABASE_NAME = <span class="kw3">os</span>.<span class="me1">environ</span><span class="br0">&#91;</span><span class="st0">'CONFIG_PG_DBNAME'</span><span class="br0">&#93;</span><br />
DATABASE_USER = <span class="kw3">os</span>.<span class="me1">environ</span><span class="br0">&#91;</span><span class="st0">'CONFIG_PG_USER'</span><span class="br0">&#93;</span><br />
DATABASE_PASSWORD = <span class="kw3">os</span>.<span class="me1">environ</span><span class="br0">&#91;</span><span class="st0">'CONFIG_PG_PASSWORD'</span><span class="br0">&#93;</span><br />
DATABASE_HOST = <span class="kw3">os</span>.<span class="me1">environ</span><span class="br0">&#91;</span><span class="st0">'CONFIG_PG_HOST'</span><span class="br0">&#93;</span><br />
DATABASE_PORT = <span class="st0">''</span><br />
&nbsp;</div>
<p>Now we can create all the default tables:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ manage.<span class="me1">py</span> syncdb<br />
Creating table auth_permission<br />
Creating table auth_group<br />
Creating table auth_user<br />
Creating table auth_message<br />
Creating table django_content_type<br />
Creating table django_session<br />
Creating table django_site<br />
...<br />
&nbsp;</div>
<p>Now we have an empty project that doesn&#8217;t do anything.  Let&#8217;s make it do a little something (this is all really based on <a class="reference external" href="http://docs.djangoproject.com/en/dev/intro/tutorial01/">the Django tutorial</a>).</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ manage.<span class="me1">py</span> startapp polls<br />
&nbsp;</div>
<p>Django magically knows to put the code in <tt class="docutils literal"><span class="pre">src/sampleapp/sampleapp/polls/</span></tt> &#8212; we&#8217;ll setup the model in <tt class="docutils literal"><span class="pre">src/sampleapp/sampleapp/polls/models.py</span></tt>:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> django.<span class="me1">db</span> <span class="kw1">import</span> models<br />
<br />
<span class="kw1">class</span> Poll<span class="br0">&#40;</span>models.<span class="me1">Model</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; question = models.<span class="me1">CharField</span><span class="br0">&#40;</span>max_length=<span class="nu0">200</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; pub_date = models.<span class="me1">DateTimeField</span><span class="br0">&#40;</span><span class="st0">'date published'</span><span class="br0">&#41;</span><br />
<br />
<span class="kw1">class</span> Choice<span class="br0">&#40;</span>models.<span class="me1">Model</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; poll = models.<span class="me1">ForeignKey</span><span class="br0">&#40;</span>Poll<span class="br0">&#41;</span><br />
&nbsp; &nbsp; choice = models.<span class="me1">CharField</span><span class="br0">&#40;</span>max_length=<span class="nu0">200</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; votes = models.<span class="me1">IntegerField</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>And activate the application by adding <tt class="docutils literal"><span class="pre">'sampleapp.polls'</span></tt> to <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> in <tt class="docutils literal"><span class="pre">src/sampleapp/sampleapp/settings.py</span></tt>.  Also add <tt class="docutils literal"><span class="pre">'django.contrib.admin'</span></tt> to get the admin app in place.  Run <tt class="docutils literal"><span class="pre">manage.py</span> <span class="pre">syncdb</span></tt> to get the tables in place.</p>
<p>You can try <tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">serve</span> <span class="pre">.</span></tt> and go to <tt class="docutils literal"><span class="pre">/admin/</span></tt> to login and see your tables.  You might notice all the CSS is broken.</p>
<p>toppcloud serves static files out of the <tt class="docutils literal"><span class="pre">static/</span></tt> directory.  You don&#8217;t actually put <tt class="docutils literal"><span class="pre">static</span></tt> in the URLs, these files are available at the top-level (unless you create a <tt class="docutils literal"><span class="pre">static/static/</span></tt> directory). The best way to put files in there is generally symbolic links.</p>
<p>For Django admin, do this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ <span class="kw3">cd</span> static<br />
$ ln -s ../lib/python/django/contrib/admin/media admin-media<br />
&nbsp;</div>
<p>Now edit <tt class="docutils literal"><span class="pre">src/sampleapp/sampleapp/settings.py</span></tt> and change <tt class="docutils literal"><span class="pre">ADMIN_MEDIA_PREFIX</span></tt> to <tt class="docutils literal"><span class="pre">'/admin-media'</span></tt>.</p>
<p>(Probably some other links should be added.)</p>
<p>One <em>last</em> little thing you might want to do; replace this line in<br />
settings:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
SECRET_KEY = <span class="st0">'ASF#&amp;#64;$&amp;#64;#JFAS#&amp;#64;'</span><br />
&nbsp;</div>
<p>With this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> tcsupport.<span class="me1">secret</span> <span class="kw1">import</span> get_secret<br />
SECRET_KEY = get_secret<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>Then you don&#8217;t have to worry about checking a secret into version control.</p>
<p>You still don&#8217;t really have an application, but the rest is mere &quot;programming&quot; so have at it!</p>
</div>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/02/05/toppcloud-and-django/"
    dc:identifier="http://blog.ianbicking.org/2010/02/05/toppcloud-and-django/"
    dc:title="toppcloud (Silver Lining) and Django"
    trackback:ping="http://blog.ianbicking.org/2010/02/05/toppcloud-and-django/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 02 05</h3>
				<p class="post-categories"><a href="../../../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="../../../python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../../../silverlining.1" title="View all posts in Silver Lining" rel="category tag">Silver Lining</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2010/02/05/toppcloud-and-django/index.html#comments" title="Comment on toppcloud (Silver Lining) and Django">Comments (2)</a></p>
				<p class="post-permalink"><a href="../../../../2010/02/05/toppcloud-and-django/index.html" title="Permalink to toppcloud (Silver Lining) and Django" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-132" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2010/01/29/new-way-to-deploy-web-apps/index.html" title="Permalink to A new way to deploy web applications" rel="bookmark">A new way to deploy web applications</a></h2>
					<div class="post-entry">
						<div class="document">
<p>Deployment is one of the things I like least about development, and yet without deployment the development doesn&#8217;t really matter.</p>
<p>I&#8217;ve tried a few things (e.g. <a class="reference external" href="../../../../2008/06/19/my-experience-writing-a-build-system/index.html">fassembler</a>), built a few things (<a class="reference external" href="http://virtualenv.openplans.org">virtualenv</a>, <a class="reference external" href="http://pip.openplans.org">pip</a>), but deployment just sucked <em>less</em> as a result.  Then I got excited about <a class="reference external" href="http://appengine.google.com">App Engine</a>; everyone else was getting excited about &quot;scaling&quot;, but really I was <a class="reference external" href="../../../../2008/04/09/app-engine-and-open-source/index.html">excited about an accessible deployment process</a>.  When it comes to deployment App Engine is the first thing that has really felt good to me.</p>
<p><strong>But</strong> I can&#8217;t actually <em>use</em> App Engine.  I was able to come to terms with the idea of writing an application to the platform, but there are limits&#8230; and with App Engine there were simply too many limits.  Geo stuff on App Engine is at best a crippled hack, I miss <a class="reference external" href="http://codespeak.net/lxml/">lxml</a> terribly, I never hated relational databases, and almost nothing large works without some degree of rewriting.  Sometimes you can work around it, but you can never be sure you won&#8217;t hit some wall later.  And frankly working around the platform is tiring and not very rewarding.</p>
<hr class="docutils" />
<p>So&#8230; App Engine seemed neat, but I couldn&#8217;t use it, and deployment was still a problem.</p>
<p>What I like about App Engine: an application is just files.  There&#8217;s no build process, no fancy copying of things in weird locations, nothing like that; you upload files, and uploading files <em>just works</em>.  Also, you can check <em>everything</em> into version control.  Not just your application code, but every library you use, the exact files that you installed.  I really wanted a system like that.</p>
<p>At the same time, I started looking into &quot;the cloud&quot;.  It took me a while to get a handle on what &quot;cloud computing&quot; really means.  What I learned: don&#8217;t overthink it.  It&#8217;s not magic.  It&#8217;s just virtual private servers that can be requisitioned automatically via an API, and are billed on a short time cycle.  You can expand or change the definition a bit, but this definition is the one that matters to <em>me</em>.  (I&#8217;ve also realized that I cannot get excited about complicated solutions; only once I realized how simple cloud computing is could I really get excited about the idea.)</p>
<p>Given the modest functionality of cloud computing, why does it matter? Because with a cloud computing system you can actually <em>test</em> the full deployment stack.  You can create a brand-new server, identical to all servers you will create in the future; you can set this server up; you can deploy to it.  You get it wrong, you throw away that virtual server and start over from the beginning, fixing things until you get it right.  Billing is important here too; with hourly billing you pay cents for these tests, and you don&#8217;t need a pool of ready servers because the cloud service basically manages that pool of ready servers for you.</p>
<p>Without &quot;cloud computing&quot; we each too easily find ourselves in a situation where deployments are ad hoc, server installations develop over time, and servers and applications are inconsistent in their configuration.  Cloud computing makes servers disposable, which means we can treat them in consistent ways, testing our work as we go.  It makes it easy to treat operations with the same discipline as software.</p>
<p>Given the idea from App Engine, and the easy-to-use infrastructure of a cloud service, I started to script together something to manage the servers and start up applications.  I didn&#8217;t know what exactly I wanted to do to start, and I&#8217;m not completely sure where I&#8217;m going with this.  But on the whole this feels pretty right.  So I present the provisionally-named: <a class="reference external" href="http://toppcloud.colorstudy.com">toppcloud</a> (<strong>Update</strong>: this has been renamed Silver Cloud).</p>
<hr class="docutils" />
<p>How it works: first you have a directory of files that defines your application.  This probably includes a checkout of your &quot;application&quot; (let&#8217;s say in <tt class="docutils literal"><span class="pre">src/mynewapp/</span></tt>), and I find it also useful to use source control on the libraries (which are put in <tt class="docutils literal"><span class="pre">lib/python/</span></tt>).  There&#8217;s a file in <tt class="docutils literal"><span class="pre">app.ini</span></tt> that defines some details of the application (very similar to <tt class="docutils literal"><span class="pre">app.yaml</span></tt>).</p>
<p>While app.ini is a (<a class="reference external" href="http://toppcloud.colorstudy.com/appconfig.html">very minimal</a>) description of the <em>application</em>, there is no description of the environment.  You do not specify database connection details, for instance.  Instead your application <em>requests</em> access to a database service.  For instance, one of these services is a PostgreSQL/PostGIS database (which you get if you put <tt class="docutils literal"><span class="pre">service.postgis</span></tt> in your app.ini file).  If you ask for that then there will be evironmental variables, <tt class="docutils literal"><span class="pre">CONFIG_PG_DBNAME</span></tt> etc., that will tell your application how to connect to the database.  (For local development you can provide your own configuration, based on how you have PostgreSQL or some other service installed.)</p>
<p>The standard setup is also a <a class="reference external" href="http://virtualenv.openplans.org">virtualenv</a> environment.  It is setup so <em>every time</em> you start that virtualenv environment you&#8217;ll get those configuration-related environmental variables.  This means your application configuration is always present, your services always available.  It&#8217;s available in tests just like it is during a request.  Django accomplishes something similar with the (much maligned) <tt class="docutils literal"><span class="pre">$DJANGO_SETTINGS_MODULE</span></tt> but toppcloud builds it into the virtualenv environment instead of the shell environment.</p>
<p>And how is the server setup?  Much like with App Engine that is merely an implementation detail.  Unlike App Engine that&#8217;s an implementation detail you can actually <em>look</em> at and change (by changing toppcloud), but it&#8217;s not something you are supposed to concern yourself with during regular application development.</p>
<p>The basic lifecycle using toppcloud looks like:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">create-node</span></tt></dt>
<dd>Create a new virtual server; you can create any kind of supported server, but only Ubuntu Jaunty or Karmic are supported (and Jaunty should probably be dropped).  This step is where the &quot;cloud&quot; part actually ends.  If you want to install a bare Ubuntu onto an existing physical machine that&#8217;s fine too &#8212; after <tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">create-node</span></tt> the &quot;cloud&quot; part of the process is pretty much done.  Just don&#8217;t go using some old Ubuntu install; this tool is for clean systems that are used only for toppcloud.</dd>
<dt><tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">setup-node</span></tt></dt>
<dd>Take that bare Ubuntu server and set it up (or update it) for use with toppcloud.  This installs all the basic standard stuff (things like Apache, mod_wsgi, Varnish) and some management script that toppcloud runs.  This is written to be safe to run over and over, so upgrading and setting up a machine are the same.  It needs to be a bare server, but</dd>
<dt><tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">init</span> <span class="pre">path/to/app/</span></tt></dt>
<dd>Setup a basic virtualenv environment with some toppcloud customizations.</dd>
<dt><tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">serve</span> <span class="pre">path/to/app</span></tt></dt>
<dd>Serve up the application locally.</dd>
<dt><tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">update</span> <span class="pre">--host=test.example.com</span> <span class="pre">path/to/app/</span></tt></dt>
<dd>This creates or updates an application at the given host.  It edits <tt class="docutils literal"><span class="pre">/etc/hosts</span></tt> so that the domain is locally viewable.</dd>
<dt><tt class="docutils literal"><span class="pre">toppcloud</span> <span class="pre">run</span> <span class="pre">test.example.com</span> <span class="pre">script.py</span></tt></dt>
<dd>Run a script (from <tt class="docutils literal"><span class="pre">bin/</span></tt>) on a remote server.  This allows you to run things like <tt class="docutils literal"><span class="pre">django-admin.py</span> <span class="pre">syncdb</span></tt>.</dd>
</dl>
<p>There&#8217;s a few other things &#8212; stuff to manage the servers and change around hostnames or the active version of applications.  It&#8217;s growing to fit a variety of workflows, but I don&#8217;t think its growth is unbounded.</p>
<hr class="docutils" />
<p>So&#8230; this is what toppcloud.  From the outside it doen&#8217;t do a lot.  From the inside it&#8217;s not actually that complicated either.  I&#8217;ve included a lot of constraints in the tool but I think it offers an excellent balance.  The constraints are workable for applications (insignificant for many applications), while still exposing a simple and consistent system that&#8217;s easier to reason about than a big-ball-of-server.</p>
<p>Some of the constraints:</p>
<ol class="arabic simple">
<li>Binary packages are supported via Ubuntu packages; you only upload portable files.  If you need a library like lxml, you need to request that package (<tt class="docutils literal"><span class="pre">python-lxml</span></tt>) to be installed in your app.ini.  If you need a version of a binary library that is not yet packaged, I think creating a new deb is reasonable.</li>
<li>There is no Linux distribution abstraction, but I don&#8217;t care.</li>
<li>There is no option for the way your application is run &#8212; there&#8217;s one way applications are run, because I believe there is a best practice.  I might have gotten the best practice wrong, but that should be resolved inside toppcloud, not inside applications. Is Varnish a terrible cache?  Probably not, but if it is we should all be able to agree on that and replace it.  If there are genuinely different needs then maybe additional application or deployment configuration will be called for &#8212; but we shouldn&#8217;t add configuration just because someone <em>says</em> there is a better practice (and a better practice that is not universally better); there must be justifications.</li>
<li>By abstracting out services and persistence some additional code is required for each such service, and that code is centralized in toppcloud, but it means we can also start to add consistent tools usable across a wide set of applications and backends.</li>
<li>All file paths have to be relative, because files get moved around.  I know of some particularly problematic files (e.g., <tt class="docutils literal"><span class="pre">.pth</span></tt> files), and toppcloud fixes these automatically.  Mostly this isn&#8217;t so hard to do.</li>
</ol>
<p>These particular compromises are ones I have not seen in many systems (and <a class="reference external" href="http://toppcloud.colorstudy.com/comparisons.html">I&#8217;ve started to look more</a>).  App Engine I think goes too far with its constraints.  <a class="reference external" href="http://heroku.com/">Heroku</a> is close, but closed source.</p>
<p>This is different than a strict everything-must-be-a-package strategy.  This deployment system is light and simple and takes into account reasonable web development workflows.  The pieces of an application that move around a lot are all well-greased and agile.  The parts of an application that are better to Do Right And Then Leave Alone (like Apache configuration) are static.</p>
<p>Unlike generalized systems like buildout this system avoids &quot;building&quot; entirely, making deployment a simpler and lower risk action, leaning on system packages for the things they do best.  Other open source tools emphasize a greater degree of flexibility than I think is necessary, allowing people to encode exploratory service integration into what <em>appears</em> to be an encapsulated build (I&#8217;m looking at you buildout).</p>
<p>Unlike <a class="reference external" href="http://pip.openplans.org/requirement-format.html">requirement sets</a> and packaging and versioning libraries, this makes all the Python libraries (typically the most volatile libraries) explicit and controlled, and can better ensure that small updates really are small.  It doesn&#8217;t invalidate installers and versioning, but it makes that process even more explicit and encourages greater thoughtfulness.</p>
<p>Unlike many production-oriented systems (what I&#8217;ve seen in a lot of &quot;cloud&quot; tools) this encorporates both the development environment and production environment; but unlike some developer-oriented systems this does not try to normalize everyone&#8217;s environment and instead relies on developers to set up their systems however is appropriate.  And unlike platform-neutral systems this can ensure an amount of reliability and predictability through extremely hard requirements (it is deployed on Ubuntu Jaunty/Karmic <em>only</em>).</p>
<p>But it&#8217;s not all constraints.  Toppcloud is solidly web framework neutral.  It&#8217;s even <a class="reference external" href="http://toppcloud.colorstudy.com/php.html">slightly language neutral</a>.  Though it does require support code for each persistence technique, it is fairly easy to do, and there are no requirements for &quot;scalable systems&quot;; I think unscalable systems are a perfectly reasonable implementation choice for many problems.  I believe a more scalable system could be built on this, but as a deployment and development option, not a starting requirement.</p>
<p>So far I&#8217;ve done some deployments using toppcloud; not a lot, but some.  And I can say that it feels really good; lots of rough edges still, but the core concept feels really right.   I&#8217;ve made a lot of sideways attacks on deployment, and a few direct attacks&#8230; sometimes I write things that I think are useful, and sometimes I write things that I think are right.  Toppcloud is at the moment maybe more right than useful.  But I genuinely believe this is (in theory) a universally appropriate deployment tool.</p>
<hr class="docutils" />
<p>Alright, so now you think maybe you should look more at toppcloud&#8230;</p>
<p>Well, I can offer you <a class="reference external" href="http://toppcloud.colorstudy.com">a fair amount of documentation</a>.  A lot of that documentation refers to design, and a bit of it to examples.  There&#8217;s also a couple projects you can look at; they are all small, but :</p>
<ul class="simple">
<li><a class="reference external" href="http://bitbucket.org/geraldmc/frank-src/src/tip/build-fs-layout">Frank</a> (will be interactivesomerville.org) which is another similar Django/Pinax project (Pinax was a bit tricky).  This is probably the largest project.  It&#8217;s a Django/Pinax volunteer-written application for collecting community feedback the Boston Greenline project, if that sounds interesting to you might want to chip in on the development (if so <a class="reference external" href="https://projects.openplans.org/greenline">check out the wiki</a>).</li>
<li><a class="reference external" href="http://github.com/ianb/neighborly/blob/master/INSTALL.txt">Neighborly</a>, with minimal functionality (we need to run more sprints) but an installation story.</li>
<li><a class="reference external" href="http://bitbucket.org/ianb/bbdocs/src/tip/create-layout.sh">bbdocs</a> which is a very simple bitbucket document generator, that makes the toppcloud site.</li>
<li><a class="reference external" href="http://bitbucket.org/ianb/geodns">geodns</a> which is another simple no-framework PostGIS project.</li>
</ul>
<hr class="docutils" />
<p>Now, the letdown.  One thing I cannot offer you is support.  <strong>THERE IS NO SUPPORT</strong>.  I cannot now, and I might never really be able to support this tool.  This tool is appropriate for collaborators, for people who like the idea and are ready to build on it.  If it grows well I hope that it can grow a community, I hope people can support each other.  I&#8217;d like to help that happen.  But I can&#8217;t do that by bootstrapping it through unending support, because I&#8217;m not good at it and I&#8217;m not consistent and it&#8217;s unrealistic and unsustainable.  This is not a open source dead drop.  But it&#8217;s also not My Future; I&#8217;m not going to build a company around it, and I&#8217;m not going to use all my free time supporting it.  It&#8217;s a tool I want to exist.  I <strong>very much</strong> want it to exist.  But even very much wanting something is not the same as being an undying champion, and I am not an undying champion.  If you want to tell me what my process <em>should</em> be, please do!</p>
<hr class="docutils" />
<blockquote><p>
If you want to see me get philosophical about packaging and deployment and other stuff like that, see my upcoming talk at <a class="reference external" href="http://us.pycon.org/">PyCon</a>.</p></blockquote>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/01/29/new-way-to-deploy-web-apps/"
    dc:identifier="http://blog.ianbicking.org/2010/01/29/new-way-to-deploy-web-apps/"
    dc:title="A new way to deploy web applications"
    trackback:ping="http://blog.ianbicking.org/2010/01/29/new-way-to-deploy-web-apps/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 01 29</h3>
				<p class="post-categories"><a href="../../../packaging/index.html" title="View all posts in Packaging" rel="category tag">Packaging</a><br/><a href="../../../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="../../../python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../../../silverlining.1" title="View all posts in Silver Lining" rel="category tag">Silver Lining</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2010/01/29/new-way-to-deploy-web-apps/index.html#comments" title="Comment on A new way to deploy web applications">Comments (13)</a></p>
				<p class="post-permalink"><a href="../../../../2010/01/29/new-way-to-deploy-web-apps/index.html" title="Permalink to A new way to deploy web applications" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-122" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2009/05/22/webob-decorator/index.html" title="Permalink to WebOb decorator" rel="bookmark">WebOb decorator</a></h2>
					<div class="post-entry">
						<div class="document">
<p>Lately I&#8217;ve been writing a few applications (e.g., <a class="reference external" href="http://pickywiki.org">PickyWiki</a> and a revisiting a request-tracking application <a class="reference external" href="http://svn.pythonpaste.org/Paste/VaingloriousEye/trunk">VaingloriousEye</a>), and I usually use no framework at all.  <a class="reference external" href="http://pylonshq.com">Pylons</a> would be a natural choice, but given that I am comfortable with all the components, I find myself inclined to assemble the pieces myself.</p>
<p>In the process I keep writing bits of code to make WSGI applications from simple <a class="reference external" href="http://pythonpaste.org/webob/">WebOb</a> -based request/response cycles.  The simplest form looks like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> webob <span class="kw1">import</span> Request, Response, exc<br />
<br />
<span class="kw1">def</span> wsgiwrap<span class="br0">&#40;</span>func<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">def</span> wsgi_app<span class="br0">&#40;</span>environ, start_response<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; req = Request<span class="br0">&#40;</span>environ<span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">try</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resp = func<span class="br0">&#40;</span>req<span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">except</span> exc.<span class="me1">HTTPException</span>, e:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resp = e<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> resp<span class="br0">&#40;</span>environ, start_response<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">return</span> wsgi_app<br />
<br />
@<span class="co1">wsgiwrap</span><br />
<span class="kw1">def</span> hello_world<span class="br0">&#40;</span>req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">return</span> Response<span class="br0">&#40;</span><span class="st0">'Hi %s!'</span> % <span class="br0">&#40;</span>req.<span class="me1">POST</span>.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'name'</span>, <span class="st0">'You'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>But each time I&#8217;d write it, I change things slightly, implementing more or less features.  For instance, <a class="reference external" href="../../../../2008/10/24/decorators-and-descriptors/index.html">handling methods</a>, or coercing other responses, or handling middleware.</p>
<p>Having implemented several of these (and <a class="reference external" href="http://svn.pythonpaste.org/Paste/WebOb/contrib">reading other people&#8217;s implementations</a>) I decided I wanted WebOb to include a kind of reference implementation.  But I don&#8217;t like to include anything in WebOb unless I&#8217;m sure I can get it <em>right</em>, so I&#8217;d really like feedback.  (There&#8217;s been some <a class="reference external" href="http://groups.google.com/group/paste-users/browse_thread/thread/7346e75940413f46">less than positive feedback</a>, but I trudge on.)</p>
<p>My implementation is in a <a class="reference external" href="http://svn.pythonpaste.org/Paste/WebOb/branches/ianb-decorator-experiment">WebOb branch</a>, primarily in <a class="reference external" href="http://svn.pythonpaste.org/Paste/WebOb/branches/ianb-decorator-experiment/webob/dec.py">webob.dec</a> (along with some <a class="reference external" href="http://svn.pythonpaste.org/Paste/WebOb/branches/ianb-decorator-experiment/tests/test_dec.txt">doctests</a>).</p>
<p>The most prominent way this is different from the example I gave is that it doesn&#8217;t change the function signature, instead it adds an attribute <tt class="docutils literal"><span class="pre">.wsgi_app</span></tt> which is WSGI application associated with the function.  My goal with this is that the decorator isn&#8217;t intrusive.  Here&#8217;s the case where I&#8217;ve been bothered:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">class</span> MyClass<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; @<span class="co1">wsgiwrap</span><br />
&nbsp; &nbsp; <span class="kw1">def</span> form<span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> Response<span class="br0">&#40;</span>form_html...<span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; @<span class="co1">wsgiwrap</span><br />
&nbsp; &nbsp; <span class="kw1">def</span> form_post<span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; handle submission<br />
&nbsp;</div>
<p>OK, that&#8217;s fine, then I add validation:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
@<span class="co1">wsgiwrap</span><br />
<span class="kw1">def</span> form_post<span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">if</span> req <span class="kw1">not</span> valid:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">self</span>.<span class="me1">form</span><br />
&nbsp; &nbsp; handle submission<br />
&nbsp;</div>
<p>This still works, because the decorator allows you to return <em>any</em> WSGI application, not just a WebOb Response object.  But that&#8217;s not helpful, because I need errors&#8230;</p>
<div class="dean_ch" style="white-space: wrap;"><br />
@<span class="co1">wsgiwrap</span><br />
<span class="kw1">def</span> form_post<span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">if</span> req <span class="kw1">not</span> valid:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">self</span>.<span class="me1">form</span><span class="br0">&#40;</span>req, errors<span class="br0">&#41;</span><br />
&nbsp; &nbsp; handle submission<br />
&nbsp;</div>
<p>That is, I want to have an option argument to the <tt class="docutils literal"><span class="pre">form</span></tt> method that passes in errors.  But I can&#8217;t do this with the traditional <tt class="docutils literal"><span class="pre">wsgiwrap</span></tt> decorator, instead I have to refactor the code to have a third method that both <tt class="docutils literal"><span class="pre">form</span></tt> and <tt class="docutils literal"><span class="pre">form_post</span></tt> use.  Of course, there&#8217;s more than one way to address this issue, but this is the technique I like.</p>
<p>The one other notable feature is that you can also make middleware:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
@<span class="co1">wsgify.middleware</span><br />
<span class="kw1">def</span> cap_middleware<span class="br0">&#40;</span>req, app<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; resp = app<span class="br0">&#40;</span>req<span class="br0">&#41;</span><br />
&nbsp; &nbsp; resp.<span class="me1">body</span> = resp.<span class="me1">body</span>.<span class="me1">upper</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">return</span> resp<br />
<br />
capped_app = cap_middleware<span class="br0">&#40;</span>some_wsgi_app<span class="br0">&#41;</span><br />
&nbsp;</div>
<p>Otherwise, for some reason I&#8217;ve found myself putting an inordinate amount of time into <tt class="docutils literal"><span class="pre">__repr__</span></tt>.  Why I&#8217;ve done this I cannot say.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2009/05/22/webob-decorator/"
    dc:identifier="http://blog.ianbicking.org/2009/05/22/webob-decorator/"
    dc:title="WebOb decorator"
    trackback:ping="http://blog.ianbicking.org/2009/05/22/webob-decorator/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2009 05 22</h3>
				<p class="post-categories"><a href="../../../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="../../../python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2009/05/22/webob-decorator/index.html#comments" title="Comment on WebOb decorator">Comments (11)</a></p>
				<p class="post-permalink"><a href="../../../../2009/05/22/webob-decorator/index.html" title="Permalink to WebOb decorator" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-96" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2009/01/14/modern-web-design-i-renounce-thee/index.html" title="Permalink to Modern Web Design, I Renounce Thee!" rel="bookmark">Modern Web Design, I Renounce Thee!</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;m not a designer, but I spend as much time looking at web pages as the next guy.  So I took interest when I came upon <a class="reference external" href="http://www.wilsonminer.com/posts/2008/oct/20/relative-readability/">this post on font size</a> by Wilson Miner, which in turn is inspired by the <a class="reference external" href="http://informationarchitects.jp/100e2r/">100e2r (100% easy to read) standard</a> by Oliver Reichenstein.</p>
<p>The basic idea is simple: we should have fonts at the &quot;default&quot; size, about 16px, no smaller.  This is about the size of text in print, read at a reasonable distance (typically closer up than a screen):</p>
<div align="center" class="align-center"><img alt="http://blog.ianbicking.org/wp-content/uploads/images/typesize_comparison2.jpg" class="align-center" src="../../../../wp-content/uploads/images/typesize_comparison2.jpg" /></div>
<p>Also it calls out low-contrast color schemes, which I think are mostly passe, and I will not insult you, my reader, by suggesting you don&#8217;t entirely agree.  Because if you <em>don&#8217;t</em> agree, well, I&#8217;m afraid I&#8217;d have to use some strong words.</p>
<p>I think small fonts, low contrast, huge amounts of whitespace, are a side effect of the audience designers create for.</p>
<p>This makes me think of <a class="reference external" href="http://en.wikipedia.org/wiki/Modern_architecture">Modern Architecture</a>:</p>
<div align="center" class="align-center"><img alt="http://blog.ianbicking.org/wp-content/uploads/images/300px-seagram.jpg" class="align-center" src="../../../../wp-content/uploads/images/300px-seagram.jpg" /></div>
<p>This is a form of architecture popular for skyscapers and other dramatic structures, with their soaring heights and other such dramatic adjectives.  These are buildings designed for someone looking at the building from five hundred feet away.  They are not designed for occupants.  But that&#8217;s okay, because the design isn&#8217;t sold to occupants, it is sold to people who look at the sketches and want to feel very dramatic.</p>
<p>Similarly, I think the design pattern of small fonts is something meant to appeal to shallow observation.  By deemphasizing the text itself, the design is accentuated.  Low-contrast text is even more obviously the domination of design over content.  And it may very well look more professional and visually pleasing.  But web design isn&#8217;t for making sites visually pleasing, it is for making the experience of the content more pleasing.  Sites exist for their content, not their design.</p>
<p>In 100e2r he also says <em>let your text breathe</em>.  You need whitespace.  If you <a class="reference external" href="../../../../2009/01/14/modern-web-design-i-renounce-thee/index.html">view my site directly</a>, you&#8217;ll notice I don&#8217;t have big white margins around my text.  When you come to my site, it&#8217;s to see my words, and that&#8217;s what I&#8217;m going to give you!  When I want to let my text <em>breathe</em> with lots of <em>whitespace</em> this is what I do:</p>
<div align="center" class="align-center"><img alt="http://blog.ianbicking.org/wp-content/uploads/images/500px-my-white-desktop.jpg" class="align-center" src="../../../../wp-content/uploads/images/500px-my-white-desktop.jpg" /></div>
<p>Is a huge block of text hard to read?  It is.  And yeah, I&#8217;ve written articles like that.  But the solution?</p>
<div style="text-align: center"><b>WRITE BETTER</b></div>
<p>Similarly, it&#8217;s hard to read text if you don&#8217;t use paragraphs, but the solution isn&#8217;t to increase your line height until every line is like a paragraph of its own.</p>
<p>The solution to the drudgery of large swathes of text is:</p>
<ol class="arabic simple">
<li>Make your blocks of text smaller.</li>
<li>Use something other than paragraphs of text.</li>
</ol>
<p>Throw in a list.  Do some indentation.  Toss in even a stupid picture.  Personally I try to throw in code examples, because that&#8217;s how we roll on this blog.</p>
<p>That&#8217;s good writing, that&#8217;s content that is easy to read.  It&#8217;s not easy to write, and I&#8217;m sure I miss the mark more often than not.  But you can&#8217;t design your way to good content.  If you want to write like this, if you want to let the flow of your text reflect the flow of your ideas, you need <strong>room</strong>.  Huge margins don&#8217;t give you room.  They are a crutch for poor writing, and not even a good crutch.</p>
<p>So in conclusion: modern design be damned!</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2009/01/14/modern-web-design-i-renounce-thee/"
    dc:identifier="http://blog.ianbicking.org/2009/01/14/modern-web-design-i-renounce-thee/"
    dc:title="Modern Web Design, I Renounce Thee!"
    trackback:ping="http://blog.ianbicking.org/2009/01/14/modern-web-design-i-renounce-thee/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2009 01 14</h3>
				<p class="post-categories"><a href="../../../html/index.html" title="View all posts in HTML" rel="category tag">HTML</a><br/><a href="../../../notech/index.html" title="View all posts in Non-technical" rel="category tag">Non-technical</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2009/01/14/modern-web-design-i-renounce-thee/index.html#comments" title="Comment on Modern Web Design, I Renounce Thee!">Comments (21)</a></p>
				<p class="post-permalink"><a href="../../../../2009/01/14/modern-web-design-i-renounce-thee/index.html" title="Permalink to Modern Web Design, I Renounce Thee!" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-91" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2009/01/11/atompub-instead-o-webdav/index.html" title="Permalink to Atompub as an alternative to WebDAV" rel="bookmark">Atompub as an alternative to WebDAV</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;ve been thinking about an import/export API for <a class="reference external" href="http://pickywiki.org">PickyWiki</a>; I want something that&#8217;s sensible, and works well enough that it can be the basic for things like creating restorable snapshots, integration with version control systems, and being good at self-hosting documentation.</p>
<p>So far I&#8217;ve made a simple import/export system based on Atom.  You can export the entire site as an Atom feed, and you can import Atom feeds.  But whole-site import/export isn&#8217;t enough for the tools I&#8217;d like to write on top of the API.</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/WebDAV">WebDAV</a> would seem like a logical choice, as it lets you get and put resources.   But it&#8217;s not a great choice for a few reasons:</p>
<ul class="simple">
<li>It&#8217;s really hard to implement on the server.</li>
<li>Even clients are hard to implement.</li>
<li>It uses GET to get resources.  This is probably its most fatal flaw.  There is no CMS that I know of (except <a class="reference external" href="http://www.tiddlywiki.com/">maybe one</a>) where the thing you view the browser is the thing that you&#8217;d actually edit.  To work around this CMSes use User-Agent sniffing or an alternate URL space.</li>
<li>WebDAV is worried about &quot;collections&quot; (i.e., directories).  The web basically doesn&#8217;t know what &quot;collections&quot; are, it only knows paths, and paths are strings.</li>
<li>(In summary) WebDAV uses HTTP, but it is not <em>of the web</em>.</li>
</ul>
<p>I don&#8217;t want to invent something new though.  So I started thinking of Atom some more, and <a class="reference external" href="http://en.wikipedia.org/wiki/Atom_(standard)">Atompub</a>.</p>
<p>The first thought is how to fix the GET problem in WebDAV.  A web page isn&#8217;t an editable representation, but it&#8217;s pretty reasonable to put an editable representation into an Atom entry.  Clients won&#8217;t necessarily understand extensions and properties you might add to those entries, but I don&#8217;t see any way around that.  An entry might look like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;entry&gt;<br />
&nbsp; &lt;content <span class="kw2">type</span>=<span class="st0">&quot;html&quot;</span>&gt;QUOTED HTML&lt;/content&gt;<br />
&nbsp; ... <span class="me1">other</span> normal metadata <span class="br0">&#40;</span>title etc<span class="br0">&#41;</span> ...<br />
&nbsp; &lt;privateprop:myproperty xmlns:privateprop=<span class="st0">&quot;URL&quot;</span> name=<span class="st0">&quot;foo&quot;</span> value=<span class="st0">&quot;bar&quot;</span> /&gt;<br />
&lt;/entry&gt;<br />
&nbsp;</div>
<p>While there is special support for HTML, XHTML, and plain text in Atom, you can put any type of content in <tt class="docutils literal"><span class="pre">&lt;content&gt;</span></tt>, encoded in base64.</p>
<p>To find the editable representation, the browser page can point to it.  I imagine something like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;link rel=<span class="st0">&quot;alternate&quot;</span> <span class="kw2">type</span>=<span class="st0">&quot;application/atom+xml; type=entry&quot;</span><br />
&nbsp;href=<span class="st0">&quot;this-url?format=atom&quot;</span>&gt;<br />
&nbsp;</div>
<p>The actual URL (in this example <tt class="docutils literal"><span class="pre">this-url?format=atom</span></tt>) can be pretty much anything.  My one worry is that this could be confused with feed detection, which looks like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;link rel=<span class="st0">&quot;alternate&quot;</span> <span class="kw2">type</span>=<span class="st0">&quot;application/atom+xml&quot;</span><br />
&nbsp;href=<span class="st0">&quot;/atom.xml&quot;</span>&gt;<br />
&nbsp;</div>
<p>The only difference is &quot;; type=entry&quot;, which I&#8217;m betting a lot of clients don&#8217;t pay attention to.</p>
<p>The Atom entries then can have an element:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;link rel=<span class="st0">&quot;edit&quot;</span> href=<span class="st0">&quot;this-url&quot;</span> /&gt;<br />
&nbsp;</div>
<p>This is a location where you can PUT a new entry to update the resource.  You could allow the client to PUT directly over the old page, or use <tt class="docutils literal"><span class="pre">this-url?format=atom</span></tt> or whatever is convenient on the server-side.  Additionally, DELETE to the same URL would delete.</p>
<p>This handles updates and deletes, and single-page reads.  The next issue is creating pages.</p>
<p>Atompub makes creation fairly simple.  First you have to get the <a class="reference external" href="http://bitworking.org/projects/atom/rfc5023.html#appdocs">Atompub service document</a>.  This is a document with the type <tt class="docutils literal"><span class="pre">application/atomsvc+xml</span></tt> and it gives the collection URL.  <a class="reference external" href="http://wiki.whatwg.org/wiki/ServiceRelExtension">It&#8217;s suggested</a> you make this document discoverable like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;link rel=<span class="st0">&quot;service&quot;</span> <span class="kw2">type</span>=<span class="st0">&quot;application/atomsvc+xml&quot;</span><br />
&nbsp;href=<span class="st0">&quot;/atomsvc.xml&quot;</span>&gt;<br />
&nbsp;</div>
<p>This document then points to the &quot;collection&quot; URL, which for our purposes is where you create documents.  The service document would look like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;service xmlns=<span class="st0">&quot;http://www.w3.org/2007/app&quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xmlns:atom=<span class="st0">&quot;http://www.w3.org/2005/Atom&quot;</span>&gt;<br />
&nbsp; &lt;workspace&gt;<br />
&nbsp; &nbsp; &lt;atom:title&gt;SITE TITLE&lt;/atom:title&gt;<br />
&nbsp; &nbsp; &lt;collection href=<span class="st0">&quot;/atomapi&quot;</span>&gt;<br />
&nbsp; &nbsp; &nbsp; &lt;atom:title&gt;SITE TITLE&lt;/atom:title&gt;<br />
&nbsp; &nbsp; &nbsp; &lt;accept&gt;*/*&lt;/accept&gt;<br />
&nbsp; &nbsp; &nbsp; &lt;accept&gt;application/atom+<span class="kw3">xml</span>;type=entry&lt;/accept&gt;<br />
&nbsp; &nbsp; &lt;/collection&gt;<br />
&nbsp; &lt;/workspace&gt;<br />
&lt;/service&gt;<br />
&nbsp;</div>
<p>Basically this indicates that you can POST any media to <tt class="docutils literal"><span class="pre">/atomapi</span></tt> (both Atom entries, and things like images).</p>
<p>To create a page, a client then does a POST like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
POST /atomapi<br />
Content-Type: application/atom+<span class="kw3">xml</span>; <span class="kw2">type</span>=entry<br />
Slug: /page/path<br />
<br />
&lt;entry xmlns=<span class="st0">&quot;...&quot;</span>&gt;...&lt;/entry&gt;<br />
&nbsp;</div>
<p>There&#8217;s an awkwardness here, that you can suggest (via the Slug header) what the URL for the new page is.  The client can find the actual URL of the new page from the Location header in the response. But the client can&#8217;t demand that the slug be respected (getting an error back if it is not), and there&#8217;s lots of use cases where the client doesn&#8217;t just want to <em>suggest</em> a path (for instance, other documents that are being created might rely on that path for links).</p>
<p>Also, &quot;slug&quot; implies&#8230; well, a slug.  That is, some path segment probably derived from the title.  There&#8217;s nothing stopping the client from putting a complete path in there, but it&#8217;s very likely to be misinterpreted (e.g. translating <tt class="docutils literal"><span class="pre">/page/path</span></tt> to <tt class="docutils literal"><span class="pre">/2009/01/pagepath</span></tt>).</p>
<p>Bug I digress.  Anyway, you can post every resource as an entry, base64-encoding the resource body, but Atompub also allows POSTing media directly.  When you do that, the server puts the media somewhere and creates a simple Atom entry for the media.  If you wanted to add properties to that entry, you&#8217;d edit the entry after creating it.</p>
<p>The last missing piece is how to get a list of all the pages on a site.  Atompub <em>does</em> have an answer for this: just <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/atomapi</span></tt> will give you an Atom feed, and for our purposes we can demand that the feed is complete (using paging so that any one page of the feed doesn&#8217;t get too big).  But this doesn&#8217;t seem like a good solution to me.  <a class="reference external" href="http://code.google.com/apis/gdata/overview.html">GData</a> specifies a useful set of queries to for feeds, but I&#8217;m not sure that this is very useful here; the kind of queries a client needs to do for this use case aren&#8217;t things GData was designed for.</p>
<p>The queries that seem most important to me are queries by page path (which allows some sense of &quot;collections&quot; without being formal) and by content type.  Also to allow incremental updates on the client side, filtering these queries by last-modified time (i.e., all pages created since I last looked).  Reporting queries (date of creation, update, author, last editor, and custom properties) of course <em>could</em> be useful, but don&#8217;t seem as directly applicable.</p>
<p>Also, often the client won&#8217;t want the complete Atom entry for the pages, but only a list of pages (maybe with minimal metadata).  I&#8217;m unsure about the validity of abbreviated Atom entries, but it seems like one solution.  Any Atom entry can have something like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;link rel=<span class="st0">&quot;self&quot;</span> <span class="kw2">type</span>=<span class="st0">&quot;application/atom+xml; type=entry&quot;</span><br />
&nbsp;href=<span class="st0">&quot;url?format=atom&quot;</span> /&gt;<br />
&nbsp;</div>
<p>This indicates where the entry exists, though it doesn&#8217;t suggest very forcefully that the actual entry is abbreviated.  Anyway, I could then imagine a feed like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;feed&gt;<br />
&nbsp; &lt;entry&gt;<br />
<br />
&nbsp; &nbsp; &lt;content <span class="kw2">type</span>=<span class="st0">&quot;some/content-type&quot;</span> /&gt;<br />
&nbsp; &nbsp; &lt;link rel=<span class="st0">&quot;self&quot;</span> href=<span class="st0">&quot;...&quot;</span> /&gt;<br />
&nbsp; &nbsp; &lt;updated&gt;YYYYMMDDTHH:MM:SSZ&lt;/updated&gt;<br />
&nbsp; &lt;entry&gt;<br />
&nbsp; ...<br />
&lt;/feed&gt;<br />
&nbsp;</div>
<p>This isn&#8217;t entirely valid, however &#8212; you can&#8217;t just have an empty <tt class="docutils literal"><span class="pre">&lt;content&gt;</span></tt> tag.  You can use a <tt class="docutils literal"><span class="pre">src</span></tt> attribute to use indirection for the content, and then add Yet Another URL for each page that points to its raw content.  But that&#8217;s just jumping through hoops.  This also seems like an opportunity to suggest that the entry is incomplete.</p>
<p>To actually construct these feeds, you need some way of getting the feed.  I suggest that another entry be added to the Atompub service document, something like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;cmsapi:feed href=<span class="st0">&quot;URI-TEMPLATE&quot;</span> /&gt;<br />
&nbsp;</div>
<p>That would be a <a class="reference external" href="http://bitworking.org/projects/URI-Templates/">URI Template</a> that accepted several known variables (though frustratingly, URI Templates aren&#8217;t properly standardized yet).  Things like:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">content-type</span></tt>: the content type of the resource (allowing wildcards like <tt class="docutils literal"><span class="pre">image/*</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">container</span></tt>: a path to a container, i.e., <tt class="docutils literal"><span class="pre">/2007</span></tt> would match all pages in <tt class="docutils literal"><span class="pre">/2007/...</span></tt></li>
<li><tt class="docutils literal"><span class="pre">path-regex</span></tt>: some regular expression to match the paths</li>
<li><tt class="docutils literal"><span class="pre">last-modified</span></tt>: return all pages modified at the given date or later</li>
</ul>
<p>All parameters would be ANDed together.</p>
<p>So, open issues:</p>
<ul class="simple">
<li>How to strongly suggest a path when creating a resource (better than Slug)</li>
<li>How to rename (move) or copy a page (it&#8217;s easy enough to punt on copy, but I&#8217;d rather move by a <em>little</em> more formal than just recreating a resource in a new location and deleting the original)</li>
<li>How to represent abbreviated Atom entries</li>
</ul>
<p>With these resolved I think it&#8217;d be possible to create a much simpler API than WebDAV, and one that can be applied to existing applications much more easily.  (If you think there&#8217;s more missing, please comment.)</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2009/01/11/atompub-instead-o-webdav/"
    dc:identifier="http://blog.ianbicking.org/2009/01/11/atompub-instead-o-webdav/"
    dc:title="Atompub as an alternative to WebDAV"
    trackback:ping="http://blog.ianbicking.org/2009/01/11/atompub-instead-o-webdav/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2009 01 11</h3>
				<p class="post-categories"><a href="../../../html/index.html" title="View all posts in HTML" rel="category tag">HTML</a><br/><a href="../../../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2009/01/11/atompub-instead-o-webdav/index.html#comments" title="Comment on Atompub as an alternative to WebDAV">Comments (26)</a></p>
				<p class="post-permalink"><a href="../../../../2009/01/11/atompub-instead-o-webdav/index.html" title="Permalink to Atompub as an alternative to WebDAV" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-90" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../../../2008/12/27/avoiding-silos-link-as-a-first-class-object/index.html" title="Permalink to Avoiding Silos: &#8220;link&#8221; as a first-class object" rel="bookmark">Avoiding Silos: &#8220;link&#8221; as a first-class object</a></h2>
					<div class="post-entry">
						<div class="document">
<p>One of the constant annoyances to me in web applications is the self-proclaimed need for those applications to know about everything and do everything, and only spotty ad hoc techniques for including things from other applications.</p>
<p>An example might be blog navigation or search, where you can only include data from the application itself.  Or &quot;Recent Posts&quot; which can only show locally-produce posts.  What if I post something elsewhere?  I have to create some shoddy placeholder post to refer to it.  Bah!  Underlying this the data is usually structured in a specific way, with the HTML being a sort of artifact of the database, the markup transient and a slave to the database&#8217;s structure.</p>
<p>An example of this might be a recent post listing like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;ul&gt;<br />
&nbsp; <span class="kw1">for</span> post <span class="kw1">in</span> recent_posts:<br />
&nbsp; &nbsp; &lt;li&gt;<br />
&nbsp; &nbsp; &nbsp; &lt;a href=<span class="st0">&quot;/post/{{post.year}}/{{post.month}}/{{post.slug}}&quot;</span>&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span><span class="br0">&#123;</span>post.<span class="me1">title</span><span class="br0">&#125;</span><span class="br0">&#125;</span>&lt;/a&gt;<br />
&nbsp; &nbsp; &lt;/li&gt;<br />
&lt;/ul&gt;<br />
&nbsp;</div>
<p>There&#8217;s clearly no room for exceptions in this code.  I am thus proposing that any system like this should have the notion of a &quot;link&quot; as a first-class object.  The code should look like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&lt;ul&gt;<br />
&nbsp; <span class="kw1">for</span> post <span class="kw1">in</span> recent_posts:<br />
&nbsp; &nbsp; &lt;li&gt;<br />
&nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span><span class="br0">&#123;</span>post.<span class="me1">link</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#125;</span><span class="br0">&#125;</span><br />
&nbsp; &nbsp; &lt;/li&gt;<br />
&lt;/ul&gt;<br />
&nbsp;</div>
<p>Just like with <a class="reference external" href="../../../../2008/10/24/hypertext-driven-urls/index.html">changing IDs to links</a> in service documents, the template doesn&#8217;t actually look any more complicated than it did before (simpler, even).  But now we can use simple object-oriented techniques to create first-class links.  The code might look like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">class</span> Post<span class="br0">&#40;</span>SomeORM<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">def</span> url<span class="br0">&#40;</span><span class="kw2">self</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw2">self</span>.<span class="kw2">type</span> == <span class="st0">'link'</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">self</span>.<span class="me1">body</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">else</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; base = get_request<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">application_url</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">'%s/%s/%s/%s'</span> % <span class="br0">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; base, <span class="kw2">self</span>.<span class="me1">year</span>, <span class="kw2">self</span>.<span class="me1">month</span>, <span class="kw2">self</span>.<span class="me1">slug</span><span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> link<span class="br0">&#40;</span><span class="kw2">self</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> html<span class="br0">&#40;</span><span class="st0">'&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;'</span><span class="br0">&#41;</span> % <span class="br0">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">url</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw2">self</span>.<span class="me1">title</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>The addition of the <tt class="docutils literal"><span class="pre">.url()</span></tt> method has the obvious effect of making these offsite links work.  Using a <tt class="docutils literal"><span class="pre">.link()</span></tt> method has the added advantage of allowing things like HTML snippets to be inserted into the system (even though that is not implemented here).  By allowing arbitrary HTML in certain places you make it possible for people to extend the site in little ways &#8212; possibly adding markup to a title, or allowing an item in the list that actually contains two URLs (e.g., <tt class="docutils literal"><span class="pre">&lt;a</span> <span class="pre">href=&quot;url1&quot;&gt;Some</span> <span class="pre">Item&lt;/a&gt;</span> <span class="pre">(&lt;a</span> <span class="pre">href=&quot;url2&quot;&gt;via&lt;/a&gt;)</span></tt>).</p>
<p>In the context of Python I recommend making these into methods, not properties, because it allows you to later add keyword arguments to specialize the markup (like <tt class="docutils literal"><span class="pre">post.link(abbreviated=True)</span></tt>).</p>
<p>One negative aspect of this is that you cannot affect all the markup through the template alone, you may have to go into the Python code to change things.  Anyone have ideas for handling this problem?</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2008/12/27/avoiding-silos-link-as-a-first-class-object/"
    dc:identifier="http://blog.ianbicking.org/2008/12/27/avoiding-silos-link-as-a-first-class-object/"
    dc:title="Avoiding Silos: &#8220;link&#8221; as a first-class object"
    trackback:ping="http://blog.ianbicking.org/2008/12/27/avoiding-silos-link-as-a-first-class-object/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2008 12 27</h3>
				<p class="post-categories"><a href="../../../html/index.html" title="View all posts in HTML" rel="category tag">HTML</a><br/><a href="../../../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="../../../python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../../index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../../../2008/12/27/avoiding-silos-link-as-a-first-class-object/index.html#comments" title="Comment on Avoiding Silos: &#8220;link&#8221; as a first-class object">Comments (13)</a></p>
				<p class="post-permalink"><a href="../../../../2008/12/27/avoiding-silos-link-as-a-first-class-object/index.html" title="Permalink to Avoiding Silos: &#8220;link&#8221; as a first-class object" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div class="navigation">
			<div class="alignleft"><a href="http://blog.ianbicking.org/category/web/page/3/" >&laquo; Older posts</a></div>
			<div class="alignright"><a href="../../index.html" >Newer posts &raquo;</a></div>
		</div><!-- END NAVIGATION -->


	</div><!-- END CONTENT -->
</div><!-- END CONTAINER  -->

<div id="sidebar">
	<ul>
		<li id="home-link">
			<h2><a href="../../../../index.html" title="Ian Bicking: a blog">Home</a></h2>
		</li>
<li id="text-315934862" class="widget widget_text"><h2 class="widgettitle">About</h2>
			<div class="textwidget">Ian is a developer with Mozilla, <a href="http://ianbicking.appspot.com/projects">Python open source developer</a>, actually uses <a href="https://plus.google.com/u/0/104537541227697934010/posts">Google+</a> more than <a href="http://twitter.com/ianbicking">twitter</a> and lives in Minneapolis.<br>
<span class="gittip-0001" gittip-username="ianbicking"></span>
<script id="gittip-0001"
  src="https://www.gittip.com/assets/widgets/0001.js"></script>
</div>
		</li>
<li id="text-315934863" class="widget widget_text">			<div class="textwidget"><!-- <script type="text/javascript">mbgc='f5f5f5';ww='160';mbc='cecece';bbc='3F79D5';bmobc='3b71c6';bbgc='4889F0';bmoc='3F79D5';bfc='FFFFFF';bmofc='ffffff';tlc='cecece';tc='6a6a6a';nc='6a6a6a';bc='6a6a6a';l='y';fs='16';fsb='13';bw='100';ff='4';lu='6a6a6a';pc='4889F0';wh='340';b='s'; pid='104537541227697934010';</script><script type="text/javascript" src="http://widgetsplus.com/google_plus_widget.js"></script> --></div>
		</li>
<li id="archives-2" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
		<ul>
			<li><a href='../../../../2012/10/index.html' title='October 2012'>October 2012</a></li>
	<li><a href='../../../../2012/02/index.html' title='February 2012'>February 2012</a></li>
	<li><a href='../../../../2011/04/index.html' title='April 2011'>April 2011</a></li>
	<li><a href='../../../../2011/03/index.html' title='March 2011'>March 2011</a></li>
	<li><a href='../../../../2010/09/index.html' title='September 2010'>September 2010</a></li>
	<li><a href='../../../../2010/08/index.html' title='August 2010'>August 2010</a></li>
	<li><a href='../../../../2010/05/index.html' title='May 2010'>May 2010</a></li>
	<li><a href='../../../../2010/04/index.html' title='April 2010'>April 2010</a></li>
	<li><a href='../../../../2010/03/index.html' title='March 2010'>March 2010</a></li>
	<li><a href='../../../../2010/02/index.html' title='February 2010'>February 2010</a></li>
	<li><a href='../../../../2010/01/index.html' title='January 2010'>January 2010</a></li>
	<li><a href='../../../../2009/09/index.html' title='September 2009'>September 2009</a></li>
	<li><a href='../../../../2009/05/index.html' title='May 2009'>May 2009</a></li>
	<li><a href='../../../../2009/04/index.html' title='April 2009'>April 2009</a></li>
	<li><a href='../../../../2009/01/index.html' title='January 2009'>January 2009</a></li>
	<li><a href='../../../../2008/12/index.html' title='December 2008'>December 2008</a></li>
	<li><a href='../../../../2008/11/index.html' title='November 2008'>November 2008</a></li>
	<li><a href='../../../../2008/10/index.html' title='October 2008'>October 2008</a></li>
	<li><a href='../../../../2008/09/index.html' title='September 2008'>September 2008</a></li>
	<li><a href='../../../../2008/08/index.html' title='August 2008'>August 2008</a></li>
	<li><a href='../../../../2008/07/index.html' title='July 2008'>July 2008</a></li>
	<li><a href='../../../../2008/06/index.html' title='June 2008'>June 2008</a></li>
	<li><a href='../../../../2008/05/index.html' title='May 2008'>May 2008</a></li>
	<li><a href='../../../../2008/04/index.html' title='April 2008'>April 2008</a></li>
	<li><a href='../../../../2008/03/index.html' title='March 2008'>March 2008</a></li>
	<li><a href='../../../../2008/02/index.html' title='February 2008'>February 2008</a></li>
	<li><a href='../../../../2008/01/index.html' title='January 2008'>January 2008</a></li>
	<li><a href='../../../../2007/11/index.html' title='November 2007'>November 2007</a></li>
	<li><a href='../../../../2007/10/index.html' title='October 2007'>October 2007</a></li>
	<li><a href='../../../../2007/09/index.html' title='September 2007'>September 2007</a></li>
	<li><a href='../../../../2007/08/index.html' title='August 2007'>August 2007</a></li>
	<li><a href='../../../../2007/07/index.html' title='July 2007'>July 2007</a></li>
		</ul>
</li>
<li id="text-315934861" class="widget widget_text">			<div class="textwidget"><a href="../../../../archive/index.html">The Older Archives</a></div>
		</li>
<li id="categories-1" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-12"><a href="../../../erlang/index.html" title="View all posts filed under Erlang">Erlang</a>
</li>
	<li class="cat-item cat-item-11"><a href="../../../html/index.html" title="View all posts filed under HTML">HTML</a>
</li>
	<li class="cat-item cat-item-8"><a href="../../../javascript/index.html" title="View all posts filed under Javascript">Javascript</a>
</li>
	<li class="cat-item cat-item-15"><a href="../../../licensing/index.html" title="View all posts filed under Licensing">Licensing</a>
</li>
	<li class="cat-item cat-item-18"><a href="../../../mozilla/index.html" title="View all posts filed under Mozilla">Mozilla</a>
</li>
	<li class="cat-item cat-item-5"><a href="../../../notech/index.html" title="View all posts filed under Non-technical">Non-technical</a>
</li>
	<li class="cat-item cat-item-6"><a href="../../../olpc/index.html" title="View all posts filed under OLPC">OLPC</a>
</li>
	<li class="cat-item cat-item-14"><a href="../../../packaging/index.html" title="View all posts filed under Packaging">Packaging</a>
</li>
	<li class="cat-item cat-item-4"><a href="../../../politics/index.html" title="View all posts filed under Politics">Politics</a>
</li>
	<li class="cat-item cat-item-3"><a href="../../../programming/index.html" title="View all posts filed under Programming">Programming</a>
</li>
	<li class="cat-item cat-item-7"><a href="../../../python/index.html" title="View all posts filed under Python">Python</a>
</li>
	<li class="cat-item cat-item-10"><a href="../../../ruby/index.html" title="View all posts filed under Ruby">Ruby</a>
</li>
	<li class="cat-item cat-item-19"><a href="../../../security/index.html" title="View all posts filed under Security">Security</a>
</li>
	<li class="cat-item cat-item-16"><a href="../../../silverlining.1" title="View all posts filed under Silver Lining">Silver Lining</a>
</li>
	<li class="cat-item cat-item-20"><a href="../../../programming/testing/index.html" title="View all posts filed under Testing">Testing</a>
</li>
	<li class="cat-item cat-item-9 current-cat"><a href="../../index.html" title="View all posts filed under Web">Web</a>
</li>
	<li class="cat-item cat-item-13"><a href="../../../zopeplone/index.html" title="View all posts filed under Zope/Plone">Zope/Plone</a>
</li>
		</ul>
</li>
<li id="search-2" class="widget widget_search"><form id="searchform" method="get" action="../../../../index.html">
	<div>
		<input id="s" name="s" type="text" value="" tabindex="1" size="10" />
		<input id="searchsubmit" name="searchsubmit" type="submit" value="Find" tabindex="2" />
	</div>
</form> </li>
		<li id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widgettitle">Recent Posts</h2>
		<ul>
				<li><a href="../../../../index.html?p=291" title="Why doctest.js is better than Python&#8217;s doctest">Why doctest.js is better than Python&#8217;s doctest</a></li>
				<li><a href="../../../../index.html?p=283" title="Python Application Package">Python Application Package</a></li>
				<li><a href="../../../../index.html?p=277" title="Git-as-sync, not source-control-as-deployment">Git-as-sync, not source-control-as-deployment</a></li>
				<li><a href="../../../../index.html?p=253" title="My Unsolicited Advice For PyPy">My Unsolicited Advice For PyPy</a></li>
				<li><a href="../../../../index.html?p=250" title="A Python Web Application Package and Format (we should make one)">A Python Web Application Package and Format (we should make one)</a></li>
				</ul>
		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">Recent Comments</h2>
<ul id="recentcomments"><li class="recentcomments"><a href='http://www.mirsa.com.tr' rel='external nofollow' class='url'>havalandrma</a> on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-228633">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments"><a href='http://redealmeidense.com.br/portalx/modules/' rel='external nofollow' class='url'>this website</a> on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-196267">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments">Eric Pierce on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195322">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments">Paul Brian on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195321">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments"><a href='http://benjiyork.com' rel='external nofollow' class='url'>Benji York</a> on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195320">Why doctest.js is better than Python&#8217;s doctest</a></li></ul></li>
	</ul>
</div>

	<div id="footer">
		<p>
			&copy; 2013 Ian Bicking<!--
Does this commenting make me evil?
			|
			Thanks, <a href="http://wordpress.org/" title="WordPress">WordPress</a>
			|
			<a href="http://www.plaintxt.org/themes/barthelme/" title="Barthelme for WordPress" rel="follow">Barthelme</a> theme by <a href="http://scottwallick.com/" title="scottwallick.com" rel="follow">Scott</a>
			| <!-- The following is a link to the theme author's sponsor. Please consider its smallness and that Scott was nice enough to make this theme publically available. -->
			Sponsor: <a href="http://www.active-sandals.com/womreefsan.html" title="Support: Reef Sandals">Reef Sandals</a>
			|
			Valid <a href="http://validator.w3.org/check?uri=http://blog.ianbicking.org&amp;outline=1&amp;verbose=1" title="Valid XHTML 1.0 Strict" rel="nofollow">XHTML</a> &amp; <a href="http://jigsaw.w3.org/css-validator/validator?uri=http://blog.ianbicking.org/wp-content/themes/Barthelme-ianb/style.css&amp;profile=css2&amp;warning=no" title="Valid CSS" rel="nofollow">CSS</a>
			|
			-->
			RSS: <a href="../../../../feed/rss/index.html" title="Ian Bicking: a blog RSS 2.0 (XML) Feed" rel="alternate" type="application/rss+xml">Posts</a> &amp; <a href="../../../../comments/feed/index.html" title="Ian Bicking: a blog Comments RSS 2.0 (XML) Feed" rel="alternate" type="application/rss+xml">Comments</a>
		</p>
	</div>

</div><!-- END WRAPPER -->

	<!-- Somehow 41 queries occured in 2.936 seconds. Magic! -->
	<!-- The "Barthelme" theme copyright (c) 2006 Scott Allan Wallick - http://www.plaintxt.org/themes/ -->
	
<!-- Google Analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2442258-1";
urchinTracker();
</script>

</body>
</html>