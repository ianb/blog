<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- MOBIFY - DO NOT ALTER - PASTE IMMEDIATELY AFTER OPENING HEAD TAG -->
<script type="text/javascript">/*<![CDATA[*/(function(a){function b(a,b){if(+a)return~a||(d.cookie=h+"=; path=/");j=d.createElement(e),k=d.getElementsByTagName(e)[0],j.src=a,b&&(j.onload=j.onerror=b),k.parentNode.insertBefore(j,k)}function c(){n.api||b(l.shift()||-1,c)}if(this.Mobify)return;var d=document,e="script",f="mobify",g="."+f+".com/",h=f+"-path",i=g+"un"+f+".js",j,k,l=[!1,1],m,n=this.Mobify={points:[+(new Date)],tagVersion:[6,0]},o=/(; |#|&|^)mobify-path=([^&;]*)/g.exec(location.hash+"; "+d.cookie);o?(m=o[2])&&!+(m=sessionStorage[h]||m)&&(l=[!0,"//preview"+g+escape(m)]):(l=a()||l,l[0]&&l.push("//cdn"+i,"//files01"+i)),l.shift()?(d.write('<plaintext style="display:none;">'),setTimeout(c)):b(l[0])})(function(){if(/ip(hone|od)|android.*(mobile)|blackberry.*applewebkit/i.test(navigator.userAgent)){return[1,"//cdn.mobify.com/sites/ians-blog/production/mobify.js"]}})/*]]>*/</script>
<!-- END MOBIFY -->
	<title>Ian Bicking: a blog   ::  Python</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="generator" content="WordPress 3.4.2" /><!-- LEAVE FOR STATS -->
	<meta name="description" content="" />
	<link rel="stylesheet" title="plaintxtSimpler" href="../../wp-content/themes/Barthelme-ianb/style.css" type="text/css" media="all" />
	<link rel="start" href="../../index.html" title="Ian Bicking: a blog" />
	<link rel="alternate" type="application/atom+xml" title="Ian Bicking: a blog Atom Feed" href="../../feed/atom/index.html" />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog RSS 2.0 Feed" href="../../feed/rss/index.html" />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog Comments RSS 2.0 Feed" href="../../comments/feed/index.html" />
	<link rel="alternate" type="application/rdf+xml" title="Ian Bicking: a blog RSS 1.0" href="../../feed/rdf/index.html" />
	<link rel="alternate" type="text/xml" title="Ian Bicking: a blog RSS 0.92 Feed" href="../../feed/rss/index.html" />
	<link rel="pingback" href="../../xmlrpc.php" />
	<link rel="openid.server" href="http://www.myopenid.com/server" />
	<link rel="openid.delegate" href="http://ianb.myopenid.com" />
        <link rel="me" type="text/html" href="http://www.google.com/profiles/ianbicking"/>
		<link rel='archives' title='October 2012' href='../../2012/10/index.html' />
	<link rel='archives' title='February 2012' href='../../2012/02/index.html' />
	<link rel='archives' title='April 2011' href='../../2011/04/index.html' />
	<link rel='archives' title='March 2011' href='../../2011/03/index.html' />
	<link rel='archives' title='September 2010' href='../../2010/09/index.html' />
	<link rel='archives' title='August 2010' href='../../2010/08/index.html' />
	<link rel='archives' title='May 2010' href='../../2010/05/index.html' />
	<link rel='archives' title='April 2010' href='../../2010/04/index.html' />
	<link rel='archives' title='March 2010' href='../../2010/03/index.html' />
	<link rel='archives' title='February 2010' href='../../2010/02/index.html' />
	<link rel='archives' title='January 2010' href='../../2010/01/index.html' />
	<link rel='archives' title='September 2009' href='../../2009/09/index.html' />
	<link rel='archives' title='May 2009' href='../../2009/05/index.html' />
	<link rel='archives' title='April 2009' href='../../2009/04/index.html' />
	<link rel='archives' title='January 2009' href='../../2009/01/index.html' />
	<link rel='archives' title='December 2008' href='../../2008/12/index.html' />
	<link rel='archives' title='November 2008' href='../../2008/11/index.html' />
	<link rel='archives' title='October 2008' href='../../2008/10/index.html' />
	<link rel='archives' title='September 2008' href='../../2008/09/index.html' />
	<link rel='archives' title='August 2008' href='../../2008/08/index.html' />
	<link rel='archives' title='July 2008' href='../../2008/07/index.html' />
	<link rel='archives' title='June 2008' href='../../2008/06/index.html' />
	<link rel='archives' title='May 2008' href='../../2008/05/index.html' />
	<link rel='archives' title='April 2008' href='../../2008/04/index.html' />
	<link rel='archives' title='March 2008' href='../../2008/03/index.html' />
	<link rel='archives' title='February 2008' href='../../2008/02/index.html' />
	<link rel='archives' title='January 2008' href='../../2008/01/index.html' />
	<link rel='archives' title='November 2007' href='../../2007/11/index.html' />
	<link rel='archives' title='October 2007' href='../../2007/10/index.html' />
	<link rel='archives' title='September 2007' href='../../2007/09/index.html' />
	<link rel='archives' title='August 2007' href='../../2007/08/index.html' />
	<link rel='archives' title='July 2007' href='../../2007/07/index.html' />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog &raquo; Python Category Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 3.4.2" />
<link rel="stylesheet" href="../../wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"  type="text/css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
        <style type="text/css" media="all">
/*<![CDATA[*/
body { font-size: 100%; }
body { font-family: tahoma, geneva, sans-serif; }
div.post-header, h2.post-title, p.post-date-single, h2.post-title-single, div.post-entry h1, div.post-entry h2, div.post-entry h3, div.post-entry h4, div.post-entry h5, div.post-entry h6, div.post-entry blockquote, div.post-footer, h3#comment-count, h4#comment-header, div#comments ol li p.comment-metadata, h4#respond { font-family: verdana, geneva, sans-serif; }
div.post-entry p { text-align: left; }
div#wrapper { width: 100%; }

/*]]>*/
</style>
</head>
<body>

<div id="wrapper">

	<div id="header" onclick="location.href='http://blog.ianbicking.org/';" style="cursor:pointer;">
		<h1 id="title"><a href="../../index.html" title="Ian Bicking: a blog">Ian Bicking: a blog</a></h1>
		<p id="description"></p>
	</div>
<!-- WP Theme Credits -->
<div style="display: none;">We can answer on question <a href="http://www.olnevhost.net/vps-hosting.html">what is VPS</a>? and
what is <a href="http://www.olnevhost.net/dedicated-servers.html"><strong>cheap dedicated servers</strong></a>?</div>
<!-- END HEADER -->
<div id="container">
	<div id="content" class="narrowcolumn">


				
		<p class="post-date-single">{ Category Archives }</p>
		<h2 class="post-title-single">Python</h2>		

				
		<div id="post-291" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../index.html?p=291" title="Permalink to Why doctest.js is better than Python&#8217;s doctest" rel="bookmark">Why doctest.js is better than Python&#8217;s doctest</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;ve been trying, not too successfully I&#8217;m afraid, to get more people to use <a class="reference external" href="http://doctestjs.org">doctest.js</a>.  There&#8217;s probably a few reasons people don&#8217;t.  They are all wrong!  Doctest.js is the best!</p>
<p>One issue in particular is that people (especially people in my Python-biased circles) are perhaps thrown off by Python&#8217;s doctest.  I think Python&#8217;s doctest is pretty nice, I enjoy testing with it, but there&#8217;s no question that it has a lot of problems.  I&#8217;ve even thought about trying to fix doctest, and even made a repository, but I only really got as far as <a class="reference external" href="https://github.com/ianb/doctest2/issues?direction=desc&amp;#038;sort=created&amp;#038;state=open">creating a list of issues I&#8217;d like to fix</a>. But, like so many before me, I never actually <em>made</em> those fixes. Doctest has, in its life, only really had a single period of improvement (in the time leading to Python 2.4).  That&#8217;s not a recipe for success.</p>
<p>Of course doctest.js takes inspiration from Python&#8217;s doctest, but I wrote it as a real test environment, not for a minimal use case.  In the process I fixed a bunch of issues with doctest, and in places Javascript has also provided helpful usability.</p>
<p>Some issues:</p>
<div class="section" id="doctest-js-output-is-predictable">
<h2>Doctest.js output is predictable</h2>
<p>The classic pitfall of Python&#8217;s doctest is printing a dictionary:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&gt;&gt;&gt; <span class="kw1">print</span> <span class="br0">&#123;</span><span class="st0">&quot;one&quot;</span>: <span class="nu0">1</span>, <span class="st0">&quot;two&quot;</span>: <span class="nu0">2</span><span class="br0">&#125;</span><br />
<span class="br0">&#123;</span><span class="st0">'two'</span>: <span class="nu0">2</span>, <span class="st0">'one'</span>: <span class="nu0">1</span><span class="br0">&#125;</span><br />
&nbsp;</div>
<p>The print order of a dictionary is arbitrary, based on a hash algorithm that can change, or mix things up as items are added or removed.  And to make it worse, the output <em>usually</em> stable, such that you can write tests that unexpectibly fragile.  But there&#8217;s no reason why <tt class="docutils literal"><span class="pre">dict.__repr__</span></tt> <em>must</em> use an arbitrary order.  Personally I take it as a bit of unfortunate laziness.</p>
<p>If doctest had used <tt class="docutils literal"><span class="pre">pprint</span></tt> for all of its printing it would have helped some.  But not enough, because this kind of code is fairly common:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">def</span> <span class="kw4">__repr__</span><span class="br0">&#40;</span><span class="kw2">self</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">'&lt;ThisClass attr=%r&gt;'</span> % <span class="kw2">self</span>.<span class="me1">attr</span><br />
&nbsp;</div>
<p>and that <tt class="docutils literal"><span class="pre">%r</span></tt> invokes a <tt class="docutils literal"><span class="pre">repr()</span></tt> that cannot be overridden.</p>
<p>In doctest.js I always try to make output predictable.  One reason this is fairly easy is that there&#8217;s nothing like <tt class="docutils literal"><span class="pre">repr()</span></tt> in Javascript, so doctest.js has its own implementation.  It&#8217;s like I started with pprint and no other notion existed.</p>
</div>
<div class="section" id="good-matching">
<h2>Good matching</h2>
<p>In addition to unpredictable output, there&#8217;s also just hard-to-match output.  Output might contain blank lines, for instance, and Python&#8217;s doctest requires a very ugly <tt class="docutils literal"><span class="pre">&lt;BLANKLINE&gt;</span></tt> token to handle that. Whitespace might not be normalized.  Maybe there&#8217;s boring output. Maybe there&#8217;s just a volatile item like a timestamp.</p>
<p>Doctest.js includes, by default, ellipsis: <tt class="docutils literal"><span class="pre">...</span></tt> matches any length of text.  But it also includes another wildcard, <tt class="docutils literal"><span class="pre">?</span></tt>, which matches just one number or word.  This avoids cases when the use of <tt class="docutils literal"><span class="pre">...</span></tt> swallows up too much when you just wanted to get a single word.</p>
<p>Also doctest.js doesn&#8217;t use <tt class="docutils literal"><span class="pre">...</span></tt> for other purposes.  In Python&#8217;s doctest <tt class="docutils literal"><span class="pre">...`</span></tt> is used for continuation lines, meaning you can&#8217;t just ignore output, like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&gt;&gt;&gt; <span class="kw1">print</span> who_knows_what_this_returns<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
...<br />
&nbsp;</div>
<p>Or even worse, you can&#8217;t ignore the beginning of an item:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&gt;&gt;&gt; <span class="kw1">print</span> some_request<br />
...<br />
<span class="me1">X</span>-Some-Header: foo<br />
...<br />
&nbsp;</div>
<p>The way I prefer to use doctest.js it doesn&#8217;t have <em>any</em> continuation line symbol (but if there is one, it&#8217;s <tt class="docutils literal"><span class="pre">&gt;</span></tt>).</p>
<p>Also doctest.js normalizes whitespace, normalizes <tt class="docutils literal"><span class="pre">&quot;</span></tt> and <tt class="docutils literal"><span class="pre">'</span></tt>, and just generally tries to be <em>reasonable</em>.</p>
</div>
<div class="section" id="doctest-js-tests-are-plain-javascript">
<h2>Doctest.js tests are plain Javascript</h2>
<p>Not many editors know how to syntax highlight and check doctests, with their <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> in front of each line and so forth.  And the whole thing is tweaky, you need to use a continuation (<tt class="docutils literal"><span class="pre">...</span></tt>) on some lines, and start statements with <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt>.  It&#8217;s an awkward way to compose.</p>
<p>Doctest.js started out with the same notion, though with different symbols (<tt class="docutils literal"><span class="pre">$</span></tt> and <tt class="docutils literal"><span class="pre">&gt;</span></tt>).  But recently with the rise of a number of excellent parsers (I used <a class="reference external" href="http://esprima.org/">Esprima</a>) I&#8217;ve moved my own tests to another pattern:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">print</span><span class="br0">&#40;</span>something<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />
// =&gt; expected output<br />
&nbsp;</div>
<p>This is already a fairly common way to write examples.  Like how you may have read pre-Python pseudocode and thought: <em>that looks like Python!</em>: doctest.js looks like example pseudocode.</p>
</div>
<div class="section" id="doctest-js-tests-are-self-describing">
<h2>Doctest.js tests are self-describing</h2>
<p>Python&#8217;s doctest has some options, some <em>important</em> options that effect the semantics of the test, that you can only turn on in the runner.  The most important option is ELLIPSIS.  Either your test was written to use ELLIPSIS or it wasn&#8217;t &#8211; that a test can&#8217;t self-describe its requirements means that test running is fragile.</p>
<p>I made <a class="reference external" href="http://pypi.python.org/pypi/dtopt">the hackiest package ever</a> to get around this in Python, but it&#8217;s hacky and lame.</p>
</div>
<div class="section" id="exception-handling-isn-t-special">
<h2>Exception handling isn&#8217;t special</h2>
<p>Python&#8217;s doctest treats exceptions differently from other output.  So if you print something before the exception, it is thrown away, never to be seen.  And you can&#8217;t use some of the same matching techniques.</p>
<p>Doctest.js just prints out exceptions, and it&#8217;s matched like anything else.</p>
<p>This particular case is one of several places where it feels like Python&#8217;s doctest is just being obstinate.  Doing it the right way isn&#8217;t harder.  Python&#8217;s doctest makes <em>debugging</em> exception cases really hard.</p>
</div>
<div class="section" id="doctest-js-has-a-concept-of-abort">
<h2>Doctest.js has a concept of &quot;abort&quot;</h2>
<p>I&#8217;m actually pretty okay with Python doctest&#8217;s notion that you just run all the tests, even when one fails.  Getting too many failures is a bit of a nuisance, but it&#8217;s not <em>that bad</em>.  But there&#8217;s no way to just give up, and there needs to be.  If you are relying on something to be importable, or some service to be available, there&#8217;s no point in going on with the tests.</p>
<p>Doctest.js lets you call <tt class="docutils literal"><span class="pre">Abort()</span></tt> and further tests are cancelled.</p>
</div>
<div class="section" id="distinguishing-between-debugging-output-and-deliberate-output">
<h2>Distinguishing between debugging output and deliberate output</h2>
<p>Maybe it&#8217;s my own fault for being a programming troglodite, but I use a lot of <tt class="docutils literal"><span class="pre">print</span></tt> for debugging.  This becomes a real problem with Python&#8217;s doctest, as it tracks all that printing and it causes tests to fail.</p>
<p>Javascript has something <em>specifically for</em> printing debugging output: <tt class="docutils literal"><span class="pre">console.log()</span></tt>.  Doctest.js doesn&#8217;t mess with that, it adds a new function <tt class="docutils literal"><span class="pre">print()</span></tt>.  Only stuff that is printed (not logged) is treated as expected output.  It&#8217;s like <tt class="docutils literal"><span class="pre">console.log()</span></tt> goes to stderr and <tt class="docutils literal"><span class="pre">print()</span></tt> goes to stdout.</p>
<p>Doctest.js also forces the developer to print everything they care about.  For better or worse Javascript has many more expressions than Python (including assignments), so looking at the result of an expression isn&#8217;t a good clue for whether you <em>care</em> about the result of an expression.  I&#8217;m not sure this is <em>better</em>, but it&#8217;s part of the difference.</p>
<p>Doctest.js also groups your printed statements according to the example you are in (an example being a block of code and an expected output).  This is much more helpful than watching a giant stream of output go to the console (the browser console or terminal).</p>
</div>
<div class="section" id="doctest-js-handles-async-code">
<h2>Doctest.js handles async code</h2>
<p>This admittedly isn&#8217;t that big a deal for Python, but for Javascript it is a real problem.  Not a problem for doctest.js in particular, but a problem for any Javascript test framework.  You want to test return values, but lots of functions don&#8217;t &quot;return&quot;, instead they call some callback or create some kind of promise object, and you have to test for side effects.</p>
<p>Doctest.js I think has a <a class="reference external" href="http://doctestjs.org/tutorial.html#async">really great answer for this</a>, which is not so much to say that Python&#8217;s doctest is so much worse, but in the context of Javascript doctest.js has something really useful and unique.  If callback-driven async code had ever been very popular in Python then this sort of feature would be nice there too.</p>
</div>
<div class="section" id="the-browser-is-a-great-environment">
<h2>The browser is a great environment</h2>
<p>A lot of where doctest.js is much better than Python&#8217;s doctest is simply that it has a much more powerful environment for displaying results.  It can highlight failed or passing tests.  When there&#8217;s a wildcard in expected output, it can show the actual output without adding any particular extra distraction.  It can group console messages with the tests they go with.  It can show <em>both</em> a simple failure message, and a detailed line-by-line comparison.  All these details make it easy to identify what went wrong and fix it.  The browser gives a rich and navigable interface.</p>
<p>I&#8217;d <em>like</em> to get doctest.js working well on Node.js (right now it works, but is not appealing), but I just can&#8217;t bring myself to give up the browser.  I have to figure out a good hybrid.</p>
</div>
<div class="section" id="python-s-doctest-lacks-a-champion">
<h2>Python&#8217;s doctest lacks a champion</h2>
<p>This is ultimately the reason Python&#8217;s doctest has all these problems: no one cares about it, no one feels responsible for it, and no one feels empowered to make improvements to it.  And to make things worse there is a cadre of people that will respond to suggestions with their own criticisms that doctest should never be used beyond its original niche, that it&#8217;s constraints are features.</p>
</div>
<div class="section" id="doctest-is-still-great">
<h2>Doctest is still great</h2>
<p>I&#8217;m ragging on Python&#8217;s doctest only because I love it.  I wish it was better, and I made doctest.js in a way I wish Python&#8217;s doctest was made.  Doctest, and more generally example/expectation oriented code, is a great way to explain things, to make tests readable, to make test-driven development feasible, to create an environment that errs on the side of over-testing instead of under-testing, and to make failures and resolutions symmetric.  It&#8217;s still <a class="reference external" href="../../behavior-driven-programming.html">vastly superior to BDD</a>, avoiding all BDD&#8217;s aping of readability while still embracing the sense of test-as-narrative.</p>
<p>But, more to the point: <a class="reference external" href="http://doctestjs.org">use doctest.js</a>, <a class="reference external" href="http://doctestjs.org/tutorial.html">read the tutorial</a>, or <a class="reference external" href="http://doctestjs.org/try.html">try it in the browser</a>.  I swear, it&#8217;s <em>really nice to use</em>.</p>
</div>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/"
    dc:identifier="http://blog.ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/"
    dc:title="Why doctest.js is better than Python&#8217;s doctest"
    trackback:ping="http://blog.ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2012 10 02</h3>
				<p class="post-categories"><a href="../javascript/index.html" title="View all posts in Javascript" rel="category tag">Javascript</a><br/><a href="../mozilla/index.html" title="View all posts in Mozilla" rel="category tag">Mozilla</a><br/><a href="../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a></p>
				<p class="post-comments"><a href="../../index.html?p=291#comments" title="Comment on Why doctest.js is better than Python&#8217;s doctest">Comments (19)</a></p>
				<p class="post-permalink"><a href="../../index.html?p=291" title="Permalink to Why doctest.js is better than Python&#8217;s doctest" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-283" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../index.html?p=283" title="Permalink to Python Application Package" rel="bookmark">Python Application Package</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;ve been thinking some more about deployment of Python web applications, and deployment in general (in part leading up to the <a class="reference external" href="https://us.pycon.org/2012/community/WebDevSummit/">Web Summit</a>). And I&#8217;ve got an idea.</p>
<p>I <a class="reference external" href="../../index.html?p=250">wrote about this about a year ago</a> and <a class="reference external" href="https://github.com/ianb/pywebapp/blob/master/docs/spec.txt">recently revised some notes on a proposal</a> but I&#8217;ve been thinking about something a bit more basic: a way to simply ship server applications, bundles of code.  Web applications are just one use case for this.</p>
<p>For now lets call this a &quot;Python application package&quot;.  It has these features:</p>
<ol class="arabic simple">
<li>There is an <em>application description</em>: this tells the <em>environment</em> about the application.  (This is sometimes called &quot;configuration&quot; but that term is very confusing and overloaded; I think &quot;description&quot; is much clearer.)</li>
<li>Given the description, you can create an execution environment to run code from the application and acquire objects from the application.  So there would be a specific way to setup <tt class="docutils literal"><span class="pre">sys.path</span></tt>, and a way to indicate any libraries that are required but not bundled directly with the application.</li>
<li>The environment can inject information into the application.  (Also this sort of thing is sometimes called &quot;configuration&quot;, but let&#8217;s not do that either.)  This is where the environment could indicate, for instance, what database the application should connect to (host, username, etc).</li>
<li>There would be a way to run commands and get objects from the application.  The environment would look in the application description to get the names of commands or objects, and use them in some specific manner depending on the purpose of the application.  For instance, WSGI web applications would point the environment to an application object.  A Tornado application might simply have a command to start itself (with the environment indicating what port to use through its injection).</li>
</ol>
<p>There&#8217;s a lot of things you can build from these pieces, and in a sophisticated application you might use a bunch of them at once.  You might have some WSGI, maybe a seperate non-WSGI server to handle Web Sockets, something for a Celery queue, a way to accept incoming email, etc.  In pretty much all cases I think basic application lifecycle is needed: commands to run when an application is first installed, something to verify the environment is acceptable, when you want to back up its data, when you want to uninstall it.</p>
<p>There&#8217;s also some things that all environments should setup the same or inject into the application.  E.g., <tt class="docutils literal"><span class="pre">$TMPDIR</span></tt> should point to a place where the application can keep its temporary files.  Or, every application should have a directory (perhaps specified in another environmental variable) where it can write log files.</p>
<div class="section" id="details">
<h2>Details?</h2>
<p>To get more concrete, here&#8217;s what I can imagine from a small application description; probably YAML would be a good format:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw3">platform</span>: python, wsgi<br />
require:<br />
&nbsp; <span class="kw3">os</span>: <span class="kw3">posix</span><br />
&nbsp; python: &lt;<span class="nu0">3</span><br />
&nbsp; rpm: m2crypto<br />
&nbsp; deb: python-m2crypto<br />
&nbsp; pip: requirements.<span class="me1">txt</span><br />
python:<br />
&nbsp; paths: vendor/<br />
wsgi:<br />
&nbsp; app: myapp.<span class="me1">wsgiapp</span>:application<br />
&nbsp;</div>
<p>I imagine <tt class="docutils literal"><span class="pre">platform</span></tt> as kind of a series of mixins.  This system doesn&#8217;t really need to be Python-specific; when creating something similar for <a class="reference external" href="http://cloudsilverlining.org">Silver Lining</a> I found PHP support relatively easy to add (handling languages that aren&#8217;t naturally portable, like Go, might be more of a stretch).  So <tt class="docutils literal"><span class="pre">python</span></tt> is one of the features this application uses.  You can imagine lots of modularization for other features, but it would be easy and unproductive to get distracted by that.</p>
<p>The application has certain requirements of its environment, like the version of Python and the general OS type.  The application might also require libraries, ideally one libraries that are not portable (M2Crypto being an example).  Modern package management works pretty nicely for this stuff, so relying on system packages as a first try I believe is best (I&#8217;d offer <tt class="docutils literal"><span class="pre">requirements.txt</span></tt> as a fallback, not as the primary way to handle dependencies).</p>
<p>I think it&#8217;s much more reliable if applications primarily rely on bundling their dependencies directly (i.e., using a vendor directory). The tool support for this is a bit spotty, but I believe this package format could clarify the problems and solutions.  <a class="reference external" href="https://gist.github.com/1368649">Here is an example</a> of how you might set up a virtualenv environment for <em>managing</em> vendor libraries (you then do not need virtualenv to <em>use</em> those same libraries), and do so in a way where you can check the results into source control.  It&#8217;s kind of complicated, but works (well, almost works &#8211; <tt class="docutils literal"><span class="pre">bin/</span></tt> files need fixing up).  It&#8217;s a start at least.</p>
</div>
<div class="section" id="support-library">
<h2>Support Library</h2>
<p>On the environment side we need a good support library.  <a class="reference external" href="https://github.com/ianb/pywebapp/">pywebapp</a> has some of the basic features, though it is quite incomplete. I imagine a library looking something like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> apppackage <span class="kw1">import</span> AppPackage<br />
app = AppPackage<span class="br0">&#40;</span><span class="st0">'/var/apps/app1.2012.02.11'</span><span class="br0">&#41;</span><br />
<span class="co1"># Maybe a little Debian support directly:</span><br />
<span class="kw3">subprocess</span>.<span class="me1">call</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="st0">'apt-get'</span>, <span class="st0">'install'</span><span class="br0">&#93;</span> +<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; app.<span class="me1">config</span><span class="br0">&#91;</span><span class="st0">'require'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">'deb'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />
<span class="co1"># Or fall back of virtualenv/pip</span><br />
app.<span class="me1">create_virtualenv</span><span class="br0">&#40;</span><span class="st0">'/var/app/venvs/app1.2012.02.11'</span><span class="br0">&#41;</span><br />
app.<span class="me1">install_pip_requirements</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
wsgi_app = app.<span class="me1">load_object</span><span class="br0">&#40;</span>app.<span class="me1">config</span><span class="br0">&#91;</span><span class="st0">'wsgi'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">'app'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>You can imagine building hosting services on this sort of thing, or setting up continuous integration servers (<tt class="docutils literal"><span class="pre">app.run_command(app.config['unit_test'])</span></tt>), and so forth.</p>
</div>
<div class="section" id="local-development">
<h2>Local Development</h2>
<p>If designed properly, I think this format is as usable for local development as it is for deployment.  It should be able to run directly from a checkout, with the &quot;development environment&quot; being an environment just like any other.</p>
<p>This rules out, or at least makes less exciting, the use of zip files or tarballs as a package format.  The only justification I see for using such archives is that they are easy to move around; but we live in the FUTURE and there are many ways to move directories around and we don&#8217;t need to cater to silly old fashions.  If that means a script that creates a tarball, FTPs it to another computer, and there it is unzipped, then fine &#8211; this format <em>should not</em> specify anything about how you actually deliver the files.  But let&#8217;s not worry about copying <a class="reference external" href="http://en.wikipedia.org/wiki/WAR_file_format_%28Sun%29">WARs</a>.</p>
</div>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2012/02/29/python-application-package/"
    dc:identifier="http://blog.ianbicking.org/2012/02/29/python-application-package/"
    dc:title="Python Application Package"
    trackback:ping="http://blog.ianbicking.org/2012/02/29/python-application-package/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2012 02 29</h3>
				<p class="post-categories"><a href="../packaging/index.html" title="View all posts in Packaging" rel="category tag">Packaging</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../silverlining.1" title="View all posts in Silver Lining" rel="category tag">Silver Lining</a><br/><a href="../web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../index.html?p=283#comments" title="Comment on Python Application Package">Comments (9)</a></p>
				<p class="post-permalink"><a href="../../index.html?p=283" title="Permalink to Python Application Package" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-253" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../index.html?p=253" title="Permalink to My Unsolicited Advice For PyPy" rel="bookmark">My Unsolicited Advice For PyPy</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I think the most interesting work in programming languages right now is about the <em>runtime</em>, not syntax or even the languages themselves. Which places PyPy in an interesting position, as they have put a great deal of effort into abstracting out the concept of runtime from the language they are implementing (Python).</p>
<p>There are of course other runtime environments available to Python. The main environment has and continues to be CPython &#8212; the runtime developed in parallel with the language, and with continuous incremental feedback and improvement by the Python developer community.  It is the runtime that informs and is informed by the language.  It&#8217;s also the runtime that is most easy-going about integrating with C libraries, and by extension it is part of the vague but important runtime environment of &quot;Unix&quot;.  There&#8217;s also Jython and IronPython.  I frankly find these completely uninteresting.  They are runtimes controlled by companies, not communities, and the Python implementations are neither natural parts of their runtime environments, nor do the runtimes include many concessions to make themselves natural for Python.</p>
<p>PyPy is somewhere different.  It still has a tremendous challenge because Python was not developed <em>for</em> PyPy.  Even small changes to the language seem impossible &#8212; something as seemingly innocuous as making builtins static seems to be stuck in a conservative reluctance to change.  But unlike Jython and IronPython they aren&#8217;t stuck between a rock and a hard place; they just have to deal with the rock, not the hard place.</p>
<p>So here is my unsolicited advice on what PyPy-the-runtime should consider.  Simple improvements to performance and the runtime are fine, but being incrementally better than CPython only goes so far, and I personally doubt it will ever make a big impact on Python that way.</p>
<p>PyPy should push hard on <em>concurrency</em> and <em>reliability</em>.  If it is <em>fast enough</em> then that&#8217;s fine; that&#8217;s done as far as I&#8217;m concerned. I say this because I&#8217;m a web programmer, and speed is uninteresting to me.  Certainly opinions will differ.  But to me speed (as it&#8217;s normally defined) is really <em>really</em> uninteresting.  When or if I care about speed I&#8217;m probably more drawn to Cython.  I <em>do</em> care about latency, memory efficiency, scalability/concurrency, resource efficiency, and most of all <em>worst cases</em>.  I don&#8217;t think a JIT addresses any of these (and can even make things worse).  I don&#8217;t know of benchmarks that measure these parameters either.</p>
<p>I want a runtime with new and novel features; something that isn&#8217;t just incrementally better than CPython.  This itself might seem controversial, as the only point to such novel features would be for people to implement at least some code intended for <em>only</em> PyPy.  But if the features are good enough then I&#8217;m okay with this &#8212; and if I&#8217;m not drawn to write something that will only work on PyPy, I probably won&#8217;t be drawn to use PyPy <em>at all</em>; natural conservatism and inertia will keep me (and most people) on CPython indefinitely.</p>
<p>What do I want?</p>
<ul class="simple">
<li><strong>Microprocesses</strong>.  Stackless and greenlets have given us micro-threads, but it&#8217;s just not the same.  Which is not entirely a criticism &#8212; it shows that unportable features <em>are</em> interesting when they are good features.  But I want the next step, which is processes that don&#8217;t share state.  (And implicitly I don&#8217;t just want standard async techniques, which use explicit concurrency and shared state.)</li>
<li><strong>Shared objects</strong> across processes with <strong>copy-on-write</strong>; then you can efficiently share objects (like modules!) across concurrent processes without the danger of shared state, but without the overhead of copying <em>everything</em> you want to share.  Lack of this is hurting PHP, as you can&#8217;t have a rich set of libraries and share-nothing without killing your performance.</li>
<li>I&#8217;d rather see a break in compatibility for C extensions to support this new model, than to abandon what could be PyPy&#8217;s best feature to support CPython&#8217;s C extension ecosystem.  Being a web programmer I honestly don&#8217;t need many C modules, so maybe I&#8217;m biased.  But if the rest of the system is good enough then the C extensions will come.</li>
<li>Make sure resource sharing that happens outside of the Python environment is really solid.  C libraries are often going to be unfriendly towards microprocesses; make sure what <em>is</em> exposed to the Python environment is solid.  That might even mean a dangerous process mode that can handle ctypes and FFI and where you carefully write Python code that has extra powers, so long as there&#8217;s a strong wall between that code and &quot;general&quot; code that makes use of those services.</li>
<li><strong>Cython</strong> &#8212; it&#8217;s doing a lot of good stuff, and has a much more conservative but also more predictable path to performance (through things like type annotation).  I think it&#8217;s worth leaning on.  I also have something of a hunch that it could be a good way to do FFI in a safe manner, as Cython already supports multiple targets (Python 2 and 3) from the same codebase.  Could PyPy be another target?</li>
<li><strong>Runtime introspection of the runtime</strong>.  We have great language introspection (probably much to the annoyance of PyPy developers who have to copy this) but currently runtime introspection is poor-to-nonexistant. What processes are running?  How much memory is each using?  Where? Are they holding on to resources?  Are they blocking on some non-Python library?  How much CPU have they been using?  Then I want to be able to kill processes, send them signals, adjust priorities, etc.</li>
</ul>
<p>And I guess it doesn&#8217;t have to be &quot;PyPy&quot;, but a new backend for PyPy to target; it doesn&#8217;t have to be the <em>only</em> path PyPy pursues.</p>
<p>With a runtime like this PyPy could be an absolutely rocking platform for web development.  Python could be as reliable as, oh&#8230; <a class="reference external" href="../../index.html?p=38">PHP</a>? Sorry, I probably won&#8217;t win arguments that way ;)  As good as Erlang! Maybe we could get the benefits of async without the pain of callbacks or Deferreds. And these are features people would <em>use</em>.  Right now I&#8217;m perceiving a problem where there&#8217;s lots of people standing on the sidelines cheering you on but not actually <em>using</em> PyPy.</p>
<p>So: I wouldn&#8217;t tell anyone what to do, and if someone tries this out I&#8217;ll probably only be on the sidelines cheering you on&#8230; but I really think this could be awesome.</p>
<p><strong>Update</strong>: there&#8217;s some <a class="reference external" href="http://news.ycombinator.com/item?id=2406920">interesting comments on Hacker News</a> as well.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2011/04/04/unsolicited-advice-for-pypy/"
    dc:identifier="http://blog.ianbicking.org/2011/04/04/unsolicited-advice-for-pypy/"
    dc:title="My Unsolicited Advice For PyPy"
    trackback:ping="http://blog.ianbicking.org/2011/04/04/unsolicited-advice-for-pypy/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2011 04 04</h3>
				<p class="post-categories"><a href="../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a></p>
				<p class="post-comments"><a href="../../index.html?p=253#comments" title="Comment on My Unsolicited Advice For PyPy">Comments (22)</a></p>
				<p class="post-permalink"><a href="../../index.html?p=253" title="Permalink to My Unsolicited Advice For PyPy" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-250" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../index.html?p=250" title="Permalink to A Python Web Application Package and Format (we should make one)" rel="bookmark">A Python Web Application Package and Format (we should make one)</a></h2>
					<div class="post-entry">
						
<div class="document">


<p>At PyCon there was an open space about deployment, and the idea of drop-in applications (Java-WAR-style).</p>
<p>I generally get pessimistic about 80% solutions, and dropping in a WAR file feels like an 80% solution to me. I&#8217;ve used the Hudson/Jenkins installer (which I think is <em>specifically</em> a project that got WARs on people&#8217;s minds), and in a lot of ways that installer is nice, but it&#8217;s also kind of wonky, it makes configuration unclear, it&#8217;s not always clear when it installs or configures itself through the web, and when you have to do this at the system level, nor is it clear where it puts files and data, etc. So a great initial experience doesn&#8217;t feel like a great ongoing experience to me &#8212; and <em>it doesn&#8217;t have to be that way</em>. If those were <em>necessary</em> compromises, sure, but they aren&#8217;t. And because we <em>don&#8217;t have</em> WAR files, if we&#8217;re proposing to make something new, then we have every opportunity to make things better.</p>
<p>So the question then is what we&#8217;re trying to make. To me: we want applications that are easy to install, that are self-describing, self-configuring (or at least guide you through configuration), reliable with respect to their environment (not dependent on system tweaking), upgradable, and respectful of persistence (the data that outlives the application install). A lot of this can be done by the &quot;container&quot; (to use Java parlance; or &quot;environment&quot;) &#8212; if you just have the app packaged in a nice way, the container (server environment, hosting service, etc) can handle all the system-specific things to make the application actually work.</p>
<p>At which point I am of course reminded of my <a class="reference external" href="http://cloudsilverlining.org">Silver Lining</a> project, which defines something very much like this. Silver Lining isn&#8217;t <em>just</em> an application format, and things aren&#8217;t fully extracted along these lines, but it&#8217;s pretty close and it addresses a lot of important issues in the lifecycle of an application. To be clear: Silver Lining is an application packaging format, a server configuration library, a cloud server management tool, a persistence management tool, and a tool to manage the application with respect to all these services over time. It is a bunch of things, maybe too many things, so it is not unreasonable to pick out a smaller subset to focus on. Maybe an easy place to start (and good for Silver Lining itself) would be to separate at least the application format (and tools to manage applications in that state, e.g., installing new libraries) from the tools that make use of such applications (deploy, etc).</p>
<p>Some opinions I have on this format, exemplified in Silver Lining:</p>
<ul class="simple">
<li>It&#8217;s not zipped or a single file, unlike WARs. Uploading zip files is not a great API. Geez. I know there&#8217;s this desire to &quot;just drop in a file&quot;; but there&#8217;s no getting around the fact that &quot;dropping a file&quot; becomes a <em>deployment protocol</em> <strong>and</strong> <em>it&#8217;s an incredibly impoverished protocol</em>. The format is also not subtly git-based (ala Heroku) because <tt class="docutils literal"><span class="pre">git</span> <span class="pre">push</span></tt> is not a good deployment protocol.</li>
<li>But of course there isn&#8217;t really any deployment protocol inferred by a format anyway, so maybe I&#8217;m getting ahead of myself ;) I&#8217;m saying a tool that deploys should take as an argument a directory, not a single file. (If the tool then zips it up and uploads it, fine!)</li>
<li>Configuration &quot;comes from the outside&quot;. That is, an application requests services, and the <em>container</em> tells the application where those services are. For Silver Lining I&#8217;ve used environmental variables. I think this one point is really important &#8212; the container <em>tells</em> the application. As a counter-example, an application that comes with a Puppet deployment recipe is essentially <em>telling</em> the server how to arrange itself to suit the application. This will never be reliable or simple!</li>
<li>The application indicates what &quot;services&quot; it wants; for instance, it may want to have access to a MySQL database. The container then provides this to the application. In practice this means installing the actual packages, but also creating a database and setting up permissions appropriately. The alternative is never having <em>any</em> dependencies, meaning you have to use SQLite databases or ad hoc structures, etc. But in fact installing databases really isn&#8217;t that hard these days.</li>
<li><em>All</em> persistence has to use a service of some kind. If you want to be able to write to files, you need to use a file service. This means the container is fully aware of everything the application is leaving behind. All the various paths an application should use are given in different environmental variables (many of which don&#8217;t need to be invented anew, e.g., <tt class="docutils literal"><span class="pre">$TMPDIR</span></tt>).</li>
<li>It uses vendor libraries exclusively for Python libraries. That means the application bundles all the libraries it requires. Nothing ever gets installed at deploy-time. This is in contrast to using a <tt class="docutils literal"><span class="pre">requirements.txt</span></tt> list of packages at deployment time. If you want to use those tools for development that&#8217;s fine, just not for deployment.</li>
<li>There <em>is</em> also a way to indicate other libraries you might require; e.g., you might <tt class="docutils literal"><span class="pre">lxml</span></tt>, or even something that isn&#8217;t quite a library, like <tt class="docutils literal"><span class="pre">git</span></tt> (if you are making a github clone). You can&#8217;t do those as vendor libraries (they include non-portable binaries). Currently in Silver Lining the application description can contain a list of Ubuntu package names to install. Of course that would have to be abstracted some.</li>
<li>You can ask for scripts or a request to be invoked for an application after an installation or deployment. It&#8217;s lame to try to test if is-this-app-installed on <em>every</em> request, which is the frequent alternative. Also, it gives the application the chance to signal that the installation failed.</li>
<li>It has a very simple (possibly/probably too simple) sense of configuration. You don&#8217;t have to use this if you make your app self-configuring (i.e., build in a web-accessible settings screen), but in practice it felt like some simple sense of configuration would be helpful.</li>
</ul>
<p>Things that could be improved:</p>
<ul class="simple">
<li>There are some places where you might be encouraged to use routines from the <tt class="docutils literal"><span class="pre">silversupport</span></tt> package. There are very few! But maybe an alternative could be provided for these cases.</li>
<li>A little convention-over-configuration is probably suitable for the bundled libraries; silver includes tools to manage things, but it gets a little twisty. When creating a new project I find myself creating several <tt class="docutils literal"><span class="pre">.pth</span></tt> files, special customizing modules, etc. Managing vendor libraries is also not obvious.</li>
<li><a class="reference external" href="http://cloudsilverlining.org/services.html">Services</a> are IMHO quite important and useful, but also need to be carefully specified.</li>
<li>There&#8217;s a bunch of runtime expectations that aren&#8217;t part of the format, but in practice would be part of how the application is written. For instance, I make sure each app has its own temporary directory, and that it is cleared on update. If you keep session files in that location, and you expect the environment to clean up old sessions &#8212; well, either all environments should do that, or none should.</li>
<li>The process model is not entirely clear. I tried to simply define one process model (unthreaded, multiple processes), but I&#8217;m not sure that&#8217;s suitable &#8212; most notably, multiple processes have a significant memory impact compared to threads. An application should at least be able to indicate what process models it accepts and prefers.</li>
<li>Static files are <em>all</em> convention over configuration &#8212; you put static files under <tt class="docutils literal"><span class="pre">static/</span></tt> and then they are available. So <tt class="docutils literal"><span class="pre">static/style.css</span></tt> would be at <tt class="docutils literal"><span class="pre">/style.css</span></tt>. I think this is generally <em>good</em>, but putting all static files under one URL path (e.g., <tt class="docutils literal"><span class="pre">/media/</span></tt>) can be good for other reasons as well. Maybe there should be conventions for both.</li>
<li>Cron jobs are important. Though maybe they could just be yet another kind of service? Many extra features could be new services.</li>
<li>Logging is also important; Silver Lining attempts to handle that somewhat, but it could be specified much better.</li>
<li>Silver Lining also supports PHP, which seemed to cause a bit of stress. But just ignore that. It&#8217;s really easy to ignore.</li>
</ul>
<p>There is a <a class="reference external" href="http://cloudsilverlining.org/appconfig.html">description of the configuration file for apps</a>. The <a class="reference external" href="http://cloudsilverlining.org/envvariables.html">environmental variables</a> are also notably part of the application&#8217;s expectations. The file layout is explained (together with a bunch of Silver Lining-specific concepts) in <a class="reference external" href="http://cloudsilverlining.org/devpatterns.html">Development Patterns</a>. Besides all that there is admittedly some other stuff that is only really specified in code; but in Silver Lining&#8217;s defense, specified in code is better than unspecified ;) App Engine provides another example of an application format, and would be worth using as a point of discussion or contrast (I did that myself when writing Silver Lining).</p>
<p>Discussing WSGI stuff with Ben Bangert at PyCon he noted that he didn&#8217;t really feel like the WSGI pieces needed that much more work, or at least that&#8217;s not where the interesting work was &#8212; the interesting work is in the tooling. An application format could provide a great basis for building this tooling. And I honestly think that the tooling has been held back more by divergent patterns of development than by the difficulty of writing the tools themselves; and a good, general application format could fix that.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2011/03/31/python-webapp-package/"
    dc:identifier="http://blog.ianbicking.org/2011/03/31/python-webapp-package/"
    dc:title="A Python Web Application Package and Format (we should make one)"
    trackback:ping="http://blog.ianbicking.org/2011/03/31/python-webapp-package/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2011 03 31</h3>
				<p class="post-categories"><a href="../packaging/index.html" title="View all posts in Packaging" rel="category tag">Packaging</a><br/><a href="../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../index.html?p=250#comments" title="Comment on A Python Web Application Package and Format (we should make one)">Comments (18)</a></p>
				<p class="post-permalink"><a href="../../index.html?p=250" title="Permalink to A Python Web Application Package and Format (we should make one)" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-224" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../index.html?p=224" title="Permalink to Silver Lining: More People!" rel="bookmark">Silver Lining: More People!</a></h2>
					<div class="post-entry">
						<div class="document">
<p>OK&#8230; so I said before Silver Lining is for collaborators not users. And that&#8217;s still true&#8230; it&#8217;s not a polished experience where you can confidently ignore the innards of the tool.  But it does stuff, and it works, and you can use it.  So&#8230; I encourage some more of you to do so.</p>
<p>Now would be a perfectly good time, for instance, to port an application you use to the system.  Almost all Python applications should be portable.  The requirements are fairly simple:</p>
<ol class="arabic simple">
<li>The application needs a WSGI interface.</li>
<li>It needs to be Python 2.6 compatible.</li>
<li>Any libraries that aren&#8217;t pure-Python need to be available as deb packages in some form.</li>
<li>Any persistence needs to be provided as a <a class="reference external" href="http://cloudsilverlining.org/services.html">service</a>; if the appropriate service isn&#8217;t already available you may need to write some code.</li>
</ol>
<p>Also PHP applications should work (though you may encounter more rough edges), with these constraints:</p>
<ol class="arabic simple">
<li>No <tt class="docutils literal"><span class="pre">.htaccess</span></tt> files, so you have to implement any URL rewriting in PHP (e.g., <a class="reference external" href="http://bitbucket.org/ianb/silverlining/src/tip/docs/examples/wordpress/runner.php">for WordPress</a>).</li>
<li>Source code is not writable, so self-installers that write files won&#8217;t work.  (Self-installing plugins might be workable, but that hasn&#8217;t been worked out yet.)</li>
<li>And the same constraints for services.</li>
</ol>
<p>So&#8230; take an application, give it a try, and tell me what you encounter.</p>
<p>Also I&#8217;d love to get feedback and ideas from people with more sysadmin background, or who know Ubuntu/Debian tricks.  For instance, I&#8217;d like to handle some of the questions packages ask about on installation (right now they are all left as defaults, not always the right answer).  I imagine there&#8217;s some non-interactive way to handle those questions but I haven&#8217;t been able to find it.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/04/21/silver-lining-more-people/"
    dc:identifier="http://blog.ianbicking.org/2010/04/21/silver-lining-more-people/"
    dc:title="Silver Lining: More People!"
    trackback:ping="http://blog.ianbicking.org/2010/04/21/silver-lining-more-people/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 04 21</h3>
				<p class="post-categories"><a href="index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../silverlining.1" title="View all posts in Silver Lining" rel="category tag">Silver Lining</a><br/><a href="../web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../index.html?p=224#comments" title="Comment on Silver Lining: More People!">Comments (5)</a></p>
				<p class="post-permalink"><a href="../../index.html?p=224" title="Permalink to Silver Lining: More People!" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-215" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../index.html?p=215" title="Permalink to WebTest HTTP testing" rel="bookmark">WebTest HTTP testing</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;ve yet to see another testing system for local web testing that I like as much as <a class="reference external" href="http://pythonpaste.org/webtest/">WebTest</a>&#8230; which is perhaps personal bias for something I wrote, but then I don&#8217;t have that same bias towards everything I&#8217;ve written.  Many frameworks build in their own testing systems but I don&#8217;t like the abstractions &#8212; they touch lots of internal things, or skip important steps of the request, or mock out things that don&#8217;t need to be mocked out.  WSGI can make this testing easy.</p>
<p>There&#8217;s also a hidden feature here: because WSGI is basically just describing HTTP, it can be a means of representing not just incoming HTTP requests, but also outgoing HTTP requests.  If you are running local tests against your application using WebTest, with just a little tweaking you can turn those tests into HTTP tests (i.e., actually connect to a socket).  But doing this is admittedly not obvious; hence this post!</p>
<p>Here&#8217;s what a basic WebTest test looks like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> webtest <span class="kw1">import</span> TestApp<br />
<span class="kw1">import</span> json<br />
<br />
wsgi_app = acquire_wsgi_application_somehow<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
app = TestApp<span class="br0">&#40;</span>wsgi_app<span class="br0">&#41;</span><br />
<br />
<span class="kw1">def</span> test_login<span class="br0">&#40;</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; resp = app.<span class="me1">post</span><span class="br0">&#40;</span><span class="st0">'/login'</span>, <span class="kw2">dict</span><span class="br0">&#40;</span>username=<span class="st0">'guest'</span>, password=<span class="st0">'guest'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; resp.<span class="me1">mustcontain</span><span class="br0">&#40;</span><span class="st0">'login successful'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; resp = resp.<span class="me1">click</span><span class="br0">&#40;</span><span class="st0">'home'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; resp.<span class="me1">mustcontain</span><span class="br0">&#40;</span><span class="st0">'&lt;a href=&quot;/profile&quot;&gt;guest&lt;/a&gt;'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="co1"># Or with a little framework integration:</span><br />
&nbsp; &nbsp; <span class="kw1">assert</span> resp.<span class="me1">templatevars</span>.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'username'</span><span class="br0">&#41;</span> == <span class="st0">'guest'</span><br />
<br />
<span class="co1"># Or an API test:</span><br />
<span class="kw1">def</span> test_user_query<span class="br0">&#40;</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; resp = app.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'/users.json'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">assert</span> <span class="st0">'guest'</span> <span class="kw1">in</span> resp.<span class="me1">json</span><span class="br0">&#91;</span><span class="st0">'userList'</span><span class="br0">&#93;</span><br />
&nbsp; &nbsp; user_info = <span class="kw2">dict</span><span class="br0">&#40;</span>username=<span class="st0">'guest2'</span>, password=<span class="st0">'guest2'</span>, name=<span class="st0">'Guest'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; resp = app.<span class="me1">post</span><span class="br0">&#40;</span><span class="st0">'/users.json'</span>, content_type=<span class="st0">'application/json'</span>,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; body=json.<span class="me1">dumps</span><span class="br0">&#40;</span>user_info<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">assert</span> resp.<span class="me1">json</span> == user_info<br />
&nbsp;</div>
<p>The <tt class="docutils literal"><span class="pre">app</span></tt> object is a wrapper around the WSGI application, and each of those methods runs a request and gets the response.  The response object is a WebOb response with several additional helpers for testing (things like <tt class="docutils literal"><span class="pre">.click()</span></tt> which finds a link in HTML and follows it, or <tt class="docutils literal"><span class="pre">.json</span></tt> which loads the body as JSON).</p>
<p>You <em>don&#8217;t</em> have to be using a WSGI-centric framework like Pylons to use WebTest, it works fine with anything with a WSGI frontend, which is just about everything.  But the point of my post: you don&#8217;t have to use it with a WSGI application at all.  Using <a class="reference external" href="http://pythonpaste.org/wsgiproxy/">WSGIProxy</a>:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">import</span> <span class="kw3">os</span><br />
<span class="kw1">import</span> <span class="kw3">urlparse</span><br />
<br />
<span class="kw1">if</span> <span class="kw3">os</span>.<span class="me1">environ</span>.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'TEST_REMOTE'</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">from</span> wsgiproxy.<span class="me1">exactproxy</span> <span class="kw1">import</span> proxy_exact_request<br />
&nbsp; &nbsp; wsgi_app = proxy_exact_request<br />
&nbsp; &nbsp; parsed = <span class="kw3">urlparse</span>.<span class="me1">urlsplit</span><span class="br0">&#40;</span><span class="kw3">os</span>.<span class="me1">environ</span><span class="br0">&#91;</span><span class="st0">'TEST_REMOTE'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; app = TestApp<span class="br0">&#40;</span>proxy_exact_request, extra_environ=<span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">'wsgi.scheme'</span>: parsed.<span class="me1">scheme</span>,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">'HTTP_HOST'</span>: parsed.<span class="me1">netloc</span>,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">'SERVER_NAME'</span>: parsed.<span class="me1">netloc</span><span class="br0">&#125;</span><span class="br0">&#41;</span><br />
<span class="kw1">else</span>:<br />
&nbsp; &nbsp; wsgi_app = acquire_wsgi_application_somehow<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; app = TestApp<span class="br0">&#40;</span>wsgi_app<span class="br0">&#41;</span><br />
&nbsp;</div>
<p>It&#8217;s a little crude to control this with an environmental variable (<tt class="docutils literal"><span class="pre">$TEST_REMOTE</span></tt>), but it&#8217;s an easy way to pass an option in when there&#8217;s no better way (and many test runners don&#8217;t make options easy).  The <tt class="docutils literal"><span class="pre">extra_environ</span></tt> option puts in the host and scheme information into each request (the default host WebTest puts in is <tt class="docutils literal"><span class="pre">http://localhost</span></tt>).  WSGIProxy lets you send a request to any host, kind of bypassing DNS, so <tt class="docutils literal"><span class="pre">SERVER_NAME</span></tt> is actually the server the request goes to, while <tt class="docutils literal"><span class="pre">HTTP_HOST</span></tt> is the value of the Host header.</p>
<p>Going over HTTP there are a couple features that won&#8217;t work.  For instance, you can pass information about your application back to the test code by putting values in <tt class="docutils literal"><span class="pre">environ['paste.testing_variables']</span></tt> (which is how you&#8217;d make <tt class="docutils literal"><span class="pre">resp.templatevars</span></tt> work in the first example).  It&#8217;s also possible to use <tt class="docutils literal"><span class="pre">extra_environ</span></tt> to pass information into your application, for example to get your application to mock out user authentication; this is fairly safe because in production no request can put those same special keys into the environment (using custom HTTP headers means you must carefully filter requests in production).  But custom environ values won&#8217;t work over HTTP.</p>
<p>The thing that got me thinking about this is the work I&#8217;m doing on <a class="reference external" href="http://cloudsilverlining.org">Silver Lining</a>, where I am taking apps and rearranging the code and modifying the database configuration ad setup to fit this deployment system.  It would be really nice having done that to be able to run some functional tests, and I really want to run them over HTTP.  If an application has tests using something like Selenium or Windmill that would also work great, but those tools can be a bit more challenging to work with and applications still need smaller tests anyway, so being able to reuse tests like these would be most useful.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/04/02/webtest-http-testing/"
    dc:identifier="http://blog.ianbicking.org/2010/04/02/webtest-http-testing/"
    dc:title="WebTest HTTP testing"
    trackback:ping="http://blog.ianbicking.org/2010/04/02/webtest-http-testing/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 04 02</h3>
				<p class="post-categories"><a href="../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../index.html?p=215#comments" title="Comment on WebTest HTTP testing">Comments (1)</a></p>
				<p class="post-permalink"><a href="../../index.html?p=215" title="Permalink to WebTest HTTP testing" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-208" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../2010/04/02/more-sentinels/index.html" title="Permalink to More Sentinels" rel="bookmark">More Sentinels</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;ve been casually perusing <a class="reference external" href="http://norvig.com/paip.html">Paradigms of Artificial Intelligence Programming: Case Studies in Common Lisp</a>.  One of the things I am noticing is that Lisp traditionally has a terrible lack of sentinels: special objects denoting some kind of meaning.  Specifically in Common Lisp the empty list and false and nil are all the same thing.  As a result there&#8217;s all these cases where you want to distinguish false from empty, especially when false represents a failure of some sort.  In these AI examples, usually a failure to find something, while in many cases the empty list could mean &quot;the thing is already found, no need to look&quot;.  But there&#8217;s also lots of other examples when this causes problems.</p>
<p>More modern languages usually distinguish between these objects. Python for instance has <tt class="docutils literal"><span class="pre">[]</span></tt>, <tt class="docutils literal"><span class="pre">False</span></tt> and <tt class="docutils literal"><span class="pre">None</span></tt>.  They might all test as &quot;falsish&quot;, but if you care to tell the difference it is easy to do; especially common is a test for <tt class="docutils literal"><span class="pre">x</span> <span class="pre">is</span> <span class="pre">None</span></tt>.  Modern Lisps also stopped folding together all these notions (Scheme for example has <tt class="docutils literal"><span class="pre">#f</span></tt> for false as a completely distinct object, though null and the empty list are still the same).  XML-RPC is an example of a language missing null&#8230; and though JSON is almost the same data model, it is a great deal superior for having null.  In comparison no one seems to care much one way or the other about making a strong distinction between True/False and 1/0.</p>
<p>These are all examples of sentinels: special objects that represent some state.  None doesn&#8217;t <em>mean</em> anything in particular, but it means lots of things specifically.  Maybe it means &quot;not found&quot; in one place, or &quot;give me anything I don&#8217;t care&quot; in another.  But sometimes you need more than one of these in the same place, or None isn&#8217;t entirely clear.</p>
<p>One thing I noticed while reading some Perl 6 examples is that they&#8217;ve added a number of new sentinels.  One is <tt class="docutils literal"><span class="pre">*</span></tt>.  So you could write something like <tt class="docutils literal"><span class="pre">item(*)</span></tt> to mean &quot;give me any item, your choice&quot;. While the Perl tendency to use punctuation is legend, words work too.</p>
<p>I wonder if we need a few more sentinel conventions?  If so what?</p>
<p>Of course any object can become a sentinel if you use it like that, None isn&#8217;t <em>more</em> unique than any other object.  (None <em>is</em> conveniently available everywhere.)</p>
<p><tt class="docutils literal"><span class="pre">Any</span></tt> seems useful, ala Perl&#8217;s <tt class="docutils literal"><span class="pre">*</span></tt>.  But&#8230; there&#8217;s already an <a class="reference external" href="http://docs.python.org/library/functions.html#any">any</a> available everywhere as well.  It happens to be a function, but it&#8217;s also a unique named object&#8230; would it be entirely too weird to do <tt class="docutils literal"><span class="pre">obj</span> <span class="pre">is</span> <span class="pre">any</span></tt>?  And there&#8217;s very few cases where the actual function <tt class="docutils literal"><span class="pre">any</span></tt> would be an appropriate input, making it a good sentinel.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/04/02/more-sentinels/"
    dc:identifier="http://blog.ianbicking.org/2010/04/02/more-sentinels/"
    dc:title="More Sentinels"
    trackback:ping="http://blog.ianbicking.org/2010/04/02/more-sentinels/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 04 02</h3>
				<p class="post-categories"><a href="../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a></p>
				<p class="post-comments"><a href="../../2010/04/02/more-sentinels/index.html#comments" title="Comment on More Sentinels">Comments (19)</a></p>
				<p class="post-permalink"><a href="../../2010/04/02/more-sentinels/index.html" title="Permalink to More Sentinels" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-198" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../2010/03/16/web-server-benchmarking-we-need/index.html" title="Permalink to The Web Server Benchmarking We Need" rel="bookmark">The Web Server Benchmarking We Need</a></h2>
					<div class="post-entry">
						<div class="document">
<p>Another <a class="reference external" href="http://nichol.as/benchmark-of-python-web-servers">WSGI web server benchmark</a> was published.  It&#8217;s a decent benchmark, despite some criticisms.  But it benchmarks what everyone benchmarks: serving up a trivial app really really quickly.  This is not very useful to me.  Also, performance is not to me the most important differentiation of servers.</p>
<p>In <a class="reference external" href="http://cloudsilverlining.org">Silver Lining</a> we&#8217;re using <a class="reference external" href="http://code.google.com/p/modwsgi/">mod_wsgi</a>.  Silver Lining isn&#8217;t tied to mod_wsgi (applications can&#8217;t really tell), and we may revisit that decision (mostly because of memory concerns), but it is a deliberate choice.  mod_wsgi is one of the few multiprocess WSGI servers, and it manages its children (the same way Apache manages all its children).  So if a child stops responding, it gets taken out of the pool and killed (brutal efficiency!  Or at least brutal terminology).  Child processes are also recycled, guarding against memory leaks or other peculiarities.  Sometimes these kinds of things are dismissed for covering up bugs, but (a) production is a lousy time to learn about bugs, (b) it&#8217;s like a third tier of garbage collection, and (c) the bugs you are avoiding are often bugs you can&#8217;t fix anyway (for instance, if your mysql driver leaks memory, is that the application developer&#8217;s fault?)</p>
<p>I wish there was competition among servers not to see who can tweak their performance for entirely unrealistic situations, but to see who can implement the most fail-safe server.  We&#8217;re missing good benchmarks.  Unfortunately benchmarks are a pain in the butt to write and manage.</p>
<p>But I hope someone writes a benchmark like that.  Here&#8217;s some things I&#8217;d like to see benchmarked:</p>
<ul class="simple">
<li>A &quot;realistic&quot; CPU-bound application.  <tt class="docutils literal"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">xrange(10000000):</span> <span class="pre">pass</span></tt> is a reasonable start.</li>
<li>An application that generates big responses, e.g., <tt class="docutils literal"><span class="pre">&quot;x&quot;*100000</span></tt>.</li>
<li>An I/O bound application.  E.g., one that reads a big file.</li>
<li>A simply slow application (<tt class="docutils literal"><span class="pre">time.sleep(1)</span></tt>).</li>
<li>Applications that wedge.  <tt class="docutils literal"><span class="pre">while</span> <span class="pre">1:</span> <span class="pre">pass</span></tt> perhaps?  Or <tt class="docutils literal"><span class="pre">lock</span> <span class="pre">=</span> <span class="pre">threading.Lock();</span> <span class="pre">lock.acquire();</span> <span class="pre">lock.acquire()</span></tt>.  Wedging in C and wedging in Python are different, so a bunch of different kinds of wedging.</li>
<li>Applications that segfault.  ctypes is specially designed for this.</li>
<li>Applications that leak memory like a sieve, e.g., <tt class="docutils literal"><span class="pre">global_var.extend(['x']*10000)</span></tt>.</li>
<li>Large uploads.</li>
<li>Slow uploads, like a client that takes 30 seconds to upload 1Mb.</li>
<li>Also slow downloads.</li>
<li>In each case it is interesting what happens when something bad happens to just a portion of requests.  E.g., if 1% of requests wedge hard.  A good container will serve the other 99% of requests properly.  A bad container will have its worker pool exhausted and completely stop.</li>
<li>Mixing and matching these could be interesting.  For instance Dave Beazley <a class="reference external" href="http://www.dabeaz.com/blog/2010/02/revisiting-thread-priorities-and-new.html">found some bad GIL results mixing I/O and CPU-bound code</a>.</li>
<li>Add ideas in the comments and I&#8217;ll copy them into this list.</li>
</ul>
<p>The hardest part of writing this is not the applications (they are simple).  One annoyance is wiring up the applications, but handily Nicholas covers that well in <a class="reference external" href="http://nichol.as/benchmark-of-python-web-servers">his benchmark</a>.  You also have to make sure to clean up, as many servers will not exit cleanly from some of the tests.  Another nuisance is that some of these require funny clients.  These aren&#8217;t too hard to write, but you can&#8217;t just use <tt class="docutils literal"><span class="pre">ab</span></tt>.  Then you have to report.</p>
<p>Anyway: I would <strong>love it</strong> if someone did this, and packaged it as repeatable/runnable code/scripts.  I&#8217;ll help some, but I can&#8217;t lead.  I&#8217;d both really like to see the results, and in my ideal world people writing servers would start using these benchmarks to make their servers more robust.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/03/16/web-server-benchmarking-we-need/"
    dc:identifier="http://blog.ianbicking.org/2010/03/16/web-server-benchmarking-we-need/"
    dc:title="The Web Server Benchmarking We Need"
    trackback:ping="http://blog.ianbicking.org/2010/03/16/web-server-benchmarking-we-need/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 03 16</h3>
				<p class="post-categories"><a href="../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../silverlining.1" title="View all posts in Silver Lining" rel="category tag">Silver Lining</a><br/><a href="../web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../2010/03/16/web-server-benchmarking-we-need/index.html#comments" title="Comment on The Web Server Benchmarking We Need">Comments (23)</a></p>
				<p class="post-permalink"><a href="../../2010/03/16/web-server-benchmarking-we-need/index.html" title="Permalink to The Web Server Benchmarking We Need" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-192" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../2010/03/12/a-webob-app-example/index.html" title="Permalink to What Does A WebOb App Look Like?" rel="bookmark">What Does A WebOb App Look Like?</a></h2>
					<div class="post-entry">
						<div class="document">
<p>Lately I&#8217;ve been writing code using WebOb and just a few other small libraries.  It&#8217;s not entirely obvious what this looks like, so I thought I&#8217;d give a simple example.</p>
<p>I make each application a class.  Instances of the class are &quot;configured applications&quot;.  So it looks a little like this (for an application that takes one configuration parameter, <tt class="docutils literal"><span class="pre">file_path</span></tt>):</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">class</span> Application<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, file_path<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">file_path</span> = file_path<br />
&nbsp;</div>
<p>Then the app needs to be a WSGI app, because that&#8217;s how I roll.  I use <a class="reference external" href="http://pythonpaste.org/webob/modules/dec.html">webob.dec</a>:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> webob.<span class="me1">dec</span> <span class="kw1">import</span> wsgify<br />
<span class="kw1">from</span> webob <span class="kw1">import</span> exc<br />
<span class="kw1">from</span> webob <span class="kw1">import</span> Response<br />
<br />
<span class="kw1">class</span> Application<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, file_path<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">file_path</span> = file_path<br />
&nbsp; &nbsp; @<span class="co1">wsgify</span><br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> Response<span class="br0">&#40;</span><span class="st0">'Hi!'</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>Somewhere separate from the application you actually instantiate <tt class="docutils literal"><span class="pre">Application</span></tt>.  You can use <a class="reference external" href="http://pythonpaste.org/deploy/">Paste Deploy</a> for that, configure it yourself, or just do something ad hoc (a lot of mod_wsgi <tt class="docutils literal"><span class="pre">.wsgi</span></tt> files are like this, basically).</p>
<p>I use <a class="reference external" href="http://pythonpaste.org/webob/reference.html#exceptions">webob.exc</a> for things like <tt class="docutils literal"><span class="pre">exc.HTTPNotFound()</span></tt>.  You can raise that as an exception, but I mostly just return the object (to the same effect).</p>
<p>Now you have Hello World.  I then sometimes do something terrible, I start handling URLs like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
@<span class="co1">wsgify</span><br />
<span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">if</span> req.<span class="me1">path_info</span> == <span class="st0">'/'</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">self</span>.<span class="me1">index</span><span class="br0">&#40;</span>req<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">elif</span> req.<span class="me1">path_info</span>.<span class="me1">startswith</span><span class="br0">&#40;</span><span class="st0">'/view/'</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">self</span>.<span class="me1">view</span><span class="br0">&#40;</span>req<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPNotFound</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>This is lazy and a very bad idea.  So you want a dispatcher.  There are several (e.g., <a class="reference external" href="http://pypi.python.org/pypi/selector/">selector</a>).  I&#8217;ll use <a class="reference external" href="http://routes.groovie.org">Routes</a> here&#8230; the latest release makes it a bit easier (though it could still be streamlined a bit).  Here&#8217;s a pattern I think makes sense:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> routes <span class="kw1">import</span> Mapper<br />
<br />
<span class="kw1">class</span> Application<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw2">map</span> = Mapper<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'index'</span>, <span class="st0">'/'</span>, method=<span class="st0">'index'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'view'</span>, <span class="st0">'/view/{item}'</span>, method=<span class="st0">'view'</span><span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, file_path<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">file_path</span> = file_path<br />
<br />
&nbsp; &nbsp; @<span class="co1">wsgify</span><br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; results = <span class="kw2">self</span>.<span class="kw2">map</span>.<span class="me1">routematch</span><span class="br0">&#40;</span>environ=req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw1">not</span> results:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPNotFound</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; match, route = results<br />
&nbsp; &nbsp; &nbsp; &nbsp; link = URLGenerator<span class="br0">&#40;</span><span class="kw2">self</span>.<span class="kw2">map</span>, req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; req.<span class="me1">urlvars</span> = <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, match<span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; kwargs = match.<span class="kw3">copy</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; method = kwargs.<span class="me1">pop</span><span class="br0">&#40;</span><span class="st0">'method'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; req.<span class="me1">link</span> = link<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">getattr</span><span class="br0">&#40;</span><span class="kw2">self</span>, method<span class="br0">&#41;</span><span class="br0">&#40;</span>req, **kwargs<span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> index<span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
&nbsp; &nbsp; <span class="kw1">def</span> view<span class="br0">&#40;</span><span class="kw2">self</span>, req, item<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
&nbsp;</div>
<p>Another way you might do it is to skip the class, which means skipping a clear place for configuration.  I don&#8217;t like that, but if you don&#8217;t care about that, then it looks like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">def</span> index<span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; ...<br />
<span class="kw1">def</span> view<span class="br0">&#40;</span><span class="kw2">self</span>, req, item<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; ...<br />
<br />
<span class="kw2">map</span> = Mapper<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
<span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'index'</span>, <span class="st0">'/'</span>, view=index<span class="br0">&#41;</span><br />
<span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'view'</span>, <span class="st0">'/view/{item}'</span>, view=view<span class="br0">&#41;</span><br />
<br />
@<span class="co1">wsgify</span><br />
<span class="kw1">def</span> application<span class="br0">&#40;</span>req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; results = <span class="kw2">map</span>.<span class="me1">routematch</span><span class="br0">&#40;</span>environ=req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">if</span> <span class="kw1">not</span> results:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPNotFound</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; match, route = results<br />
&nbsp; &nbsp; link = URLGenerator<span class="br0">&#40;</span><span class="kw2">map</span>, req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; req.<span class="me1">urlvars</span> = <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, match<span class="br0">&#41;</span><br />
&nbsp; &nbsp; kwargs = match.<span class="kw3">copy</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; view = kwargs.<span class="me1">pop</span><span class="br0">&#40;</span><span class="st0">'view'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; req.<span class="me1">link</span> = link<br />
&nbsp; &nbsp; <span class="kw1">return</span> view<span class="br0">&#40;</span>req, **kwargs<span class="br0">&#41;</span><br />
&nbsp;</div>
<p>Then <tt class="docutils literal"><span class="pre">application</span></tt> is pretty much boilerplate.  You could put configuration in the request if you wanted, or use some other technique (like <a class="reference external" href="http://pypi.python.org/pypi/Contextual">Contextual</a>).</p>
<p>I talked some with <a class="reference external" href="http://be.groovie.org/">Ben Bangert</a> about what he&#8217;s trying with these patterns, and he&#8217;s doing something reminiscent of Pylons controllers (but without the rest of Pylons) and it looks more like this (with my own adaptations):</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">class</span> BaseController<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; special_vars = <span class="br0">&#91;</span><span class="st0">'controller'</span>, <span class="st0">'action'</span><span class="br0">&#93;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, request, link, **config<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">request</span> = request<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">link</span> = link<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">for</span> name, value <span class="kw1">in</span> config.<span class="me1">items</span><span class="br0">&#40;</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">setattr</span><span class="br0">&#40;</span><span class="kw2">self</span>, name, value<span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; action = <span class="kw2">self</span>.<span class="me1">request</span>.<span class="me1">urlvars</span>.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'action'</span>, <span class="st0">'index'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw2">hasattr</span><span class="br0">&#40;</span><span class="kw2">self</span>, <span class="st0">'__before__'</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.__before__<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; kwargs = req.<span class="me1">urlsvars</span>.<span class="kw3">copy</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">for</span> attr <span class="kw1">in</span> <span class="kw2">self</span>.<span class="me1">special_vars</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> attr <span class="kw1">in</span> kwargs:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">del</span> kwargs<span class="br0">&#91;</span>attr<span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">getattr</span><span class="br0">&#40;</span><span class="kw2">self</span>, action<span class="br0">&#41;</span><span class="br0">&#40;</span>**kwargs<span class="br0">&#41;</span><br />
<br />
<span class="kw1">class</span> Index<span class="br0">&#40;</span>BaseController<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">def</span> index<span class="br0">&#40;</span><span class="kw2">self</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
&nbsp; &nbsp; <span class="kw1">def</span> view<span class="br0">&#40;</span><span class="kw2">self</span>, item<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
<br />
<span class="kw1">class</span> Application<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw2">map</span> = Mapper<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'index'</span>, <span class="st0">'/'</span>, controller=Index<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'view'</span>, <span class="st0">'/view/{item}'</span>, controller=Index, &nbsp; &nbsp; action=<span class="st0">'view'</span><span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, **config<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">config</span> = config<br />
<br />
&nbsp; &nbsp; @<span class="co1">wsgify</span><br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; results = <span class="kw2">self</span>.<span class="kw2">map</span>.<span class="me1">routematch</span><span class="br0">&#40;</span>environ=req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw1">not</span> results:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPNotFound</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; match, route = results<br />
&nbsp; &nbsp; &nbsp; &nbsp; link = URLGenerator<span class="br0">&#40;</span><span class="kw2">self</span>.<span class="kw2">map</span>, req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; req.<span class="me1">urlvars</span> = <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, match<span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; controller = match<span class="br0">&#91;</span><span class="st0">'controller'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>req, link, **<span class="kw2">self</span>.<span class="me1">config</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> controller<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>That&#8217;s a lot of code blocks, but they all really say the same thing ;)  I think writing apps with almost-no-framework like this is pretty doable, so if you have something small you should give it a go.  I think it&#8217;s especially appropriate for applications that are an API (not a &quot;web site&quot;).</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/"
    dc:identifier="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/"
    dc:title="What Does A WebOb App Look Like?"
    trackback:ping="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 03 12</h3>
				<p class="post-categories"><a href="../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="../web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="../../2010/03/12/a-webob-app-example/index.html#comments" title="Comment on What Does A WebOb App Look Like?">Comments (30)</a></p>
				<p class="post-permalink"><a href="../../2010/03/12/a-webob-app-example/index.html" title="Permalink to What Does A WebOb App Look Like?" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

				
		<div id="post-185" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="../../2010/03/10/joining-mozilla/index.html" title="Permalink to Joining Mozilla" rel="bookmark">Joining Mozilla</a></h2>
					<div class="post-entry">
						<div class="document">
<p>As of last week, I am now an employee of Mozilla!  Thanks to everyone who helped me out during my job search.</p>
<p>I&#8217;ll be working both with the Mozilla <a class="reference external" href="http://blog.mozilla.com/webdev/">Web Development (webdev)</a> team, and <a class="reference external" href="https://mozillalabs.com/">Mozilla Labs</a>.</p>
<p>The first thing I&#8217;ll be working on is deployment.  In part because I&#8217;ve been <a class="reference external" href="../silverlining.1">thinking about deployment lately</a>, in part because streamlining deployment is just generally enabling of other work (and a personal itch to be scratched), and because I think there is the possibility to fit this work into Mozilla&#8217;s <a class="reference external" href="http://www.mozilla.org/causes/">general mission</a>, specifically <em>Empowering people to do new and unanticipated things on the web</em>.  I think the way I&#8217;m approaching deployment has real potential to combine the discipline and benefits of good development practices with an accessible process that is more <em>democratic</em> and less <em>professionalized</em>.  This is some of what <a class="reference external" href="../../index.html?p=38">PHP has provided</a> over the years (and I think it&#8217;s been a genuinely positive influence on the web as a result); I&#8217;d like to see the same kind of easy entry using other platforms.  I&#8217;m hoping <a class="reference external" href="http://cloudsilverlining.org">Silver Lining</a> will fit both Mozilla&#8217;s application deployment needs, as well as serving a general purpose.</p>
<p>Once I <em>finish</em> deployment and can move on (oh fuck what am I getting myself into) I&#8217;ll also be working with the <a class="reference external" href="http://blog.mozilla.com/webdev">web development group</a> who has adopted Python for many of their new projects (e.g., <a class="reference external" href="http://github.com/jbalogh/zamboni">Zamboni</a>, a rewrite of the <a class="reference external" href="https://addons.mozilla.org/">addons.mozilla.org</a> site), and with Mozilla Labs on <a class="reference external" href="http://mozillalabs.com/weave/">Weave</a> or some of their other projects.</p>
<p>In addition my own <a class="reference external" href="http://ianbicking.appspot.com/projects">Python open source work</a> is in line with Mozilla&#8217;s mission and I will be able to continue spending time on those projects, as well as entirely new projects.</p>
<p>I&#8217;m pretty excited about this &#8212; it feels like there&#8217;s a really good match with Mozilla and what I&#8217;m good at, and what I care about, and <em>how</em> I care about it.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/03/10/joining-mozilla/"
    dc:identifier="http://blog.ianbicking.org/2010/03/10/joining-mozilla/"
    dc:title="Joining Mozilla"
    trackback:ping="http://blog.ianbicking.org/2010/03/10/joining-mozilla/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 03 10</h3>
				<p class="post-categories"><a href="../mozilla/index.html" title="View all posts in Mozilla" rel="category tag">Mozilla</a><br/><a href="../notech/index.html" title="View all posts in Non-technical" rel="category tag">Non-technical</a><br/><a href="../programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="index.html" title="View all posts in Python" rel="category tag">Python</a></p>
				<p class="post-comments"><a href="../../2010/03/10/joining-mozilla/index.html#comments" title="Comment on Joining Mozilla">Comments (32)</a></p>
				<p class="post-permalink"><a href="../../2010/03/10/joining-mozilla/index.html" title="Permalink to Joining Mozilla" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div class="navigation">
			<div class="alignleft"><a href="page/2/index.html" >&laquo; Older posts</a></div>
			<div class="alignright"></div>
		</div><!-- END NAVIGATION -->


	</div><!-- END CONTENT -->
</div><!-- END CONTAINER  -->

<div id="sidebar">
	<ul>
		<li id="home-link">
			<h2><a href="../../index.html" title="Ian Bicking: a blog">Home</a></h2>
		</li>
<li id="text-315934862" class="widget widget_text"><h2 class="widgettitle">About</h2>
			<div class="textwidget">Ian is a developer with Mozilla, <a href="http://ianbicking.appspot.com/projects">Python open source developer</a>, actually uses <a href="https://plus.google.com/u/0/104537541227697934010/posts">Google+</a> more than <a href="http://twitter.com/ianbicking">twitter</a> and lives in Minneapolis.<br>
<span class="gittip-0001" gittip-username="ianbicking"></span>
<script id="gittip-0001"
  src="https://www.gittip.com/assets/widgets/0001.js"></script>
</div>
		</li>
<li id="text-315934863" class="widget widget_text">			<div class="textwidget"><!-- <script type="text/javascript">mbgc='f5f5f5';ww='160';mbc='cecece';bbc='3F79D5';bmobc='3b71c6';bbgc='4889F0';bmoc='3F79D5';bfc='FFFFFF';bmofc='ffffff';tlc='cecece';tc='6a6a6a';nc='6a6a6a';bc='6a6a6a';l='y';fs='16';fsb='13';bw='100';ff='4';lu='6a6a6a';pc='4889F0';wh='340';b='s'; pid='104537541227697934010';</script><script type="text/javascript" src="http://widgetsplus.com/google_plus_widget.js"></script> --></div>
		</li>
<li id="archives-2" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
		<ul>
			<li><a href='../../2012/10/index.html' title='October 2012'>October 2012</a></li>
	<li><a href='../../2012/02/index.html' title='February 2012'>February 2012</a></li>
	<li><a href='../../2011/04/index.html' title='April 2011'>April 2011</a></li>
	<li><a href='../../2011/03/index.html' title='March 2011'>March 2011</a></li>
	<li><a href='../../2010/09/index.html' title='September 2010'>September 2010</a></li>
	<li><a href='../../2010/08/index.html' title='August 2010'>August 2010</a></li>
	<li><a href='../../2010/05/index.html' title='May 2010'>May 2010</a></li>
	<li><a href='../../2010/04/index.html' title='April 2010'>April 2010</a></li>
	<li><a href='../../2010/03/index.html' title='March 2010'>March 2010</a></li>
	<li><a href='../../2010/02/index.html' title='February 2010'>February 2010</a></li>
	<li><a href='../../2010/01/index.html' title='January 2010'>January 2010</a></li>
	<li><a href='../../2009/09/index.html' title='September 2009'>September 2009</a></li>
	<li><a href='../../2009/05/index.html' title='May 2009'>May 2009</a></li>
	<li><a href='../../2009/04/index.html' title='April 2009'>April 2009</a></li>
	<li><a href='../../2009/01/index.html' title='January 2009'>January 2009</a></li>
	<li><a href='../../2008/12/index.html' title='December 2008'>December 2008</a></li>
	<li><a href='../../2008/11/index.html' title='November 2008'>November 2008</a></li>
	<li><a href='../../2008/10/index.html' title='October 2008'>October 2008</a></li>
	<li><a href='../../2008/09/index.html' title='September 2008'>September 2008</a></li>
	<li><a href='../../2008/08/index.html' title='August 2008'>August 2008</a></li>
	<li><a href='../../2008/07/index.html' title='July 2008'>July 2008</a></li>
	<li><a href='../../2008/06/index.html' title='June 2008'>June 2008</a></li>
	<li><a href='../../2008/05/index.html' title='May 2008'>May 2008</a></li>
	<li><a href='../../2008/04/index.html' title='April 2008'>April 2008</a></li>
	<li><a href='../../2008/03/index.html' title='March 2008'>March 2008</a></li>
	<li><a href='../../2008/02/index.html' title='February 2008'>February 2008</a></li>
	<li><a href='../../2008/01/index.html' title='January 2008'>January 2008</a></li>
	<li><a href='../../2007/11/index.html' title='November 2007'>November 2007</a></li>
	<li><a href='../../2007/10/index.html' title='October 2007'>October 2007</a></li>
	<li><a href='../../2007/09/index.html' title='September 2007'>September 2007</a></li>
	<li><a href='../../2007/08/index.html' title='August 2007'>August 2007</a></li>
	<li><a href='../../2007/07/index.html' title='July 2007'>July 2007</a></li>
		</ul>
</li>
<li id="text-315934861" class="widget widget_text">			<div class="textwidget"><a href="../../archive/index.html">The Older Archives</a></div>
		</li>
<li id="categories-1" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-12"><a href="../erlang/index.html" title="View all posts filed under Erlang">Erlang</a>
</li>
	<li class="cat-item cat-item-11"><a href="../html/index.html" title="View all posts filed under HTML">HTML</a>
</li>
	<li class="cat-item cat-item-8"><a href="../javascript/index.html" title="View all posts filed under Javascript">Javascript</a>
</li>
	<li class="cat-item cat-item-15"><a href="../licensing/index.html" title="View all posts filed under Licensing">Licensing</a>
</li>
	<li class="cat-item cat-item-18"><a href="../mozilla/index.html" title="View all posts filed under Mozilla">Mozilla</a>
</li>
	<li class="cat-item cat-item-5"><a href="../notech/index.html" title="View all posts filed under Non-technical">Non-technical</a>
</li>
	<li class="cat-item cat-item-6"><a href="../olpc/index.html" title="View all posts filed under OLPC">OLPC</a>
</li>
	<li class="cat-item cat-item-14"><a href="../packaging/index.html" title="View all posts filed under Packaging">Packaging</a>
</li>
	<li class="cat-item cat-item-4"><a href="../politics/index.html" title="View all posts filed under Politics">Politics</a>
</li>
	<li class="cat-item cat-item-3"><a href="../programming/index.html" title="View all posts filed under Programming">Programming</a>
</li>
	<li class="cat-item cat-item-7 current-cat"><a href="index.html" title="View all posts filed under Python">Python</a>
</li>
	<li class="cat-item cat-item-10"><a href="../ruby/index.html" title="View all posts filed under Ruby">Ruby</a>
</li>
	<li class="cat-item cat-item-19"><a href="../security/index.html" title="View all posts filed under Security">Security</a>
</li>
	<li class="cat-item cat-item-16"><a href="../silverlining.1" title="View all posts filed under Silver Lining">Silver Lining</a>
</li>
	<li class="cat-item cat-item-20"><a href="../programming/testing/index.html" title="View all posts filed under Testing">Testing</a>
</li>
	<li class="cat-item cat-item-9"><a href="../web/index.html" title="View all posts filed under Web">Web</a>
</li>
	<li class="cat-item cat-item-13"><a href="../zopeplone/index.html" title="View all posts filed under Zope/Plone">Zope/Plone</a>
</li>
		</ul>
</li>
<li id="search-2" class="widget widget_search"><form id="searchform" method="get" action="../../index.html">
	<div>
		<input id="s" name="s" type="text" value="" tabindex="1" size="10" />
		<input id="searchsubmit" name="searchsubmit" type="submit" value="Find" tabindex="2" />
	</div>
</form> </li>
		<li id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widgettitle">Recent Posts</h2>
		<ul>
				<li><a href="../../index.html?p=291" title="Why doctest.js is better than Python&#8217;s doctest">Why doctest.js is better than Python&#8217;s doctest</a></li>
				<li><a href="../../index.html?p=283" title="Python Application Package">Python Application Package</a></li>
				<li><a href="../../index.html?p=277" title="Git-as-sync, not source-control-as-deployment">Git-as-sync, not source-control-as-deployment</a></li>
				<li><a href="../../index.html?p=253" title="My Unsolicited Advice For PyPy">My Unsolicited Advice For PyPy</a></li>
				<li><a href="../../index.html?p=250" title="A Python Web Application Package and Format (we should make one)">A Python Web Application Package and Format (we should make one)</a></li>
				</ul>
		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">Recent Comments</h2>
<ul id="recentcomments"><li class="recentcomments"><a href='http://www.mirsa.com.tr' rel='external nofollow' class='url'>havalandırma</a> on <a href="../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-228633">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments"><a href='http://redealmeidense.com.br/portalx/modules/' rel='external nofollow' class='url'>this website</a> on <a href="../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-196267">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments">Eric Pierce on <a href="../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195322">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments">Paul Brian on <a href="../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195321">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments"><a href='http://benjiyork.com' rel='external nofollow' class='url'>Benji York</a> on <a href="../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195320">Why doctest.js is better than Python&#8217;s doctest</a></li></ul></li>
	</ul>
</div>

	<div id="footer">
		<p>
			&copy; 2013 Ian<!--
Does this commenting make me evil?
			|
			Thanks, <a href="http://wordpress.org/" title="WordPress">WordPress</a>
			|
			<a href="http://www.plaintxt.org/themes/barthelme/" title="Barthelme for WordPress" rel="follow">Barthelme</a> theme by <a href="http://scottwallick.com/" title="scottwallick.com" rel="follow">Scott</a>
			| <!-- The following is a link to the theme author's sponsor. Please consider its smallness and that Scott was nice enough to make this theme publically available. -->
			Sponsor: <a href="http://www.active-sandals.com/womreefsan.html" title="Support: Reef Sandals">Reef Sandals</a>
			|
			Valid <a href="http://validator.w3.org/check?uri=http://blog.ianbicking.org&amp;outline=1&amp;verbose=1" title="Valid XHTML 1.0 Strict" rel="nofollow">XHTML</a> &amp; <a href="http://jigsaw.w3.org/css-validator/validator?uri=http://blog.ianbicking.org/wp-content/themes/Barthelme-ianb/style.css&amp;profile=css2&amp;warning=no" title="Valid CSS" rel="nofollow">CSS</a>
			|
			-->
			RSS: <a href="../../feed/rss/index.html" title="Ian Bicking: a blog RSS 2.0 (XML) Feed" rel="alternate" type="application/rss+xml">Posts</a> &amp; <a href="../../comments/feed/index.html" title="Ian Bicking: a blog Comments RSS 2.0 (XML) Feed" rel="alternate" type="application/rss+xml">Comments</a>
		</p>
	</div>

</div><!-- END WRAPPER -->

	<!-- Somehow 41 queries occured in 1.457 seconds. Magic! -->
	<!-- The "Barthelme" theme copyright (c) 2006 Scott Allan Wallick - http://www.plaintxt.org/themes/ -->
	
<!-- Google Analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2442258-1";
urchinTracker();
</script>

</body>
</html>