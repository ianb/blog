<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title>py.test</title>
<link rel="stylesheet" href="WK/default.css" type="text/css">
<link rel="alternate" type="application/rss+xml" title="New Posts" href="http://blog.ianbicking.org/feeds/new_pages.xml">

<link rel="openid.server" href="http://www.myopenid.com/server" />
<link rel="openid.delegate" href="http://ianb.myopenid.com" />

</head>
<body color="black" bgcolor="white">
<h1 id="header"><a href="index.html">Ian Bicking: the old part of his blog</a></h1>

<div style="float: right">

<script type="text/javascript">google_ad_client = "pub-2913402032659646";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text";
google_ad_channel ="";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "008000";
//--></script>

 <script src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</div><h1>py.test</h1>
 <p>

I came upon <a href="http://codespeak.net/py/current/doc/test.html">py.test</a> a
while ago, via <a href="http://weblog.hotales.org/view/python/2004/08/07/0">Jarno
Virtanen</a> (though <tt>py</tt> was named <tt>std</tt> back then).
I've <a href="http://blog.colorstudy.com/ianb/weblog/2003/10/10.html#P11">always
disliked</a> <a href="http://python.org/doc/current/lib/module-unittest.html">unittest</a>.
I created an alternate test runner based on unittest -- <a href="http://formencode.org/docs/DataTest/README.html">DataTest</a> -
but never felt great about it.  OK, but not great.

<p>

Anyway, py.test has a philosophy that appeals to me: the best API is
no API.  And for the most part that's it.  You can read some more
about the hooks and functions in the <a href="http://codespeak.net/py/current/doc/test.html">documentation</a>,
but you don't need them to do your work.  All you need to do is create
a module <code>test_*.py</code>, and define a function that starts
with <code>test_</code>.  py.test will automatically run it, and any
other test-looking functions it finds, and report on any errors.  This
isn't complicated, but I still have no idea how to do it with
unittest, and it's not for lack of trying.  (OK, I knew how to do it,
but it never felt right and now I've forgotten, which means it never
made sense to me either.)  So a test might look like:

<pre>
import roman

def test_sanity():
    for i in range(1, 4000):
        assert roman.fromRoman(roman.toRoman(i)) == i
</pre>

<p>

You can structure your tests as classes as well, and do startup and
teardown methods and functions, but you don't have to.  And you can
just use <code>assert</code>, as it has fancy tracebacks; when an
assert fails it (re) evaluates every subexpression and displays them
all, so you'll see all the values you are interested in.

<p>

It has a number of other features as well.  Probably the one I'm most
interested in is <i>it's still under development</i>.  Unittest was a
port of a Java project (which was a port of a Smalltalk project), and
it just kind of appeared.  It's never fit into Python well.  For
something so important, there needs to be a real feedback cycle, and
continued development in response to people's needs.  Testing should
be easy, and this is the first testing framework that's really
as easy as I think it should be.  Well, <a href="http://python.org/doc/current/lib/module-doctest.html">doctest</a>
is also very easy and cool; py.test makes all unit testing feel like doctest.

<p>

In other doctest news, <a href="http://dirtsimple.org/2004/11/stream-of-consciousness-testing.html">Phillip
writes about doctest</a>, and I notice there's some features in <a href="http://www.python.org/dev/doc/devel/whatsnew/node13.html#SECTION0001320000000000000000">doctest
in 2.4</a> that I had <a href="http://blog.colorstudy.com/ianb/weblog/2004/08/08.html#P144">wanted</a>.
 <div class="dates" align="right">
Created 19 Nov '04<br>
Modified 14 Dec '04</div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2442258-1";
urchinTracker();
</script></body>
</html>
