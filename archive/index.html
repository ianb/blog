<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- MOBIFY - DO NOT ALTER - PASTE IMMEDIATELY AFTER OPENING HEAD TAG -->
<script type="text/javascript">/*<![CDATA[*/(function(a){function b(a,b){if(+a)return~a||(d.cookie=h+"=; path=/");j=d.createElement(e),k=d.getElementsByTagName(e)[0],j.src=a,b&&(j.onload=j.onerror=b),k.parentNode.insertBefore(j,k)}function c(){n.api||b(l.shift()||-1,c)}if(this.Mobify)return;var d=document,e="script",f="mobify",g="."+f+".com/",h=f+"-path",i=g+"un"+f+".js",j,k,l=[!1,1],m,n=this.Mobify={points:[+(new Date)],tagVersion:[6,0]},o=/(; |#|&|^)mobify-path=([^&;]*)/g.exec(location.hash+"; "+d.cookie);o?(m=o[2])&&!+(m=sessionStorage[h]||m)&&(l=[!0,"//preview"+g+escape(m)]):(l=a()||l,l[0]&&l.push("//cdn"+i,"//files01"+i)),l.shift()?(d.write('<plaintext style="display:none;">'),setTimeout(c)):b(l[0])})(function(){if(/ip(hone|od)|android.*(mobile)|blackberry.*applewebkit/i.test(navigator.userAgent)){return[1,"//cdn.mobify.com/sites/ians-blog/production/mobify.js"]}})/*]]>*/</script>
<!-- END MOBIFY -->
	<title>Ian Bicking: a blog </title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="generator" content="WordPress 3.4.2" /><!-- LEAVE FOR STATS -->
	<meta name="description" content="" />
	<link rel="stylesheet" title="plaintxtSimpler" href="wp-content/themes/Barthelme-ianb/style.css" type="text/css" media="all" />
	<link rel="start" href="index.html" title="Ian Bicking: a blog" />
	<link rel="alternate" type="application/atom+xml" title="Ian Bicking: a blog Atom Feed" href="feed/atom/index.html" />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog RSS 2.0 Feed" href="feed/rss/index.html" />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog Comments RSS 2.0 Feed" href="comments/feed/index.html" />
	<link rel="alternate" type="application/rdf+xml" title="Ian Bicking: a blog RSS 1.0" href="feed/rdf/index.html" />
	<link rel="alternate" type="text/xml" title="Ian Bicking: a blog RSS 0.92 Feed" href="feed/rss/index.html" />
	<link rel="pingback" href="xmlrpc.php" />
	<link rel="openid.server" href="http://www.myopenid.com/server" />
	<link rel="openid.delegate" href="http://ianb.myopenid.com" />
        <link rel="me" type="text/html" href="http://www.google.com/profiles/ianbicking"/>
		<link rel='archives' title='October 2012' href='2012/10/index.html' />
	<link rel='archives' title='February 2012' href='2012/02/index.html' />
	<link rel='archives' title='April 2011' href='2011/04/index.html' />
	<link rel='archives' title='March 2011' href='2011/03/index.html' />
	<link rel='archives' title='September 2010' href='2010/09/index.html' />
	<link rel='archives' title='August 2010' href='2010/08/index.html' />
	<link rel='archives' title='May 2010' href='2010/05/index.html' />
	<link rel='archives' title='April 2010' href='2010/04/index.html' />
	<link rel='archives' title='March 2010' href='2010/03/index.html' />
	<link rel='archives' title='February 2010' href='2010/02/index.html' />
	<link rel='archives' title='January 2010' href='2010/01/index.html' />
	<link rel='archives' title='September 2009' href='2009/09/index.html' />
	<link rel='archives' title='May 2009' href='2009/05/index.html' />
	<link rel='archives' title='April 2009' href='2009/04/index.html' />
	<link rel='archives' title='January 2009' href='2009/01/index.html' />
	<link rel='archives' title='December 2008' href='2008/12/index.html' />
	<link rel='archives' title='November 2008' href='2008/11/index.html' />
	<link rel='archives' title='October 2008' href='2008/10/index.html' />
	<link rel='archives' title='September 2008' href='2008/09/index.html' />
	<link rel='archives' title='August 2008' href='2008/08/index.html' />
	<link rel='archives' title='July 2008' href='2008/07/index.html' />
	<link rel='archives' title='June 2008' href='2008/06/index.html' />
	<link rel='archives' title='May 2008' href='2008/05/index.html' />
	<link rel='archives' title='April 2008' href='2008/04/index.html' />
	<link rel='archives' title='March 2008' href='2008/03/index.html' />
	<link rel='archives' title='February 2008' href='2008/02/index.html' />
	<link rel='archives' title='January 2008' href='2008/01/index.html' />
	<link rel='archives' title='November 2007' href='2007/11/index.html' />
	<link rel='archives' title='October 2007' href='2007/10/index.html' />
	<link rel='archives' title='September 2007' href='2007/09/index.html' />
	<link rel='archives' title='August 2007' href='2007/08/index.html' />
	<link rel='archives' title='July 2007' href='2007/07/index.html' />
	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 3.4.2" />
<link rel="stylesheet" href="wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"  type="text/css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
        <style type="text/css" media="all">
/*<![CDATA[*/
body { font-size: 100%; }
body { font-family: tahoma, geneva, sans-serif; }
div.post-header, h2.post-title, p.post-date-single, h2.post-title-single, div.post-entry h1, div.post-entry h2, div.post-entry h3, div.post-entry h4, div.post-entry h5, div.post-entry h6, div.post-entry blockquote, div.post-footer, h3#comment-count, h4#comment-header, div#comments ol li p.comment-metadata, h4#respond { font-family: verdana, geneva, sans-serif; }
div.post-entry p { text-align: left; }
div#wrapper { width: 100%; }

/*]]>*/
</style>
</head>
<body>

<div id="wrapper">

	<div id="header" onclick="location.href='http://blog.ianbicking.org/';" style="cursor:pointer;">
		<h1 id="title"><a href="index.html" title="Ian Bicking: a blog">Ian Bicking: a blog</a></h1>
		<p id="description"></p>
	</div>
<!-- WP Theme Credits -->
<div style="display: none;">We can answer on question <a href="http://www.olnevhost.net/vps-hosting.html">what is VPS</a>? and
what is <a href="http://www.olnevhost.net/dedicated-servers.html"><strong>cheap dedicated servers</strong></a>?</div>
<!-- END HEADER -->
<div id="container">
	<div id="content" class="narrowcolumn">


		<div id="post-291" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=291" title="Permalink to Why doctest.js is better than Python&#8217;s doctest" rel="bookmark">Why doctest.js is better than Python&#8217;s doctest</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;ve been trying, not too successfully I&#8217;m afraid, to get more people to use <a class="reference external" href="http://doctestjs.org">doctest.js</a>.  There&#8217;s probably a few reasons people don&#8217;t.  They are all wrong!  Doctest.js is the best!</p>
<p>One issue in particular is that people (especially people in my Python-biased circles) are perhaps thrown off by Python&#8217;s doctest.  I think Python&#8217;s doctest is pretty nice, I enjoy testing with it, but there&#8217;s no question that it has a lot of problems.  I&#8217;ve even thought about trying to fix doctest, and even made a repository, but I only really got as far as <a class="reference external" href="https://github.com/ianb/doctest2/issues?direction=desc&amp;#038;sort=created&amp;#038;state=open">creating a list of issues I&#8217;d like to fix</a>. But, like so many before me, I never actually <em>made</em> those fixes. Doctest has, in its life, only really had a single period of improvement (in the time leading to Python 2.4).  That&#8217;s not a recipe for success.</p>
<p>Of course doctest.js takes inspiration from Python&#8217;s doctest, but I wrote it as a real test environment, not for a minimal use case.  In the process I fixed a bunch of issues with doctest, and in places Javascript has also provided helpful usability.</p>
<p>Some issues:</p>
<div class="section" id="doctest-js-output-is-predictable">
<h2>Doctest.js output is predictable</h2>
<p>The classic pitfall of Python&#8217;s doctest is printing a dictionary:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&gt;&gt;&gt; <span class="kw1">print</span> <span class="br0">&#123;</span><span class="st0">&quot;one&quot;</span>: <span class="nu0">1</span>, <span class="st0">&quot;two&quot;</span>: <span class="nu0">2</span><span class="br0">&#125;</span><br />
<span class="br0">&#123;</span><span class="st0">'two'</span>: <span class="nu0">2</span>, <span class="st0">'one'</span>: <span class="nu0">1</span><span class="br0">&#125;</span><br />
&nbsp;</div>
<p>The print order of a dictionary is arbitrary, based on a hash algorithm that can change, or mix things up as items are added or removed.  And to make it worse, the output <em>usually</em> stable, such that you can write tests that unexpectibly fragile.  But there&#8217;s no reason why <tt class="docutils literal"><span class="pre">dict.__repr__</span></tt> <em>must</em> use an arbitrary order.  Personally I take it as a bit of unfortunate laziness.</p>
<p>If doctest had used <tt class="docutils literal"><span class="pre">pprint</span></tt> for all of its printing it would have helped some.  But not enough, because this kind of code is fairly common:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">def</span> <span class="kw4">__repr__</span><span class="br0">&#40;</span><span class="kw2">self</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">'&lt;ThisClass attr=%r&gt;'</span> % <span class="kw2">self</span>.<span class="me1">attr</span><br />
&nbsp;</div>
<p>and that <tt class="docutils literal"><span class="pre">%r</span></tt> invokes a <tt class="docutils literal"><span class="pre">repr()</span></tt> that cannot be overridden.</p>
<p>In doctest.js I always try to make output predictable.  One reason this is fairly easy is that there&#8217;s nothing like <tt class="docutils literal"><span class="pre">repr()</span></tt> in Javascript, so doctest.js has its own implementation.  It&#8217;s like I started with pprint and no other notion existed.</p>
</div>
<div class="section" id="good-matching">
<h2>Good matching</h2>
<p>In addition to unpredictable output, there&#8217;s also just hard-to-match output.  Output might contain blank lines, for instance, and Python&#8217;s doctest requires a very ugly <tt class="docutils literal"><span class="pre">&lt;BLANKLINE&gt;</span></tt> token to handle that. Whitespace might not be normalized.  Maybe there&#8217;s boring output. Maybe there&#8217;s just a volatile item like a timestamp.</p>
<p>Doctest.js includes, by default, ellipsis: <tt class="docutils literal"><span class="pre">...</span></tt> matches any length of text.  But it also includes another wildcard, <tt class="docutils literal"><span class="pre">?</span></tt>, which matches just one number or word.  This avoids cases when the use of <tt class="docutils literal"><span class="pre">...</span></tt> swallows up too much when you just wanted to get a single word.</p>
<p>Also doctest.js doesn&#8217;t use <tt class="docutils literal"><span class="pre">...</span></tt> for other purposes.  In Python&#8217;s doctest <tt class="docutils literal"><span class="pre">...`</span></tt> is used for continuation lines, meaning you can&#8217;t just ignore output, like:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&gt;&gt;&gt; <span class="kw1">print</span> who_knows_what_this_returns<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
...<br />
&nbsp;</div>
<p>Or even worse, you can&#8217;t ignore the beginning of an item:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
&gt;&gt;&gt; <span class="kw1">print</span> some_request<br />
...<br />
<span class="me1">X</span>-Some-Header: foo<br />
...<br />
&nbsp;</div>
<p>The way I prefer to use doctest.js it doesn&#8217;t have <em>any</em> continuation line symbol (but if there is one, it&#8217;s <tt class="docutils literal"><span class="pre">&gt;</span></tt>).</p>
<p>Also doctest.js normalizes whitespace, normalizes <tt class="docutils literal"><span class="pre">&quot;</span></tt> and <tt class="docutils literal"><span class="pre">'</span></tt>, and just generally tries to be <em>reasonable</em>.</p>
</div>
<div class="section" id="doctest-js-tests-are-plain-javascript">
<h2>Doctest.js tests are plain Javascript</h2>
<p>Not many editors know how to syntax highlight and check doctests, with their <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> in front of each line and so forth.  And the whole thing is tweaky, you need to use a continuation (<tt class="docutils literal"><span class="pre">...</span></tt>) on some lines, and start statements with <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt>.  It&#8217;s an awkward way to compose.</p>
<p>Doctest.js started out with the same notion, though with different symbols (<tt class="docutils literal"><span class="pre">$</span></tt> and <tt class="docutils literal"><span class="pre">&gt;</span></tt>).  But recently with the rise of a number of excellent parsers (I used <a class="reference external" href="http://esprima.org/">Esprima</a>) I&#8217;ve moved my own tests to another pattern:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">print</span><span class="br0">&#40;</span>something<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />
// =&gt; expected output<br />
&nbsp;</div>
<p>This is already a fairly common way to write examples.  Like how you may have read pre-Python pseudocode and thought: <em>that looks like Python!</em>: doctest.js looks like example pseudocode.</p>
</div>
<div class="section" id="doctest-js-tests-are-self-describing">
<h2>Doctest.js tests are self-describing</h2>
<p>Python&#8217;s doctest has some options, some <em>important</em> options that effect the semantics of the test, that you can only turn on in the runner.  The most important option is ELLIPSIS.  Either your test was written to use ELLIPSIS or it wasn&#8217;t &#8211; that a test can&#8217;t self-describe its requirements means that test running is fragile.</p>
<p>I made <a class="reference external" href="http://pypi.python.org/pypi/dtopt">the hackiest package ever</a> to get around this in Python, but it&#8217;s hacky and lame.</p>
</div>
<div class="section" id="exception-handling-isn-t-special">
<h2>Exception handling isn&#8217;t special</h2>
<p>Python&#8217;s doctest treats exceptions differently from other output.  So if you print something before the exception, it is thrown away, never to be seen.  And you can&#8217;t use some of the same matching techniques.</p>
<p>Doctest.js just prints out exceptions, and it&#8217;s matched like anything else.</p>
<p>This particular case is one of several places where it feels like Python&#8217;s doctest is just being obstinate.  Doing it the right way isn&#8217;t harder.  Python&#8217;s doctest makes <em>debugging</em> exception cases really hard.</p>
</div>
<div class="section" id="doctest-js-has-a-concept-of-abort">
<h2>Doctest.js has a concept of &quot;abort&quot;</h2>
<p>I&#8217;m actually pretty okay with Python doctest&#8217;s notion that you just run all the tests, even when one fails.  Getting too many failures is a bit of a nuisance, but it&#8217;s not <em>that bad</em>.  But there&#8217;s no way to just give up, and there needs to be.  If you are relying on something to be importable, or some service to be available, there&#8217;s no point in going on with the tests.</p>
<p>Doctest.js lets you call <tt class="docutils literal"><span class="pre">Abort()</span></tt> and further tests are cancelled.</p>
</div>
<div class="section" id="distinguishing-between-debugging-output-and-deliberate-output">
<h2>Distinguishing between debugging output and deliberate output</h2>
<p>Maybe it&#8217;s my own fault for being a programming troglodite, but I use a lot of <tt class="docutils literal"><span class="pre">print</span></tt> for debugging.  This becomes a real problem with Python&#8217;s doctest, as it tracks all that printing and it causes tests to fail.</p>
<p>Javascript has something <em>specifically for</em> printing debugging output: <tt class="docutils literal"><span class="pre">console.log()</span></tt>.  Doctest.js doesn&#8217;t mess with that, it adds a new function <tt class="docutils literal"><span class="pre">print()</span></tt>.  Only stuff that is printed (not logged) is treated as expected output.  It&#8217;s like <tt class="docutils literal"><span class="pre">console.log()</span></tt> goes to stderr and <tt class="docutils literal"><span class="pre">print()</span></tt> goes to stdout.</p>
<p>Doctest.js also forces the developer to print everything they care about.  For better or worse Javascript has many more expressions than Python (including assignments), so looking at the result of an expression isn&#8217;t a good clue for whether you <em>care</em> about the result of an expression.  I&#8217;m not sure this is <em>better</em>, but it&#8217;s part of the difference.</p>
<p>Doctest.js also groups your printed statements according to the example you are in (an example being a block of code and an expected output).  This is much more helpful than watching a giant stream of output go to the console (the browser console or terminal).</p>
</div>
<div class="section" id="doctest-js-handles-async-code">
<h2>Doctest.js handles async code</h2>
<p>This admittedly isn&#8217;t that big a deal for Python, but for Javascript it is a real problem.  Not a problem for doctest.js in particular, but a problem for any Javascript test framework.  You want to test return values, but lots of functions don&#8217;t &quot;return&quot;, instead they call some callback or create some kind of promise object, and you have to test for side effects.</p>
<p>Doctest.js I think has a <a class="reference external" href="http://doctestjs.org/tutorial.html#async">really great answer for this</a>, which is not so much to say that Python&#8217;s doctest is so much worse, but in the context of Javascript doctest.js has something really useful and unique.  If callback-driven async code had ever been very popular in Python then this sort of feature would be nice there too.</p>
</div>
<div class="section" id="the-browser-is-a-great-environment">
<h2>The browser is a great environment</h2>
<p>A lot of where doctest.js is much better than Python&#8217;s doctest is simply that it has a much more powerful environment for displaying results.  It can highlight failed or passing tests.  When there&#8217;s a wildcard in expected output, it can show the actual output without adding any particular extra distraction.  It can group console messages with the tests they go with.  It can show <em>both</em> a simple failure message, and a detailed line-by-line comparison.  All these details make it easy to identify what went wrong and fix it.  The browser gives a rich and navigable interface.</p>
<p>I&#8217;d <em>like</em> to get doctest.js working well on Node.js (right now it works, but is not appealing), but I just can&#8217;t bring myself to give up the browser.  I have to figure out a good hybrid.</p>
</div>
<div class="section" id="python-s-doctest-lacks-a-champion">
<h2>Python&#8217;s doctest lacks a champion</h2>
<p>This is ultimately the reason Python&#8217;s doctest has all these problems: no one cares about it, no one feels responsible for it, and no one feels empowered to make improvements to it.  And to make things worse there is a cadre of people that will respond to suggestions with their own criticisms that doctest should never be used beyond its original niche, that it&#8217;s constraints are features.</p>
</div>
<div class="section" id="doctest-is-still-great">
<h2>Doctest is still great</h2>
<p>I&#8217;m ragging on Python&#8217;s doctest only because I love it.  I wish it was better, and I made doctest.js in a way I wish Python&#8217;s doctest was made.  Doctest, and more generally example/expectation oriented code, is a great way to explain things, to make tests readable, to make test-driven development feasible, to create an environment that errs on the side of over-testing instead of under-testing, and to make failures and resolutions symmetric.  It&#8217;s still <a class="reference external" href="behavior-driven-programming.html">vastly superior to BDD</a>, avoiding all BDD&#8217;s aping of readability while still embracing the sense of test-as-narrative.</p>
<p>But, more to the point: <a class="reference external" href="http://doctestjs.org">use doctest.js</a>, <a class="reference external" href="http://doctestjs.org/tutorial.html">read the tutorial</a>, or <a class="reference external" href="http://doctestjs.org/try.html">try it in the browser</a>.  I swear, it&#8217;s <em>really nice to use</em>.</p>
</div>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/"
    dc:identifier="http://blog.ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/"
    dc:title="Why doctest.js is better than Python&#8217;s doctest"
    trackback:ping="http://blog.ianbicking.org/2012/10/02/why-doctest-js-is-better-than-pythons-doctest/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2012 10 02</h3>
				<p class="post-categories"><a href="category/javascript/index.html" title="View all posts in Javascript" rel="category tag">Javascript</a><br/><a href="category/mozilla/index.html" title="View all posts in Mozilla" rel="category tag">Mozilla</a><br/><a href="category/programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="category/python/index.html" title="View all posts in Python" rel="category tag">Python</a></p>
				<p class="post-comments"><a href="index.html?p=291#comments" title="Comment on Why doctest.js is better than Python&#8217;s doctest">Comments (19)</a></p>
				<p class="post-permalink"><a href="index.html?p=291" title="Permalink to Why doctest.js is better than Python&#8217;s doctest" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-283" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=283" title="Permalink to Python Application Package" rel="bookmark">Python Application Package</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I&#8217;ve been thinking some more about deployment of Python web applications, and deployment in general (in part leading up to the <a class="reference external" href="https://us.pycon.org/2012/community/WebDevSummit/">Web Summit</a>). And I&#8217;ve got an idea.</p>
<p>I <a class="reference external" href="index.html?p=250">wrote about this about a year ago</a> and <a class="reference external" href="https://github.com/ianb/pywebapp/blob/master/docs/spec.txt">recently revised some notes on a proposal</a> but I&#8217;ve been thinking about something a bit more basic: a way to simply ship server applications, bundles of code.  Web applications are just one use case for this.</p>
<p>For now lets call this a &quot;Python application package&quot;.  It has these features:</p>
<ol class="arabic simple">
<li>There is an <em>application description</em>: this tells the <em>environment</em> about the application.  (This is sometimes called &quot;configuration&quot; but that term is very confusing and overloaded; I think &quot;description&quot; is much clearer.)</li>
<li>Given the description, you can create an execution environment to run code from the application and acquire objects from the application.  So there would be a specific way to setup <tt class="docutils literal"><span class="pre">sys.path</span></tt>, and a way to indicate any libraries that are required but not bundled directly with the application.</li>
<li>The environment can inject information into the application.  (Also this sort of thing is sometimes called &quot;configuration&quot;, but let&#8217;s not do that either.)  This is where the environment could indicate, for instance, what database the application should connect to (host, username, etc).</li>
<li>There would be a way to run commands and get objects from the application.  The environment would look in the application description to get the names of commands or objects, and use them in some specific manner depending on the purpose of the application.  For instance, WSGI web applications would point the environment to an application object.  A Tornado application might simply have a command to start itself (with the environment indicating what port to use through its injection).</li>
</ol>
<p>There&#8217;s a lot of things you can build from these pieces, and in a sophisticated application you might use a bunch of them at once.  You might have some WSGI, maybe a seperate non-WSGI server to handle Web Sockets, something for a Celery queue, a way to accept incoming email, etc.  In pretty much all cases I think basic application lifecycle is needed: commands to run when an application is first installed, something to verify the environment is acceptable, when you want to back up its data, when you want to uninstall it.</p>
<p>There&#8217;s also some things that all environments should setup the same or inject into the application.  E.g., <tt class="docutils literal"><span class="pre">$TMPDIR</span></tt> should point to a place where the application can keep its temporary files.  Or, every application should have a directory (perhaps specified in another environmental variable) where it can write log files.</p>
<div class="section" id="details">
<h2>Details?</h2>
<p>To get more concrete, here&#8217;s what I can imagine from a small application description; probably YAML would be a good format:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw3">platform</span>: python, wsgi<br />
require:<br />
&nbsp; <span class="kw3">os</span>: <span class="kw3">posix</span><br />
&nbsp; python: &lt;<span class="nu0">3</span><br />
&nbsp; rpm: m2crypto<br />
&nbsp; deb: python-m2crypto<br />
&nbsp; pip: requirements.<span class="me1">txt</span><br />
python:<br />
&nbsp; paths: vendor/<br />
wsgi:<br />
&nbsp; app: myapp.<span class="me1">wsgiapp</span>:application<br />
&nbsp;</div>
<p>I imagine <tt class="docutils literal"><span class="pre">platform</span></tt> as kind of a series of mixins.  This system doesn&#8217;t really need to be Python-specific; when creating something similar for <a class="reference external" href="http://cloudsilverlining.org">Silver Lining</a> I found PHP support relatively easy to add (handling languages that aren&#8217;t naturally portable, like Go, might be more of a stretch).  So <tt class="docutils literal"><span class="pre">python</span></tt> is one of the features this application uses.  You can imagine lots of modularization for other features, but it would be easy and unproductive to get distracted by that.</p>
<p>The application has certain requirements of its environment, like the version of Python and the general OS type.  The application might also require libraries, ideally one libraries that are not portable (M2Crypto being an example).  Modern package management works pretty nicely for this stuff, so relying on system packages as a first try I believe is best (I&#8217;d offer <tt class="docutils literal"><span class="pre">requirements.txt</span></tt> as a fallback, not as the primary way to handle dependencies).</p>
<p>I think it&#8217;s much more reliable if applications primarily rely on bundling their dependencies directly (i.e., using a vendor directory). The tool support for this is a bit spotty, but I believe this package format could clarify the problems and solutions.  <a class="reference external" href="https://gist.github.com/1368649">Here is an example</a> of how you might set up a virtualenv environment for <em>managing</em> vendor libraries (you then do not need virtualenv to <em>use</em> those same libraries), and do so in a way where you can check the results into source control.  It&#8217;s kind of complicated, but works (well, almost works &#8211; <tt class="docutils literal"><span class="pre">bin/</span></tt> files need fixing up).  It&#8217;s a start at least.</p>
</div>
<div class="section" id="support-library">
<h2>Support Library</h2>
<p>On the environment side we need a good support library.  <a class="reference external" href="https://github.com/ianb/pywebapp/">pywebapp</a> has some of the basic features, though it is quite incomplete. I imagine a library looking something like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> apppackage <span class="kw1">import</span> AppPackage<br />
app = AppPackage<span class="br0">&#40;</span><span class="st0">'/var/apps/app1.2012.02.11'</span><span class="br0">&#41;</span><br />
<span class="co1"># Maybe a little Debian support directly:</span><br />
<span class="kw3">subprocess</span>.<span class="me1">call</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="st0">'apt-get'</span>, <span class="st0">'install'</span><span class="br0">&#93;</span> +<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; app.<span class="me1">config</span><span class="br0">&#91;</span><span class="st0">'require'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">'deb'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />
<span class="co1"># Or fall back of virtualenv/pip</span><br />
app.<span class="me1">create_virtualenv</span><span class="br0">&#40;</span><span class="st0">'/var/app/venvs/app1.2012.02.11'</span><span class="br0">&#41;</span><br />
app.<span class="me1">install_pip_requirements</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
wsgi_app = app.<span class="me1">load_object</span><span class="br0">&#40;</span>app.<span class="me1">config</span><span class="br0">&#91;</span><span class="st0">'wsgi'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">'app'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>You can imagine building hosting services on this sort of thing, or setting up continuous integration servers (<tt class="docutils literal"><span class="pre">app.run_command(app.config['unit_test'])</span></tt>), and so forth.</p>
</div>
<div class="section" id="local-development">
<h2>Local Development</h2>
<p>If designed properly, I think this format is as usable for local development as it is for deployment.  It should be able to run directly from a checkout, with the &quot;development environment&quot; being an environment just like any other.</p>
<p>This rules out, or at least makes less exciting, the use of zip files or tarballs as a package format.  The only justification I see for using such archives is that they are easy to move around; but we live in the FUTURE and there are many ways to move directories around and we don&#8217;t need to cater to silly old fashions.  If that means a script that creates a tarball, FTPs it to another computer, and there it is unzipped, then fine &#8211; this format <em>should not</em> specify anything about how you actually deliver the files.  But let&#8217;s not worry about copying <a class="reference external" href="http://en.wikipedia.org/wiki/WAR_file_format_%28Sun%29">WARs</a>.</p>
</div>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2012/02/29/python-application-package/"
    dc:identifier="http://blog.ianbicking.org/2012/02/29/python-application-package/"
    dc:title="Python Application Package"
    trackback:ping="http://blog.ianbicking.org/2012/02/29/python-application-package/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2012 02 29</h3>
				<p class="post-categories"><a href="category/packaging/index.html" title="View all posts in Packaging" rel="category tag">Packaging</a><br/><a href="category/python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="category/silverlining.1" title="View all posts in Silver Lining" rel="category tag">Silver Lining</a><br/><a href="category/web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="index.html?p=283#comments" title="Comment on Python Application Package">Comments (9)</a></p>
				<p class="post-permalink"><a href="index.html?p=283" title="Permalink to Python Application Package" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-277" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=277" title="Permalink to Git-as-sync, not source-control-as-deployment" rel="bookmark">Git-as-sync, not source-control-as-deployment</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I don&#8217;t like systems that use <tt class="docutils literal"><span class="pre">git</span> <span class="pre">push</span></tt> for deployment (Heroku et al).  Why?  I do a lot of this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ git push deploy<br />
... <span class="me1">realize</span> I forgot a domain name ...<br />
$ git commit -m <span class="st0">&quot;fix domain name&quot;</span> -a ; git push deploy<br />
... <span class="me1">realize</span> I didn<span class="st0">'t do something right with the database setup ...<br />
$ git commit -m &quot;configure database right&quot; -a ; git push deploy<br />
... dammit, I didn'</span>t fix it quite right ...<br />
$ git commit -m <span class="st0">&quot;typo&quot;</span> -a ; git push deploy<br />
&nbsp;</div>
<p>And then maybe I&#8217;d actually like to keep my config out of my source control, or have a build process that I run locally, or any number of things.  I&#8217;d like to be able to test deployment, but every deployment is a commit, and I like to commit <em>tested</em> work.  I think I could use <tt class="docutils literal"><span class="pre">git</span> <span class="pre">rebase</span></tt> but I lack the discipline to undo my work so I can do it correctly.  This is why I don&#8217;t do continuous commits.</p>
<p>There&#8217;s a whole different level of weirdness when you use <a class="reference external" href="http://pages.github.com/">GitHub Pages</a> as you aren&#8217;t pushing to a deployment-specific remote, you are pushing to a deployment-specific branch.</p>
<p>So I&#8217;ve generally thought: git deployment is wrong.</p>
<p>Then I was talking to some other people at Mozilla and they mentioned that ops was using git for simply moving files around even though the stuff they were deploying was itself in Mercurial.  They had a particular site with a very large number of files, and it was faster to use git than rsync (git has more metadata than rsync; rsync has to look at <em>everything</em> everytime you sync).  And that all seemed very reasonable; git is a fine way to sync things.</p>
<p>But I kind of forgot about it all, and just swore to myself as I did too many trivial commits and wrote too many meaningless commit messages.</p>
<p>Still&#8230; it isn&#8217;t so hard to separate these concerns, is it?  So I wrote up a <a class="reference external" href="https://github.com/ianb/git-sync/blob/master/git-sync">quite small command</a> called <a class="reference external" href="https://github.com/ianb/git-sync">git-sync</a>.  The basic idea: copy the working directory to a new location (minus <tt class="docutils literal"><span class="pre">.git/</span></tt>), commit that, and push the result to your deployment remote.  You can send modified and untracked files, and you can run a build script before committing and push the <em>result</em> of the build script, all without sullying your &quot;real&quot; source control.  And you happen to have a nice history of deployments, which is also nice.</p>
<p>I&#8217;ve only used this a little bit, but I&#8217;ve enjoyed when I have used it, and it makes me feel much better/clearer about my actual commits.  It&#8217;s really short right now, and probably gets some things entirely wrong (e.g., moving over untracked files).  But it works well enough to be improved (<em>winkwinknudgenudge</em>).</p>
<p>So check it out: <a class="reference external" href="https://github.com/ianb/git-sync">https://github.com/ianb/git-sync</a></p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2012/02/14/git-as-sync-not-source-control-as-deployment/"
    dc:identifier="http://blog.ianbicking.org/2012/02/14/git-as-sync-not-source-control-as-deployment/"
    dc:title="Git-as-sync, not source-control-as-deployment"
    trackback:ping="http://blog.ianbicking.org/2012/02/14/git-as-sync-not-source-control-as-deployment/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2012 02 14</h3>
				<p class="post-categories"><a href="category/programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="category/web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="index.html?p=277#comments" title="Comment on Git-as-sync, not source-control-as-deployment">Comments (11)</a></p>
				<p class="post-permalink"><a href="index.html?p=277" title="Permalink to Git-as-sync, not source-control-as-deployment" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-253" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=253" title="Permalink to My Unsolicited Advice For PyPy" rel="bookmark">My Unsolicited Advice For PyPy</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I think the most interesting work in programming languages right now is about the <em>runtime</em>, not syntax or even the languages themselves. Which places PyPy in an interesting position, as they have put a great deal of effort into abstracting out the concept of runtime from the language they are implementing (Python).</p>
<p>There are of course other runtime environments available to Python. The main environment has and continues to be CPython &#8212; the runtime developed in parallel with the language, and with continuous incremental feedback and improvement by the Python developer community.  It is the runtime that informs and is informed by the language.  It&#8217;s also the runtime that is most easy-going about integrating with C libraries, and by extension it is part of the vague but important runtime environment of &quot;Unix&quot;.  There&#8217;s also Jython and IronPython.  I frankly find these completely uninteresting.  They are runtimes controlled by companies, not communities, and the Python implementations are neither natural parts of their runtime environments, nor do the runtimes include many concessions to make themselves natural for Python.</p>
<p>PyPy is somewhere different.  It still has a tremendous challenge because Python was not developed <em>for</em> PyPy.  Even small changes to the language seem impossible &#8212; something as seemingly innocuous as making builtins static seems to be stuck in a conservative reluctance to change.  But unlike Jython and IronPython they aren&#8217;t stuck between a rock and a hard place; they just have to deal with the rock, not the hard place.</p>
<p>So here is my unsolicited advice on what PyPy-the-runtime should consider.  Simple improvements to performance and the runtime are fine, but being incrementally better than CPython only goes so far, and I personally doubt it will ever make a big impact on Python that way.</p>
<p>PyPy should push hard on <em>concurrency</em> and <em>reliability</em>.  If it is <em>fast enough</em> then that&#8217;s fine; that&#8217;s done as far as I&#8217;m concerned. I say this because I&#8217;m a web programmer, and speed is uninteresting to me.  Certainly opinions will differ.  But to me speed (as it&#8217;s normally defined) is really <em>really</em> uninteresting.  When or if I care about speed I&#8217;m probably more drawn to Cython.  I <em>do</em> care about latency, memory efficiency, scalability/concurrency, resource efficiency, and most of all <em>worst cases</em>.  I don&#8217;t think a JIT addresses any of these (and can even make things worse).  I don&#8217;t know of benchmarks that measure these parameters either.</p>
<p>I want a runtime with new and novel features; something that isn&#8217;t just incrementally better than CPython.  This itself might seem controversial, as the only point to such novel features would be for people to implement at least some code intended for <em>only</em> PyPy.  But if the features are good enough then I&#8217;m okay with this &#8212; and if I&#8217;m not drawn to write something that will only work on PyPy, I probably won&#8217;t be drawn to use PyPy <em>at all</em>; natural conservatism and inertia will keep me (and most people) on CPython indefinitely.</p>
<p>What do I want?</p>
<ul class="simple">
<li><strong>Microprocesses</strong>.  Stackless and greenlets have given us micro-threads, but it&#8217;s just not the same.  Which is not entirely a criticism &#8212; it shows that unportable features <em>are</em> interesting when they are good features.  But I want the next step, which is processes that don&#8217;t share state.  (And implicitly I don&#8217;t just want standard async techniques, which use explicit concurrency and shared state.)</li>
<li><strong>Shared objects</strong> across processes with <strong>copy-on-write</strong>; then you can efficiently share objects (like modules!) across concurrent processes without the danger of shared state, but without the overhead of copying <em>everything</em> you want to share.  Lack of this is hurting PHP, as you can&#8217;t have a rich set of libraries and share-nothing without killing your performance.</li>
<li>I&#8217;d rather see a break in compatibility for C extensions to support this new model, than to abandon what could be PyPy&#8217;s best feature to support CPython&#8217;s C extension ecosystem.  Being a web programmer I honestly don&#8217;t need many C modules, so maybe I&#8217;m biased.  But if the rest of the system is good enough then the C extensions will come.</li>
<li>Make sure resource sharing that happens outside of the Python environment is really solid.  C libraries are often going to be unfriendly towards microprocesses; make sure what <em>is</em> exposed to the Python environment is solid.  That might even mean a dangerous process mode that can handle ctypes and FFI and where you carefully write Python code that has extra powers, so long as there&#8217;s a strong wall between that code and &quot;general&quot; code that makes use of those services.</li>
<li><strong>Cython</strong> &#8212; it&#8217;s doing a lot of good stuff, and has a much more conservative but also more predictable path to performance (through things like type annotation).  I think it&#8217;s worth leaning on.  I also have something of a hunch that it could be a good way to do FFI in a safe manner, as Cython already supports multiple targets (Python 2 and 3) from the same codebase.  Could PyPy be another target?</li>
<li><strong>Runtime introspection of the runtime</strong>.  We have great language introspection (probably much to the annoyance of PyPy developers who have to copy this) but currently runtime introspection is poor-to-nonexistant. What processes are running?  How much memory is each using?  Where? Are they holding on to resources?  Are they blocking on some non-Python library?  How much CPU have they been using?  Then I want to be able to kill processes, send them signals, adjust priorities, etc.</li>
</ul>
<p>And I guess it doesn&#8217;t have to be &quot;PyPy&quot;, but a new backend for PyPy to target; it doesn&#8217;t have to be the <em>only</em> path PyPy pursues.</p>
<p>With a runtime like this PyPy could be an absolutely rocking platform for web development.  Python could be as reliable as, oh&#8230; <a class="reference external" href="index.html?p=38">PHP</a>? Sorry, I probably won&#8217;t win arguments that way ;)  As good as Erlang! Maybe we could get the benefits of async without the pain of callbacks or Deferreds. And these are features people would <em>use</em>.  Right now I&#8217;m perceiving a problem where there&#8217;s lots of people standing on the sidelines cheering you on but not actually <em>using</em> PyPy.</p>
<p>So: I wouldn&#8217;t tell anyone what to do, and if someone tries this out I&#8217;ll probably only be on the sidelines cheering you on&#8230; but I really think this could be awesome.</p>
<p><strong>Update</strong>: there&#8217;s some <a class="reference external" href="http://news.ycombinator.com/item?id=2406920">interesting comments on Hacker News</a> as well.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2011/04/04/unsolicited-advice-for-pypy/"
    dc:identifier="http://blog.ianbicking.org/2011/04/04/unsolicited-advice-for-pypy/"
    dc:title="My Unsolicited Advice For PyPy"
    trackback:ping="http://blog.ianbicking.org/2011/04/04/unsolicited-advice-for-pypy/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2011 04 04</h3>
				<p class="post-categories"><a href="category/programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="category/python/index.html" title="View all posts in Python" rel="category tag">Python</a></p>
				<p class="post-comments"><a href="index.html?p=253#comments" title="Comment on My Unsolicited Advice For PyPy">Comments (22)</a></p>
				<p class="post-permalink"><a href="index.html?p=253" title="Permalink to My Unsolicited Advice For PyPy" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-250" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=250" title="Permalink to A Python Web Application Package and Format (we should make one)" rel="bookmark">A Python Web Application Package and Format (we should make one)</a></h2>
					<div class="post-entry">
						
<div class="document">


<p>At PyCon there was an open space about deployment, and the idea of drop-in applications (Java-WAR-style).</p>
<p>I generally get pessimistic about 80% solutions, and dropping in a WAR file feels like an 80% solution to me. I&#8217;ve used the Hudson/Jenkins installer (which I think is <em>specifically</em> a project that got WARs on people&#8217;s minds), and in a lot of ways that installer is nice, but it&#8217;s also kind of wonky, it makes configuration unclear, it&#8217;s not always clear when it installs or configures itself through the web, and when you have to do this at the system level, nor is it clear where it puts files and data, etc. So a great initial experience doesn&#8217;t feel like a great ongoing experience to me &#8212; and <em>it doesn&#8217;t have to be that way</em>. If those were <em>necessary</em> compromises, sure, but they aren&#8217;t. And because we <em>don&#8217;t have</em> WAR files, if we&#8217;re proposing to make something new, then we have every opportunity to make things better.</p>
<p>So the question then is what we&#8217;re trying to make. To me: we want applications that are easy to install, that are self-describing, self-configuring (or at least guide you through configuration), reliable with respect to their environment (not dependent on system tweaking), upgradable, and respectful of persistence (the data that outlives the application install). A lot of this can be done by the &quot;container&quot; (to use Java parlance; or &quot;environment&quot;) &#8212; if you just have the app packaged in a nice way, the container (server environment, hosting service, etc) can handle all the system-specific things to make the application actually work.</p>
<p>At which point I am of course reminded of my <a class="reference external" href="http://cloudsilverlining.org">Silver Lining</a> project, which defines something very much like this. Silver Lining isn&#8217;t <em>just</em> an application format, and things aren&#8217;t fully extracted along these lines, but it&#8217;s pretty close and it addresses a lot of important issues in the lifecycle of an application. To be clear: Silver Lining is an application packaging format, a server configuration library, a cloud server management tool, a persistence management tool, and a tool to manage the application with respect to all these services over time. It is a bunch of things, maybe too many things, so it is not unreasonable to pick out a smaller subset to focus on. Maybe an easy place to start (and good for Silver Lining itself) would be to separate at least the application format (and tools to manage applications in that state, e.g., installing new libraries) from the tools that make use of such applications (deploy, etc).</p>
<p>Some opinions I have on this format, exemplified in Silver Lining:</p>
<ul class="simple">
<li>It&#8217;s not zipped or a single file, unlike WARs. Uploading zip files is not a great API. Geez. I know there&#8217;s this desire to &quot;just drop in a file&quot;; but there&#8217;s no getting around the fact that &quot;dropping a file&quot; becomes a <em>deployment protocol</em> <strong>and</strong> <em>it&#8217;s an incredibly impoverished protocol</em>. The format is also not subtly git-based (ala Heroku) because <tt class="docutils literal"><span class="pre">git</span> <span class="pre">push</span></tt> is not a good deployment protocol.</li>
<li>But of course there isn&#8217;t really any deployment protocol inferred by a format anyway, so maybe I&#8217;m getting ahead of myself ;) I&#8217;m saying a tool that deploys should take as an argument a directory, not a single file. (If the tool then zips it up and uploads it, fine!)</li>
<li>Configuration &quot;comes from the outside&quot;. That is, an application requests services, and the <em>container</em> tells the application where those services are. For Silver Lining I&#8217;ve used environmental variables. I think this one point is really important &#8212; the container <em>tells</em> the application. As a counter-example, an application that comes with a Puppet deployment recipe is essentially <em>telling</em> the server how to arrange itself to suit the application. This will never be reliable or simple!</li>
<li>The application indicates what &quot;services&quot; it wants; for instance, it may want to have access to a MySQL database. The container then provides this to the application. In practice this means installing the actual packages, but also creating a database and setting up permissions appropriately. The alternative is never having <em>any</em> dependencies, meaning you have to use SQLite databases or ad hoc structures, etc. But in fact installing databases really isn&#8217;t that hard these days.</li>
<li><em>All</em> persistence has to use a service of some kind. If you want to be able to write to files, you need to use a file service. This means the container is fully aware of everything the application is leaving behind. All the various paths an application should use are given in different environmental variables (many of which don&#8217;t need to be invented anew, e.g., <tt class="docutils literal"><span class="pre">$TMPDIR</span></tt>).</li>
<li>It uses vendor libraries exclusively for Python libraries. That means the application bundles all the libraries it requires. Nothing ever gets installed at deploy-time. This is in contrast to using a <tt class="docutils literal"><span class="pre">requirements.txt</span></tt> list of packages at deployment time. If you want to use those tools for development that&#8217;s fine, just not for deployment.</li>
<li>There <em>is</em> also a way to indicate other libraries you might require; e.g., you might <tt class="docutils literal"><span class="pre">lxml</span></tt>, or even something that isn&#8217;t quite a library, like <tt class="docutils literal"><span class="pre">git</span></tt> (if you are making a github clone). You can&#8217;t do those as vendor libraries (they include non-portable binaries). Currently in Silver Lining the application description can contain a list of Ubuntu package names to install. Of course that would have to be abstracted some.</li>
<li>You can ask for scripts or a request to be invoked for an application after an installation or deployment. It&#8217;s lame to try to test if is-this-app-installed on <em>every</em> request, which is the frequent alternative. Also, it gives the application the chance to signal that the installation failed.</li>
<li>It has a very simple (possibly/probably too simple) sense of configuration. You don&#8217;t have to use this if you make your app self-configuring (i.e., build in a web-accessible settings screen), but in practice it felt like some simple sense of configuration would be helpful.</li>
</ul>
<p>Things that could be improved:</p>
<ul class="simple">
<li>There are some places where you might be encouraged to use routines from the <tt class="docutils literal"><span class="pre">silversupport</span></tt> package. There are very few! But maybe an alternative could be provided for these cases.</li>
<li>A little convention-over-configuration is probably suitable for the bundled libraries; silver includes tools to manage things, but it gets a little twisty. When creating a new project I find myself creating several <tt class="docutils literal"><span class="pre">.pth</span></tt> files, special customizing modules, etc. Managing vendor libraries is also not obvious.</li>
<li><a class="reference external" href="http://cloudsilverlining.org/services.html">Services</a> are IMHO quite important and useful, but also need to be carefully specified.</li>
<li>There&#8217;s a bunch of runtime expectations that aren&#8217;t part of the format, but in practice would be part of how the application is written. For instance, I make sure each app has its own temporary directory, and that it is cleared on update. If you keep session files in that location, and you expect the environment to clean up old sessions &#8212; well, either all environments should do that, or none should.</li>
<li>The process model is not entirely clear. I tried to simply define one process model (unthreaded, multiple processes), but I&#8217;m not sure that&#8217;s suitable &#8212; most notably, multiple processes have a significant memory impact compared to threads. An application should at least be able to indicate what process models it accepts and prefers.</li>
<li>Static files are <em>all</em> convention over configuration &#8212; you put static files under <tt class="docutils literal"><span class="pre">static/</span></tt> and then they are available. So <tt class="docutils literal"><span class="pre">static/style.css</span></tt> would be at <tt class="docutils literal"><span class="pre">/style.css</span></tt>. I think this is generally <em>good</em>, but putting all static files under one URL path (e.g., <tt class="docutils literal"><span class="pre">/media/</span></tt>) can be good for other reasons as well. Maybe there should be conventions for both.</li>
<li>Cron jobs are important. Though maybe they could just be yet another kind of service? Many extra features could be new services.</li>
<li>Logging is also important; Silver Lining attempts to handle that somewhat, but it could be specified much better.</li>
<li>Silver Lining also supports PHP, which seemed to cause a bit of stress. But just ignore that. It&#8217;s really easy to ignore.</li>
</ul>
<p>There is a <a class="reference external" href="http://cloudsilverlining.org/appconfig.html">description of the configuration file for apps</a>. The <a class="reference external" href="http://cloudsilverlining.org/envvariables.html">environmental variables</a> are also notably part of the application&#8217;s expectations. The file layout is explained (together with a bunch of Silver Lining-specific concepts) in <a class="reference external" href="http://cloudsilverlining.org/devpatterns.html">Development Patterns</a>. Besides all that there is admittedly some other stuff that is only really specified in code; but in Silver Lining&#8217;s defense, specified in code is better than unspecified ;) App Engine provides another example of an application format, and would be worth using as a point of discussion or contrast (I did that myself when writing Silver Lining).</p>
<p>Discussing WSGI stuff with Ben Bangert at PyCon he noted that he didn&#8217;t really feel like the WSGI pieces needed that much more work, or at least that&#8217;s not where the interesting work was &#8212; the interesting work is in the tooling. An application format could provide a great basis for building this tooling. And I honestly think that the tooling has been held back more by divergent patterns of development than by the difficulty of writing the tools themselves; and a good, general application format could fix that.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2011/03/31/python-webapp-package/"
    dc:identifier="http://blog.ianbicking.org/2011/03/31/python-webapp-package/"
    dc:title="A Python Web Application Package and Format (we should make one)"
    trackback:ping="http://blog.ianbicking.org/2011/03/31/python-webapp-package/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2011 03 31</h3>
				<p class="post-categories"><a href="category/packaging/index.html" title="View all posts in Packaging" rel="category tag">Packaging</a><br/><a href="category/programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="category/python/index.html" title="View all posts in Python" rel="category tag">Python</a><br/><a href="category/web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="index.html?p=250#comments" title="Comment on A Python Web Application Package and Format (we should make one)">Comments (18)</a></p>
				<p class="post-permalink"><a href="index.html?p=250" title="Permalink to A Python Web Application Package and Format (we should make one)" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-245" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=245" title="Permalink to Javascript on the server AND the client is not a big deal" rel="bookmark">Javascript on the server AND the client is not a big deal</a></h2>
					<div class="post-entry">
						<div class="document">
<p>All the cool kids love <a class="reference external" href="http://nodejs.org/">Node.js</a>.  I&#8217;ve used it a little, and it&#8217;s fine; I was able to do what I wanted to do, and it wasn&#8217;t particularly painful.  It&#8217;s fun to use something new, and it&#8217;s relatively straight-forward to get started so it&#8217;s an <em>emotionally satisfying</em> experience.</p>
<p>There are several reasons you might want to use Node.js, and I&#8217;ll ignore many of them, but I want to talk about one in particular:</p>
<blockquote><p>
Javascript on the client and the server!</p></blockquote>
<p>Is this such a great feature?  I think not&#8230;</p>
<div class="section" id="you-only-need-to-know-one-language">
<h2>You only need to know one language!</h2>
<p>Sure.  Yay ignorance!  But really, this is <em>fine</em> but unlikely to be relevant to any current potential audience for Node.js.  If you are shooting for an very-easy-to-learn client-server programming system, Node.js isn&#8217;t it.  Maybe <a class="reference external" href="http://couchapp.org/">Couch</a> or something similar has that potential?  But I digress.</p>
<p>It&#8217;s not easy to have expertise at multiple languages.  But it&#8217;s not <em>that hard</em>.  It&#8217;s considerably harder to have expertise at <em>multiple platforms</em>.  Node.js gives you one language across client and server, but <em>not</em> one platform.  Node.js programming doesn&#8217;t <em>feel</em> like the browser environment.  They do adopt many conventions when it&#8217;s reasonable, but even then it&#8217;s not always the case &#8212; in particular because many browser APIs are the awkward product of C++ programmers exposing things to Javascript, and you don&#8217;t want to reproduce those same APIs if you don&#8217;t have to (and Node.js doesn&#8217;t have to!) &#8212; an example is the event pattern in Node, which is similar to a browser but less obtuse.</p>
</div>
<div class="section" id="you-get-to-share-libraries">
<h2>You get to share libraries!</h2>
<p>First: the same set of libraries is probably not applicable.  If you can do it on the client then you probably don&#8217;t <em>have</em> to do it on the server, and vice versa.</p>
<p>But sometimes the same libraries are useful.  Can you really share them?  Browser libraries are often hard to use elsewhere because they rely on browser APIs.  These APIs are frequently <em>impossible to implement in Javascript</em>.</p>
<p>Actually they are possible to implement in Javascript using <a class="reference external" href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Proxy">Proxies</a> (or maybe some other new and not-yet-standard Javascript features). But not in Node.js, which uses V8, and V8 is a pretty conservative implementation of the Javascript language. (<strong>Update</strong>: <a class="reference external" href="2011/03/30/js-on-server-and-client-is-not-a-big-deal/comment-page-1/index.html#comment-194005">it is noted</a> that you can <a class="reference external" href="https://github.com/isaacs/node-proxy/tree/master/src">implement proxies</a> &#8212; in this case a C++ extension to Node)</p>
<p>Besides these unimplementable APIs, it is also just a different environment.  There is the trivial: the <tt class="docutils literal"><span class="pre">window</span></tt> object in the browser has a Node.js equivalent, but it&#8217;s not named <tt class="docutils literal"><span class="pre">window</span></tt>. Performance is different &#8212; Node has long-running processes, the browser <em>might</em>.  Node can have blocking calls, which are useful even if you can&#8217;t use them at runtime (e.g., <tt class="docutils literal"><span class="pre">require()</span></tt>); but you can&#8217;t really have any of these at any time on the browser.  And then of course all the system calls, <em>none</em> of which you can use in the browser.</p>
<p>All these may simply be surmountable challenges, through modularity, mocking, abstractions, and so on&#8230; but ultimately I think the motivation is lacking: the domain of changing a live-rendered DOM isn&#8217;t the same as producing bytes to put onto a socket.</p>
</div>
<div class="section" id="you-can-work-fluidly-across-client-and-server">
<h2>You can work fluidly across client and server!</h2>
<p>If anything I think this is <em>dangerous</em> rather than <em>useful</em>.  The client and the server are different places, with different expectations.  Any vagueness about that boundary is <em>wrong</em>.</p>
<p>It&#8217;s wrong from a security perspective, as the security assumptions are nearly opposite on the two platforms.  The client trusts itself, and the server trusts itself, and both should hold the other in suspicion (though the client can be more trusting because the <em>browser</em> doesn&#8217;t trust the client code).</p>
<p>But it&#8217;s also the wrong way to treat HTTP.  HTTP is pretty simple until you try to make it simpler.  Efforts to make it simpler mostly make it more complicated.  HTTP lets you send serialized data back and forth to a server, with a bunch of metadata and other do-dads.  And that&#8217;s all neat, but you should always be thinking about <em>sending</em> information.  And never <em>sharing</em> information.  It&#8217;s not a fluid boundary, and code that touches HTTP needs to be explicit about it and not pretend it is equivalent to any other non-network operation.</p>
<p>Certainly you don&#8217;t <em>need</em> two implementation languages to keep your mind clear.  But it doesn&#8217;t hurt.</p>
</div>
<div class="section" id="you-can-do-validation-the-same-way-on-the-client-and-server">
<h2>You can do validation the same way on the client and server!</h2>
<p>One of the things people frequently bring up is that you can validate data on the client and server using the same code.  And of course, what web developer hasn&#8217;t been a little frustrated that they have to implement validation twice?</p>
<p>Validation on the client is primarily a <em>user experience</em> concern, where you focus on bringing attention to problems with a form, and helping the user resolve those problems.  You may be able to avoid errors entirely with an input method that avoids the problem (e.g., if a you have a slider for a numeric input, you don&#8217;t have to worry about the user inputing a non-numeric value).</p>
<p>Once the form is submitted, if you&#8217;ve done thorough client-side validation you can also avoid <em>friendly</em> server-side validation.  Of course all your client-side validation could be avoided through a malicious client, but you don&#8217;t need to give a friendly error message in that case, you can simply bail out with a simple 400 Bad Request error.</p>
<p>At that point there&#8217;s not much in common between these two kinds of validation &#8212; the client is all user experience, and the server is all data integrity.</p>
</div>
<div class="section" id="you-can-do-server-side-javascript-as-a-fallback-for-the-client">
<h2>You can do server-side Javascript as a fallback for the client!</h2>
<p>Writing for clients without Javascript is becoming increasingly less relevant, and if we aren&#8217;t <em>there</em> yet, then we&#8217;ll certainly <em>get there</em> soon.  It&#8217;s only a matter of time, the writing is on the wall. Depending on the project you might have to put in workarounds, but we should keep those concerns out of architecture decisions.  Maintaining crazy hacks is <em>not</em> worth it. There&#8217;s so many terrible hacks that have turned into frameworks, and frameworks that have justified themselves because of the problems they solved that no longer matter&#8230; Node.js deserves better than to be one of those.</p>
</div>
<div class="section" id="in-conclusion-or-whatever">
<h2>In Conclusion Or Whatever</h2>
<p>I&#8217;m not saying Node.js is <em>bad</em>.  There are other arguments for it, and you don&#8217;t need to make <em>any</em> argument for it if you just feel like using it.  It&#8217;s fun to do something new.  And I&#8217;m as optimistic about Javascript as anyone.  But this one argument, I do not think it is very good.</p>
</div>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2011/03/30/js-on-server-and-client-is-not-a-big-deal/"
    dc:identifier="http://blog.ianbicking.org/2011/03/30/js-on-server-and-client-is-not-a-big-deal/"
    dc:title="Javascript on the server AND the client is not a big deal"
    trackback:ping="http://blog.ianbicking.org/2011/03/30/js-on-server-and-client-is-not-a-big-deal/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2011 03 30</h3>
				<p class="post-categories"><a href="category/javascript/index.html" title="View all posts in Javascript" rel="category tag">Javascript</a><br/><a href="category/programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="category/web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="index.html?p=245#comments" title="Comment on Javascript on the server AND the client is not a big deal">Comments (29)</a></p>
				<p class="post-permalink"><a href="index.html?p=245" title="Permalink to Javascript on the server AND the client is not a big deal" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-239" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=239" title="Permalink to Doctest.js &#038; Callbacks" rel="bookmark">Doctest.js &#038; Callbacks</a></h2>
					<div class="post-entry">
						<div class="document">
<p>Many years ago I wrote a fairly straight-forward port of Python&#8217;s <a class="reference external" href="http://docs.python.org/library/doctest.html">doctest</a> to Javascript.  I thought it was cool, but I didn&#8217;t really talk about it that much.  Especially because I knew it had one fatal flaw: it was very unfriendly towards programming with callbacks, and Javascript uses a lot of callbacks.</p>
<p>On a recent flight I decided to look at it again, and realized fixing that one flaw wasn&#8217;t actually a big deal.  So now doctest.js really works.  And I think it works well: <a class="reference external" href="http://doctestjs.org">doctest.js</a>.</p>
<p>I have yet to really use doctest.js on more than a couple real cases, and as I do (or you do?) I expect to tweak it more to make it flow well. But having tried a couple of examples I am particularly liking how it can be used with callbacks.</p>
<p>Testing with callbacks is generally a tricky thing.  You want to make assertions, but they happen entirely separately from the test runner&#8217;s own loop, and your callbacks may not run at all if there&#8217;s a failure.</p>
<p>I came upon some tests recently that used <a class="reference external" href="http://pivotal.github.com/jasmine/">Jasmine</a>, a <a class="reference external" href="http://en.wikipedia.org/wiki/Behavior_Driven_Development">BDD-style</a> test framework.  I&#8217;m <a class="reference external" href="behavior-driven-programming.html">not a big fan of BDD</a> but I&#8217;m fairly new to serious Javascript development so I&#8217;m trying to withhold judgement.  The flow of the tests is a bit peculiar until you realize that it&#8217;s for async reasons.  I&#8217;ll try to show something that roughly approximates a real test of an XMLHttpRequest API call:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
it<span class="br0">&#40;</span><span class="st0">&quot;should give us no results&quot;</span>, function<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; runs<span class="br0">&#40;</span>function <span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; var callback = createSpy<span class="br0">&#40;</span><span class="st0">'callback for results'</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; $.<span class="me1">ajax</span><span class="br0">&#40;</span><span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; url: <span class="st0">'/search'</span>,<br />
&nbsp; &nbsp; &nbsp; data: <span class="br0">&#123;</span>q: <span class="st0">&quot;query unlikely to match anything&quot;</span><span class="br0">&#125;</span>,<br />
&nbsp; &nbsp; &nbsp; dataType: <span class="st0">&quot;json&quot;</span>,<br />
&nbsp; &nbsp; &nbsp; success: callback<br />
&nbsp; &nbsp; <span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
&nbsp; <span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
&nbsp; waits<span class="br0">&#40;</span>someTimeout<span class="br0">&#41;</span>;<br />
&nbsp; runs<span class="br0">&#40;</span>function <span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; expect<span class="br0">&#40;</span>callback<span class="br0">&#41;</span>.<span class="me1">toHaveBeenCalled</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; expect<span class="br0">&#40;</span>callback.<span class="me1">mostRecentCall</span>.<span class="me1">args</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">length</span><span class="br0">&#41;</span>.<span class="me1">toEqual</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span>;<br />
&nbsp; <span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
<span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
&nbsp;</div>
<p>So, the basic pattern is <tt class="docutils literal"><span class="pre">it()</span></tt> creates a group of tests, and each call to <tt class="docutils literal"><span class="pre">run()</span></tt> is a set of items to call sequentially.  Then between these run blocks you can have signals to the runner to wait for some result, either a timeout (which is fragile), or you can setup specific conditions.</p>
<p>Another popular test runner is <a class="reference external" href="http://docs.jquery.com/Qunit">QUnit</a>; it&#8217;s popular particularly because it&#8217;s what jQuery uses, and my own impression is that QUnit is just very simple and so least likely to piss you off.</p>
<p>QUnit has its own style for async:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw3">test</span><span class="br0">&#40;</span><span class="st0">&quot;should give us no results&quot;</span>, function <span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; stop<span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; expect<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>;<br />
&nbsp; $.<span class="me1">ajax</span><span class="br0">&#40;</span><span class="br0">&#123;</span><br />
&nbsp; &nbsp; url: <span class="st0">'/search'</span>,<br />
&nbsp; &nbsp; data: <span class="br0">&#123;</span>q: <span class="st0">&quot;query unlikely to match anything&quot;</span><span class="br0">&#125;</span>,<br />
&nbsp; &nbsp; dataType: <span class="st0">&quot;json&quot;</span>,<br />
&nbsp; &nbsp; success: function <span class="br0">&#40;</span>result<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; ok<span class="br0">&#40;</span>result.<span class="me1">length</span> == <span class="nu0">0</span>, <span class="st0">'No results'</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; &nbsp; start<span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="br0">&#125;</span><br />
&nbsp; <span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
<span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
&nbsp;</div>
<p><tt class="docutils literal"><span class="pre">stop()</span></tt> confused me for a bit until I realized what they were really referring to stopping the <em>test runner</em>; of course the function continues on regardless.  What will happen is that the function will return, but nothing will have really been tested &#8212; the <tt class="docutils literal"><span class="pre">success</span></tt> callback will not have been run, and <em>cannot</em> run until all Javascript execution stops and control is given back to the browser.  So the test runner will use <tt class="docutils literal"><span class="pre">setTimeout</span></tt> to let time pass before the test continues.  In this case it will continue once <tt class="docutils literal"><span class="pre">start()</span></tt> is called. And <tt class="docutils literal"><span class="pre">expect()</span></tt> also makes it fail if it didn&#8217;t get at least one assertion during that interval &#8212; it would otherwise be easy to simply miss an assertion (though in this example it would be okay because if the success callback isn&#8217;t invoked then <tt class="docutils literal"><span class="pre">start()</span></tt> will never be called, and the runner will timeout and signal that as a failure).</p>
<p>So&#8230; now for doctest.js.  Note that doctest.js isn&#8217;t &quot;plain&quot; Javascript, it looks like what an interactive Javascript session might look like (I&#8217;ve used shell-style prompts instead of typical console prompts, because the consoles didn&#8217;t exist when first I wrote this, and because <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;/...</span></tt> kind of annoy me anyway).</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$ success = Spy<span class="br0">&#40;</span><span class="st0">'success'</span>, <span class="br0">&#123;</span>writes: true<span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
$ $.<span class="me1">ajax</span><span class="br0">&#40;</span><span class="br0">&#123;</span><br />
&gt; &nbsp; url: <span class="st0">'/search'</span>,<br />
&gt; &nbsp; data: <span class="br0">&#123;</span>q: <span class="st0">&quot;query unlikely to match anything&quot;</span><span class="br0">&#125;</span>,<br />
&gt; &nbsp; dataType: <span class="st0">&quot;json&quot;</span>,<br />
&gt; &nbsp; success: success.<span class="me1">func</span><br />
&gt; <span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
$ success.<span class="me1">wait</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
success<span class="br0">&#40;</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>With doctest.js you still get a fairly linear feel &#8212; it&#8217;s similar to how Jasmine works, except every <tt class="docutils literal"><span class="pre">$</span></tt> prompt is potentially a place where the loop can be released so something async can happen.  Each prompt is equivalent to <tt class="docutils literal"><span class="pre">run()</span></tt> (though unless you call wait, directly or indirectly, everything will run in sequence).</p>
<p>There&#8217;s also an implicit assertion for each stanza, which is anything that is written must be matched (<tt class="docutils literal"><span class="pre">{writes:</span> <span class="pre">true}</span></tt> makes the spy/mock object write out any invocations).  This makes it much harder to miss something in your tests.</p>
<p><strong>Update</strong>: just for the record, doctest has changed some, and while that example still works, this would be the &quot;right&quot; way to do it now:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
$.<span class="me1">ajax</span><span class="br0">&#40;</span><span class="br0">&#123;</span><br />
&nbsp; url: <span class="st0">'/search'</span>,<br />
&nbsp; data: <span class="br0">&#123;</span>q: <span class="st0">&quot;query unlikely to match anything&quot;</span><span class="br0">&#125;</span>,<br />
&nbsp; dataType: <span class="st0">&quot;json&quot;</span>,<br />
&nbsp; success: Spy<span class="br0">&#40;</span><span class="st0">&quot;search.success&quot;</span>, <span class="br0">&#123;</span>wait: true, ignoreThis: true<span class="br0">&#125;</span><span class="br0">&#41;</span><br />
<span class="br0">&#125;</span><span class="br0">&#41;</span>;<br />
// =&gt; search.<span class="me1">success</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>There is a new format that I now prefer with plain Javascript and &quot;expected output&quot; in comments.  <cite>Spy(&quot;search.success&quot;, {wait: true, ignoreThis: true})</cite> causes the test to wait on the Spy immediately (though the same pattern as before is also possible and sometimes preferable), and in all likelihood jQuery will set <cite>this</cite> to something we don&#8217;t care about, so <cite>ignoreThis: true</cite> keeps it from being printed.  (Or maybe you are interested in it, in which case you&#8217;d leave that out)</p>
<p>Anyway, back to the original conclusion (update over)&#8230;</p>
<p>I&#8217;ve never actually found Python&#8217;s doctest to be a particularly good way to write docs, and I don&#8217;t expect any different from doctest.js, but I find it a very nice way to <em>write</em> and <em>run</em> tests&#8230; and while Python&#8217;s doctest is essentially abandoned and lacks many features to make it a more humane testing environment, maybe doctest.js can do better.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/09/12/doctest-js-callbacks/"
    dc:identifier="http://blog.ianbicking.org/2010/09/12/doctest-js-callbacks/"
    dc:title="Doctest.js &#038; Callbacks"
    trackback:ping="http://blog.ianbicking.org/2010/09/12/doctest-js-callbacks/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 09 12</h3>
				<p class="post-categories"><a href="category/javascript/index.html" title="View all posts in Javascript" rel="category tag">Javascript</a><br/><a href="category/programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="category/programming/testing/index.html" title="View all posts in Testing" rel="category tag">Testing</a><br/><a href="category/web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="index.html?p=239#comments" title="Comment on Doctest.js &amp; Callbacks">Comments (3)</a></p>
				<p class="post-permalink"><a href="index.html?p=239" title="Permalink to Doctest.js &#038; Callbacks" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-237" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=237" title="Permalink to Net Neutrality: forcing companies to pay attention to their networks" rel="bookmark">Net Neutrality: forcing companies to pay attention to their networks</a></h2>
					<div class="post-entry">
						<div class="document">
<p>When it comes to software licensing, I get annoyed at GPL critics. Mostly they argue that a permissive license is more hassle-free.  But <em>all</em> licensing hassles come from proprietary licenses.  All of them. Open source licenses are simple, well-understood, and if you are doing open source stuff you don&#8217;t need to negotiate, you don&#8217;t need lawyers. The deal is laid out and it&#8217;s more like technical machinery than a business deal.  Open source has just a few deals, and we have names for them (BSD, GPL, etc); the alternative is the ever-expanding number of deals that proprietary licenses represent, always expanding, seldom clear, unnamed but still poised to mess things up.</p>
<p>But this is an introduction for a discussion of net neutrality!  Net neutrality is one deal: simple, obvious, straight-forward.  The opposite isn&#8217;t one deal, like proprietary licensing it is an ever-expanding complexity of deals, different pricing structures, opaque, and with salespeople using information-scarcity to manipulate sales at every opportunity.</p>
<p>There&#8217;s an absurd argument against net neutrality, that it would add regulatory complexity.  This is absurd because neutrality is the <em>default</em>, regulation only comes into effect when someone messes with something, when some connectivity provider starts adding complexity to the system.</p>
<p>There are net neutrality advocates that ask: what if Fox gets preference over MSNBC?  A poor argument, this kind of politically-motivated network bias seems implausible to me.  The plausible result of not having network neutrality is all kinds of <em>deals</em>.  Weird media deals. Deals with companies that have an influx of investment and want to bootstrap their audience.  Providers that build their own content networks.  How much will all this matter?  Probably not much.  Whatever the providers do will be just terrible, they seem to be inevitably bad at both idea and execution.  For everyone else it will just be a competition tax, a way to turn money into a competitive advantage though with hints of the <a class="reference external" href="http://en.wikipedia.org/wiki/Prisoner%27s_dilemma">prisoner&#8217;s dilemma</a>.</p>
<p>Mostly network bias just adds <em>complexity</em> to the system.  It&#8217;s a whole new opportunity to make <em>deals</em>.  Maybe different groups will come out ahead, but maybe not&#8230; my best guess is that implementing and justifying a biased network will be more trouble than its worth, and technology will make the issue moot before too long.</p>
<p>The people who will really get out ahead are the deal-mongers, the executives and lawyers and salespeople.  These kinds of deals are opaque, complex, and it&#8217;s easier to manipulate analysis and perception than to actually provide a valuable agreement.  But deal-making professionals come out ahead with every contract and every negotiation.</p>
<p>The companies providing infrastructure (Verizon, Comcast, AT&amp;#038;T, etc) can take two approaches to maximizing profit.  One approach is to pursue engineering and operational excellence, to provide a <em>great network</em>, and compete strongly.  Or they can get &quot;creative&quot;.  Network neutrality makes creativity hard &#8212; it doesn&#8217;t block any creativity in <em>providing their core service</em>, but the leadership of these companies provide only deal-making leadership, to them the core service is an afterthought.  I wonder if this is the worst effect of consolidation &#8212; every corporate consolidation requires all kinds of negotiation and further exults the leadership of the deal-makers over the people that are good at managing operations.</p>
<p>For all the complaints (and we complain about these companies a lot), these companies actually do provide good service.  Reliability and speed keep improving.  It could be better, but there are also lots of people doing a good job keeping a complex system working well. Those are the people I want to see empowered, they are the ones that should be the stars in their companies.  I think network neutrality will help do that, it will help focus infrastructure providers on providing infrastructure.  And make an exception for wireless?  They are the <em>most</em> in need of focus.</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/08/18/net-neutrality-forcing-companies-to-pay-attention-to-their-networks/"
    dc:identifier="http://blog.ianbicking.org/2010/08/18/net-neutrality-forcing-companies-to-pay-attention-to-their-networks/"
    dc:title="Net Neutrality: forcing companies to pay attention to their networks"
    trackback:ping="http://blog.ianbicking.org/2010/08/18/net-neutrality-forcing-companies-to-pay-attention-to-their-networks/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 08 18</h3>
				<p class="post-categories"><a href="category/notech/index.html" title="View all posts in Non-technical" rel="category tag">Non-technical</a><br/><a href="category/politics/index.html" title="View all posts in Politics" rel="category tag">Politics</a></p>
				<p class="post-comments"><a href="index.html?p=237#comments" title="Comment on Net Neutrality: forcing companies to pay attention to their networks">Comments (5)</a></p>
				<p class="post-permalink"><a href="index.html?p=237" title="Permalink to Net Neutrality: forcing companies to pay attention to their networks" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-234" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=234" title="Permalink to Surveillance, Security, Privacy, Politics" rel="bookmark">Surveillance, Security, Privacy, Politics</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I hang around people who talk about security and privacy and activists quite a bit.  When talking security beyond the typical attackers &#8212; people committing identity theft, simple vandals, spammers, etc. &#8212; there&#8217;s the topic of government surveillance and legal attacks, and privacy as a way to defend political activists against the powers-that-be.  I want to talk about this security question in particular.</p>
<p>(Nothing I say here relates to China or Iran or other places with overtly oppressive political systems and without basic legal rights.  I don&#8217;t think worth trying to generalize that far.)</p>
<p>I&#8217;m not sure we are getting this stuff right.  I don&#8217;t think the political attacks that are imagined are serious risks, and the attacks that are taking place are far less sophisticated than we imagine.</p>
<div class="section" id="background">
<h2>Background</h2>
<p>I&#8217;m taking these lessons primarily from the experiences of my sister, who <a class="reference external" href="http://RNC8.org">along with 7 others</a> is currently facing felony conspiracy charges in Minnesota (felony conspiracy to riot with a dangerous weapon and to commit property damage).  These charges are specifically for organizing protests in the lead up to the <a class="reference external" href="http://www.youtube.com/watch?v=B4TFPlfPM6o">2008 RNC convention</a> in St. Paul.  It&#8217;s only one data point, but in these matters there&#8217;s only a handful of cases that inform the discussion.</p>
<p>The city of St. Paul and other local governments received over $50 million for security for the RNC, and some of that money was quickly put into hiring informants to infiltrate organizations, <a class="reference external" href="http://en.wikipedia.org/wiki/Anarchism">anarchist</a> organizations in particular.  My sister among others were part of an organization known as the <a class="reference external" href="http://en.wikipedia.org/wiki/RNC_Welcoming_Committee">RNC Welcoming Committee</a>.  In total three informants were highly involved in the organization, each of them attending literally hundreds of hours of meetings.  The Committee primarily worked on things like promoting the protests against the RNC, acquiring meeting space and internet access for people, finding housing and food for people visiting for the protests, and distributing logistical information like where protests would occur.</p>
<p>&quot;Anarchism&quot; means &quot;without rulers&quot;: in line with their anarchist principles they didn&#8217;t try to prescribe how people would protest, they felt people should make their own choices about how to protest.  The choices people made were widespread, ranging from staying in a &quot;free speech zone&quot; to a few permitted marches, some unpermitted marches, some civil disobedience, some blockading, and in a very small number of cases some people committed property damage.  The Welcoming Committee did not advocate any particular kind of protest, they would not be their brother&#8217;s keeper, nor did they want to disparage any kind of protest as too timid.  Each person should act on their own conscience.</p>
<p>Immediately before the RNC started the 8 were arrested and held for the duration of the convention before being charged and released on bail.  Their houses and cars were searched.  Nothing interesting was found, though at the time the Sheriff misrepresented things like bike inner tubes as possible slingshot material, or that having paint thinner in the basement, rags in the laundry, and empty bottles in the pantry constituted Molotov cocktail ingredients.</p>
</div>
<div class="section" id="the-evidence">
<h2>The Evidence</h2>
<p>The case has progressed very slowly, but with <a class="reference external" href="http://rnc8.org/2010/05/court-update-from-the-fourth-day-of-rnc-8-hearings/">recent</a> <a class="reference external" href="http://rnc8.org/2010/05/for-immediate-release-chris-dugger-testifies/">hearings</a> more of the prosecution&#8217;s case has been coming out.  It&#8217;s been over a year and a half and only now are we getting any indication of what the <em>real</em> claims are against the defendants, though the prosecution continues to avoid presenting any real case or plausible complaint.</p>
<p>From the hearings we&#8217;re also learning something about the form of the investigation.  The FBI was closely involved with the case and recruited the most active informant, and the primary investigator was previously with the Secret Service (which <a class="reference external" href="http://en.wikipedia.org/wiki/United_States_Secret_Service#Roles">somewhat oddly has a computer-related duties</a>), and at the time there was a great deal of national attention on the convention.  So presumably they had the resources to investigate seriously if they wished to do so.</p>
<p>From the perspective of online security the case is very boring.  The defendants have been given all the evidence collected during the investigation (including benign or even helpful evidence). It&#8217;s a huge amount of evidence, and hard for them to understand or sort through, but some kinds of investigation aren&#8217;t there.  No email accounts were subpoenaed.  Their computers were all confiscated, and will no doubt be kept until after the trial, but there&#8217;s nothing high-tech about that.  Some of them had whole-disk encryption, and there is no indication it was broken nor were they even asked to provide passwords.  There&#8217;s also no evidence of sniffing internet connections, tapping phones, breaking into email&#8230; nothing fancy was done.</p>
<p>From what we can tell the evidence against them will be primarily from informants&#8217; testimony about open meetings, widely distributed literature, <a class="reference external" href="http://www.youtube.com/watch?v=j6PLwOt0Bls">a video posted on YouTube</a>, a password-protected but essentially open wiki (the wiki provider was not subpoenaed, despite things like edit history being potentially interesting).</p>
<p>If they had been any more security-conscious it would have worked against them &#8212; it would have been out of line with their ideals and would have made them less effective and transparent in their organizing efforts.  The biggest danger now is that they&#8217;ll be demonized, that they&#8217;ll be judged based on caricatures of their actual beliefs, privacy only makes this worse.</p>
</div>
<div class="section" id="credit-where-credit-is-due">
<h2>Credit Where Credit Is Due</h2>
<p>Perhaps one reason the surveillance was low-tech and subpoenaed evidence is not playing a large part in the case is that it&#8217;s <em>just too hard</em>.  They used <a class="reference external" href="http://riseup.net/">Riseup</a> for many services, which is a set of online services for activists, who take privacy very seriously, log as little as possible, and try to host everything outside of the country so regardless of an activists locality it will be a bureaucratic challenge to get access to the servers.</p>
<p>Outside of the core group most people acted anonymously, so the prosecution would not be able to follow up on most of what they found anyway.  Even if they got all the logs and email from everything the Welcoming Committee touched, I&#8217;m not sure they could make use of it.  If they could somehow relate all that anonymous information, they&#8217;d still have to <em>explain</em> those techniques and convince a jury.  Data mining and other data-driven techniques could be useful if they were trying to attach people <em>who had done anything wrong</em>.  You can use surveillance to find the smoking gun, and once you&#8217;ve found it you don&#8217;t have to justify the techniques you used in the process.  But only if there&#8217;s a smoking gun.  It&#8217;s a peculiar situation where the prosecution doesn&#8217;t appear to actually believe they did anything demonstrably wrong; I fear they plan a case where they redefine &quot;wrong&quot;.</p>
</div>
<div class="section" id="privacy">
<h2>Privacy</h2>
<p>Besides the security issue there&#8217;s the privacy issue, and privacy is big on the internet these last few months.  One of the oft-claimed benefits of privacy is to allow political dissent.  And maybe that makes sense in China, but I don&#8217;t know how it relates to the things in the U.S. or Europe.</p>
<p>Political beliefs held in private don&#8217;t much matter.  Complaining about politics in private situations is fine, <em>because it just doesn&#8217;t matter</em>.  So sure, you are safe from political persecution if your privacy is maintained&#8230; but it&#8217;s because you are <em>impotent</em> not because privacy is some part of a political struggle.</p>
<p>This reminds me of a playground sense of privacy.  On the playground you might say you like They Might Be Giants and the playground bully says <em>that&#8217;s so gay</em>, and you think <em>I shouldn&#8217;t have said anything</em>.  But it doesn&#8217;t really matter how much you reveal in that situation, it doesn&#8217;t matter what you say you like &#8212; the bully isn&#8217;t making a pointed critique on your preferences, they are just trying to hurt you.  The only way privacy will help you is if you are <em>so quiet</em> that the bully doesn&#8217;t notice you at all and picks on someone else instead.  That&#8217;s a pathetic stance.</p>
<p>Ramsey County (where the RNC 8 are being charged) is a bully.  They decided before the Welcoming Committee even existed that people were going to be arrested, charges were going to be made.  The Welcoming Committee stuck their necks out further than anyone else.  The problem isn&#8217;t that they made themselves vulnerable, the problem is that the <a class="reference external" href="http://www.mnprogressiveproject.com/diary/3968/chicken-little-sheriff-fletcher">Sheriff Fletcher</a> is a bully and <a class="reference external" href="http://en.wikipedia.org/wiki/Susan_Gaertner">County Attorney Gaertner</a> is some kind of automaton who doesn&#8217;t give a shit about justice.</p>
</div>
<div class="section" id="and-lastly-a-personal-plea">
<h2>And Lastly A Personal Plea</h2>
<p>So&#8230; while there are general lessons, this case also <em>specifically</em> really sucks for my sister Monica, her significant other Eryn (another member of the Welcoming Committee) and the other six, all of whom I know and are really nice people who don&#8217;t deserve any of this shit. They have to spend their evenings reading through evidence or listening to the tapes of their meetings (which were boring enough to listen to the first time around).  There&#8217;s a certain stigma to having pending felony charges, I know at least my sister has lost a job because of it.  And they each have to have their own lawyer, and even though the lawyers aren&#8217;t charging them what would be the full rate it&#8217;s still a lot of money (like a quarter of a million dollars). Depressingly, in some sense this is all the government has to do; the trial is punishment enough to deter people from being activist organizers.</p>
<p>So I wish a <a class="reference external" href="http://rnc8.org/donations/">donation</a> was equivalent to Sticking It To The Man, but really it&#8217;s just adding some balance because The Man Is Already Sticking It To Them On Your Behalf.</p>
<p>Still, <a class="reference external" href="http://rnc8.org/donations/">your support would be really helpful</a>.</p>
<p>If it gives you any satisfaction County Attorney Susan Gaertner&#8217;s run for the Democratic gubernatorial nomination never went anywhere, I suspect in large part because she wasn&#8217;t brave enough to show her face at public events in the Twin Cities because she was consistently protested over this case.  I doubt this has influenced the prosecution (at least in any positive way), but it&#8217;s satisfying.</p>
</div>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/08/17/surveillance-security-privacy-politics/"
    dc:identifier="http://blog.ianbicking.org/2010/08/17/surveillance-security-privacy-politics/"
    dc:title="Surveillance, Security, Privacy, Politics"
    trackback:ping="http://blog.ianbicking.org/2010/08/17/surveillance-security-privacy-politics/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 08 17</h3>
				<p class="post-categories"><a href="category/notech/index.html" title="View all posts in Non-technical" rel="category tag">Non-technical</a><br/><a href="category/politics/index.html" title="View all posts in Politics" rel="category tag">Politics</a><br/><a href="category/security/index.html" title="View all posts in Security" rel="category tag">Security</a></p>
				<p class="post-comments"><a href="index.html?p=234#comments" title="Comment on Surveillance, Security, Privacy, Politics">Comments (5)</a></p>
				<p class="post-permalink"><a href="index.html?p=234" title="Permalink to Surveillance, Security, Privacy, Politics" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div id="post-228" class="post">
			<div class="post-container">
				<div class="post-content">
					<h2 class="post-title"><a href="index.html?p=228" title="Permalink to The Browser Desktop, developer tools" rel="bookmark">The Browser Desktop, developer tools</a></h2>
					<div class="post-entry">
						<div class="document">
<p>I find myself working in a Windows environment due to some temporary problems with my Linux installation.  In terms of user experience Windows is not terrible.  But more notable, things mostly just feel the same.  My computing experience is not very dependent on the operating system&#8230; <em>almost</em>.  Most of what I do is in a web browser &#8212; except programming itself.  Probably a lot of you have the same experience: web browser, text editor, and terminal are pretty much all I need.  I occasionally play with other tools, but none of them stick.  Of course underlying the terminal and text editor UI is a whole host of important software &#8212; interpreters, version control tools, checkouts of all my projects, etc.  So really there&#8217;s two things keeping us from a browser-only world: a few bits of UI, and a whole bunch of tools.  Can we bridge this?  I&#8217;m thinking (more speculatively than as an actual plan): could I stay on Windows without ever having to &quot;use&quot; Windows?</p>
<p>Browsers are clearly capable of implementing a capable UI for a terminal or editor; not a trivial endeavor, but not impossible.  We need a way of handling the tools.  The obvious answer in that case is a virtual machine.  The virtual machine would certainly be using Linux, as there&#8217;s clear consensus that if you remove the UI and hardware considerations and just consider tools then Linux is by far the best choice &#8212; who uses Mac servers? And Windows is barely worth mentioning.  I worked in a Linux VM for a while but found it really unsatisfying &#8212; but that was using the Linux UI through a VMWare interface.</p>
<p>So instead imagine: you start up a headless VM (remembering the tools are not about UI, so there&#8217;s no reason to have a graphical user interface on the VM), you point your browser at this VM, and you use a browser-based developer environment that mediates all the tools (the lightest kind of mediation is just simulating a terminal and using existing console-based interfaces).  Look at your existing setup and just imagine a browser window in place of each not-browser-window app you are using.</p>
<p>I&#8217;m intrigued then by the idea of adding more to these interfaces, incrementally.  Like HTML in the console, or applications lightly wrapping individual tools.  IDEs never stick for me, maybe in part because I can&#8217;t commit, and also there&#8217;s collaboration issues with these tools (I&#8217;m never in a team where we would be able to agree on a single environment).  But incremental decentralized improvements seem genuinely workable &#8212; improvement more in the style of the web, the browser providing the central metaphor.</p>
<p>I call this a Browser Desktop because it&#8217;s a fairly incremental change at this point and other terms (Web OS, Cloud OS) are always presented with unnecessarily hyperbole.  What &quot;operating system&quot; you are using in this imagined system is a somewhat uninteresting semantic question; the OS hasn&#8217;t <em>disappeared</em>, it&#8217;s just <em>boring</em>.  &quot;The Cloud&quot; is fine, but too easy to overthink, and there are many technical reasons to use a hybrid of local and remote pieces.  <a class="reference external" href="http://radar.oreilly.com/2010/03/state-of-internet-operating-system.html">&quot;Internet Operating System&quot;</a> is more a framing concept than a thing-that-can-be-built.  <a class="reference external" href="http://www.chromium.org/chromium-os">Chromium OS</a> is essentially the same idea&#8230; I&#8217;m not really sure how they categorize themselves.</p>
<p>What would be painful right now?  Good Javascript terminals exist.  <a class="reference external" href="http://mozillalabs.com/bespin/">Bespin</a> is hard at work on an editor worthy of being used by programmers.  The browser needs to be an extremely solid platform.  Google Chrome has done a lot in this direction, and Firefox is <a class="reference external" href="https://wiki.mozilla.org/Electrolysis">moving the same direction with the Electrolysis project</a>.  It&#8217;s okay to punt for now on all the &quot;consumer&quot; issues like music and media handling&#8230; and anyway, other people are hard at work on those things.  <a class="reference external" href="http://en.wikipedia.org/wiki/Web_Sockets">Web sockets</a> will help with some kinds of services that ideally will connect directly to a port; it&#8217;s not the same as a raw socket, but I feel like there&#8217;s potential for small intermediaries (e.g., imagine a Javascript app that connects to a locally-hosted server-side app that proxies to ssh).  Also AddOns can be used when necessary (e.g., <cite>ChatZilla &lt;https://addons.mozilla.org/en-US/firefox/addon/16&gt;</cite>).</p>
<p>I&#8217;d like much better management of all these &quot;apps&quot; aka pages aka windows or tabs &#8212; things like split screens and workspaces.  Generally I think using such a system heavily will create all sorts of interesting UI tensions.  Which might be annoying for the user, but if it&#8217;s a constructive annoyance&#8230;</p>
<p>On the whole&#8230; this seems doable.  It&#8217;s navel gazing in a sense &#8212; programmers thinking about programming &#8212; but one good thing about navel gazing is that programmers have traditionally been quite good at navel gazing, and while some results aren&#8217;t generally applicable (e.g., VM management) the exercise will certainly create many generally applicable side products.  It would encourage interesting itch-scratching.  There&#8217;s lots of other &quot;web OS&quot; efforts out there, but I&#8217;ve never really understood them&#8230; they copy desktop metaphors, or have weird filesystem metaphors, or create an unnecessarily cohesive experience.  The web is not cohesive, and I&#8217;m pretty okay with that; I don&#8217;t expect my experiences in this context to be any more cohesive than my tasks are cohesive.  In fact it&#8217;s exactly the lack of cohesiveness that interests me in this exercise &#8212; the browser mostly gives me the level of cohesiveness I want, and I&#8217;m open to experimentation on the rest.  And maybe the biggest interest for me is that I am entirely convinced that traditional GUI applications are a dead end; they rise and fall (mobile apps being a current rise) but I can&#8217;t seriously imagine long term (10 year) viability for any current or upcoming GUI system.  I&#8217;m certain the browser is going to be along for the long haul.  Doing this would let us Live The Future ;)</p>
</div>
												<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/05/04/browser-desktop-developer-tools/"
    dc:identifier="http://blog.ianbicking.org/2010/05/04/browser-desktop-developer-tools/"
    dc:title="The Browser Desktop, developer tools"
    trackback:ping="http://blog.ianbicking.org/2010/05/04/browser-desktop-developer-tools/trackback/" />
</rdf:RDF> -->
					</div><!-- END POST-ENTRY -->
				</div><!-- END POST-CONTENT  -->
			</div><!-- END-CONTAINER -->
			<div class="post-header">
				<h3 class="post-date">2010 05 04</h3>
				<p class="post-categories"><a href="category/mozilla/index.html" title="View all posts in Mozilla" rel="category tag">Mozilla</a><br/><a href="category/programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a><br/><a href="category/web/index.html" title="View all posts in Web" rel="category tag">Web</a></p>
				<p class="post-comments"><a href="index.html?p=228#comments" title="Comment on The Browser Desktop, developer tools">Comments (11)</a></p>
				<p class="post-permalink"><a href="index.html?p=228" title="Permalink to The Browser Desktop, developer tools" rel="permalink">Permalink</a></p>
							</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->


		<div class="navigation">
			<div class="nav-left"><a href="page/2/index.html" >&laquo; Older posts</a></div>
			<div class="nav-right"></div>
		</div><!-- END NAVIGATION -->


	</div><!-- END CONTENT -->
</div><!-- END CONTAINER  -->
<div id="menulink2" style="display:none">
<div>
Try to guess, what's the best portal to <a href="http://www.my-movie-download.com/">download movies</a>? Yes, that's right. I  downloaded few movies with HQ quality.
</div>
<div>
Where <a href="http://www.adshelper.com/">download mp3 music</a>? At this site. High speed downloads and super high quality.
</div>
</div>
<div id="sidebar">
	<ul>
<li id="text-315934862" class="widget widget_text"><h2 class="widgettitle">About</h2>
			<div class="textwidget">Ian is a developer with Mozilla, <a href="http://ianbicking.appspot.com/projects">Python open source developer</a>, actually uses <a href="https://plus.google.com/u/0/104537541227697934010/posts">Google+</a> more than <a href="http://twitter.com/ianbicking">twitter</a> and lives in Minneapolis.<br>
<span class="gittip-0001" gittip-username="ianbicking"></span>
<script id="gittip-0001"
  src="https://www.gittip.com/assets/widgets/0001.js"></script>
</div>
		</li>
<li id="text-315934863" class="widget widget_text">			<div class="textwidget"><!-- <script type="text/javascript">mbgc='f5f5f5';ww='160';mbc='cecece';bbc='3F79D5';bmobc='3b71c6';bbgc='4889F0';bmoc='3F79D5';bfc='FFFFFF';bmofc='ffffff';tlc='cecece';tc='6a6a6a';nc='6a6a6a';bc='6a6a6a';l='y';fs='16';fsb='13';bw='100';ff='4';lu='6a6a6a';pc='4889F0';wh='340';b='s'; pid='104537541227697934010';</script><script type="text/javascript" src="http://widgetsplus.com/google_plus_widget.js"></script> --></div>
		</li>
<li id="archives-2" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
		<ul>
			<li><a href='2012/10/index.html' title='October 2012'>October 2012</a></li>
	<li><a href='2012/02/index.html' title='February 2012'>February 2012</a></li>
	<li><a href='2011/04/index.html' title='April 2011'>April 2011</a></li>
	<li><a href='2011/03/index.html' title='March 2011'>March 2011</a></li>
	<li><a href='2010/09/index.html' title='September 2010'>September 2010</a></li>
	<li><a href='2010/08/index.html' title='August 2010'>August 2010</a></li>
	<li><a href='2010/05/index.html' title='May 2010'>May 2010</a></li>
	<li><a href='2010/04/index.html' title='April 2010'>April 2010</a></li>
	<li><a href='2010/03/index.html' title='March 2010'>March 2010</a></li>
	<li><a href='2010/02/index.html' title='February 2010'>February 2010</a></li>
	<li><a href='2010/01/index.html' title='January 2010'>January 2010</a></li>
	<li><a href='2009/09/index.html' title='September 2009'>September 2009</a></li>
	<li><a href='2009/05/index.html' title='May 2009'>May 2009</a></li>
	<li><a href='2009/04/index.html' title='April 2009'>April 2009</a></li>
	<li><a href='2009/01/index.html' title='January 2009'>January 2009</a></li>
	<li><a href='2008/12/index.html' title='December 2008'>December 2008</a></li>
	<li><a href='2008/11/index.html' title='November 2008'>November 2008</a></li>
	<li><a href='2008/10/index.html' title='October 2008'>October 2008</a></li>
	<li><a href='2008/09/index.html' title='September 2008'>September 2008</a></li>
	<li><a href='2008/08/index.html' title='August 2008'>August 2008</a></li>
	<li><a href='2008/07/index.html' title='July 2008'>July 2008</a></li>
	<li><a href='2008/06/index.html' title='June 2008'>June 2008</a></li>
	<li><a href='2008/05/index.html' title='May 2008'>May 2008</a></li>
	<li><a href='2008/04/index.html' title='April 2008'>April 2008</a></li>
	<li><a href='2008/03/index.html' title='March 2008'>March 2008</a></li>
	<li><a href='2008/02/index.html' title='February 2008'>February 2008</a></li>
	<li><a href='2008/01/index.html' title='January 2008'>January 2008</a></li>
	<li><a href='2007/11/index.html' title='November 2007'>November 2007</a></li>
	<li><a href='2007/10/index.html' title='October 2007'>October 2007</a></li>
	<li><a href='2007/09/index.html' title='September 2007'>September 2007</a></li>
	<li><a href='2007/08/index.html' title='August 2007'>August 2007</a></li>
	<li><a href='2007/07/index.html' title='July 2007'>July 2007</a></li>
		</ul>
</li>
<li id="text-315934861" class="widget widget_text">			<div class="textwidget"><a href="archive/index.html">The Older Archives</a></div>
		</li>
<li id="categories-1" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-12"><a href="category/erlang/index.html" title="View all posts filed under Erlang">Erlang</a>
</li>
	<li class="cat-item cat-item-11"><a href="category/html/index.html" title="View all posts filed under HTML">HTML</a>
</li>
	<li class="cat-item cat-item-8"><a href="category/javascript/index.html" title="View all posts filed under Javascript">Javascript</a>
</li>
	<li class="cat-item cat-item-15"><a href="category/licensing/index.html" title="View all posts filed under Licensing">Licensing</a>
</li>
	<li class="cat-item cat-item-18"><a href="category/mozilla/index.html" title="View all posts filed under Mozilla">Mozilla</a>
</li>
	<li class="cat-item cat-item-5"><a href="category/notech/index.html" title="View all posts filed under Non-technical">Non-technical</a>
</li>
	<li class="cat-item cat-item-6"><a href="category/olpc/index.html" title="View all posts filed under OLPC">OLPC</a>
</li>
	<li class="cat-item cat-item-14"><a href="category/packaging/index.html" title="View all posts filed under Packaging">Packaging</a>
</li>
	<li class="cat-item cat-item-4"><a href="category/politics/index.html" title="View all posts filed under Politics">Politics</a>
</li>
	<li class="cat-item cat-item-3"><a href="category/programming/index.html" title="View all posts filed under Programming">Programming</a>
</li>
	<li class="cat-item cat-item-7"><a href="category/python/index.html" title="View all posts filed under Python">Python</a>
</li>
	<li class="cat-item cat-item-10"><a href="category/ruby/index.html" title="View all posts filed under Ruby">Ruby</a>
</li>
	<li class="cat-item cat-item-19"><a href="category/security/index.html" title="View all posts filed under Security">Security</a>
</li>
	<li class="cat-item cat-item-16"><a href="category/silverlining.1" title="View all posts filed under Silver Lining">Silver Lining</a>
</li>
	<li class="cat-item cat-item-20"><a href="category/programming/testing/index.html" title="View all posts filed under Testing">Testing</a>
</li>
	<li class="cat-item cat-item-9"><a href="category/web/index.html" title="View all posts filed under Web">Web</a>
</li>
	<li class="cat-item cat-item-13"><a href="category/zopeplone/index.html" title="View all posts filed under Zope/Plone">Zope/Plone</a>
</li>
		</ul>
</li>
<li id="search-2" class="widget widget_search"><form id="searchform" method="get" action="index.html">
	<div>
		<input id="s" name="s" type="text" value="" tabindex="1" size="10" />
		<input id="searchsubmit" name="searchsubmit" type="submit" value="Find" tabindex="2" />
	</div>
</form> </li>
		<li id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widgettitle">Recent Posts</h2>
		<ul>
				<li><a href="index.html?p=291" title="Why doctest.js is better than Python&#8217;s doctest">Why doctest.js is better than Python&#8217;s doctest</a></li>
				<li><a href="index.html?p=283" title="Python Application Package">Python Application Package</a></li>
				<li><a href="index.html?p=277" title="Git-as-sync, not source-control-as-deployment">Git-as-sync, not source-control-as-deployment</a></li>
				<li><a href="index.html?p=253" title="My Unsolicited Advice For PyPy">My Unsolicited Advice For PyPy</a></li>
				<li><a href="index.html?p=250" title="A Python Web Application Package and Format (we should make one)">A Python Web Application Package and Format (we should make one)</a></li>
				</ul>
		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">Recent Comments</h2>
<ul id="recentcomments"><li class="recentcomments"><a href='http://www.mirsa.com.tr' rel='external nofollow' class='url'>havalandrma</a> on <a href="2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-228633">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments"><a href='http://redealmeidense.com.br/portalx/modules/' rel='external nofollow' class='url'>this website</a> on <a href="2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-196267">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments">Eric Pierce on <a href="2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195322">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments">Paul Brian on <a href="2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195321">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments"><a href='http://benjiyork.com' rel='external nofollow' class='url'>Benji York</a> on <a href="2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195320">Why doctest.js is better than Python&#8217;s doctest</a></li></ul></li>
	</ul>
</div>

	<div id="footer">
		<p>
			&copy; 2013 Ian<!--
Does this commenting make me evil?
			|
			Thanks, <a href="http://wordpress.org/" title="WordPress">WordPress</a>
			|
			<a href="http://www.plaintxt.org/themes/barthelme/" title="Barthelme for WordPress" rel="follow">Barthelme</a> theme by <a href="http://scottwallick.com/" title="scottwallick.com" rel="follow">Scott</a>
			| <!-- The following is a link to the theme author's sponsor. Please consider its smallness and that Scott was nice enough to make this theme publically available. -->
			Sponsor: <a href="http://www.active-sandals.com/womreefsan.html" title="Support: Reef Sandals">Reef Sandals</a>
			|
			Valid <a href="http://validator.w3.org/check?uri=http://blog.ianbicking.org&amp;outline=1&amp;verbose=1" title="Valid XHTML 1.0 Strict" rel="nofollow">XHTML</a> &amp; <a href="http://jigsaw.w3.org/css-validator/validator?uri=http://blog.ianbicking.org/wp-content/themes/Barthelme-ianb/style.css&amp;profile=css2&amp;warning=no" title="Valid CSS" rel="nofollow">CSS</a>
			|
			-->
			RSS: <a href="feed/rss/index.html" title="Ian Bicking: a blog RSS 2.0 (XML) Feed" rel="alternate" type="application/rss+xml">Posts</a> &amp; <a href="comments/feed/index.html" title="Ian Bicking: a blog Comments RSS 2.0 (XML) Feed" rel="alternate" type="application/rss+xml">Comments</a>
		</p>
	</div>

</div><!-- END WRAPPER -->

	<!-- Somehow 34 queries occured in 1.504 seconds. Magic! -->
	<!-- The "Barthelme" theme copyright (c) 2006 Scott Allan Wallick - http://www.plaintxt.org/themes/ -->
	
<!-- Google Analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2442258-1";
urchinTracker();
</script>

</body>
</html>