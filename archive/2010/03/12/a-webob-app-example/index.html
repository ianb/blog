<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- MOBIFY - DO NOT ALTER - PASTE IMMEDIATELY AFTER OPENING HEAD TAG -->
<script type="text/javascript">/*<![CDATA[*/(function(a){function b(a,b){if(+a)return~a||(d.cookie=h+"=; path=/");j=d.createElement(e),k=d.getElementsByTagName(e)[0],j.src=a,b&&(j.onload=j.onerror=b),k.parentNode.insertBefore(j,k)}function c(){n.api||b(l.shift()||-1,c)}if(this.Mobify)return;var d=document,e="script",f="mobify",g="."+f+".com/",h=f+"-path",i=g+"un"+f+".js",j,k,l=[!1,1],m,n=this.Mobify={points:[+(new Date)],tagVersion:[6,0]},o=/(; |#|&|^)mobify-path=([^&;]*)/g.exec(location.hash+"; "+d.cookie);o?(m=o[2])&&!+(m=sessionStorage[h]||m)&&(l=[!0,"//preview"+g+escape(m)]):(l=a()||l,l[0]&&l.push("//cdn"+i,"//files01"+i)),l.shift()?(d.write('<plaintext style="display:none;">'),setTimeout(c)):b(l[0])})(function(){if(/ip(hone|od)|android.*(mobile)|blackberry.*applewebkit/i.test(navigator.userAgent)){return[1,"//cdn.mobify.com/sites/ians-blog/production/mobify.js"]}})/*]]>*/</script>
<!-- END MOBIFY -->
	<title>Ian Bicking: a blog   ::  What Does A WebOb App Look Like? </title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="generator" content="WordPress 3.4.2" /><!-- LEAVE FOR STATS -->
	<meta name="description" content="" />
	<link rel="stylesheet" title="plaintxtSimpler" href="../../../../wp-content/themes/Barthelme-ianb/style.css" type="text/css" media="all" />
	<link rel="start" href="../../../../index.html" title="Ian Bicking: a blog" />
	<link rel="alternate" type="application/atom+xml" title="Ian Bicking: a blog Atom Feed" href="../../../../feed/atom/index.html" />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog RSS 2.0 Feed" href="../../../../feed/rss/index.html" />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog Comments RSS 2.0 Feed" href="../../../../comments/feed/index.html" />
	<link rel="alternate" type="application/rdf+xml" title="Ian Bicking: a blog RSS 1.0" href="../../../../feed/rdf/index.html" />
	<link rel="alternate" type="text/xml" title="Ian Bicking: a blog RSS 0.92 Feed" href="../../../../feed/rss/index.html" />
	<link rel="pingback" href="../../../../xmlrpc.php" />
	<link rel="openid.server" href="http://www.myopenid.com/server" />
	<link rel="openid.delegate" href="http://ianb.myopenid.com" />
        <link rel="me" type="text/html" href="http://www.google.com/profiles/ianbicking"/>
		<link rel='archives' title='October 2012' href='../../../../2012/10/index.html' />
	<link rel='archives' title='February 2012' href='../../../../2012/02/index.html' />
	<link rel='archives' title='April 2011' href='../../../../2011/04/index.html' />
	<link rel='archives' title='March 2011' href='../../../../2011/03/index.html' />
	<link rel='archives' title='September 2010' href='../../../09/index.html' />
	<link rel='archives' title='August 2010' href='../../../08/index.html' />
	<link rel='archives' title='May 2010' href='../../../05/index.html' />
	<link rel='archives' title='April 2010' href='../../../04/index.html' />
	<link rel='archives' title='March 2010' href='../../index.html' />
	<link rel='archives' title='February 2010' href='../../../02/index.html' />
	<link rel='archives' title='January 2010' href='../../../01/index.html' />
	<link rel='archives' title='September 2009' href='../../../../2009/09/index.html' />
	<link rel='archives' title='May 2009' href='../../../../2009/05/index.html' />
	<link rel='archives' title='April 2009' href='../../../../2009/04/index.html' />
	<link rel='archives' title='January 2009' href='../../../../2009/01/index.html' />
	<link rel='archives' title='December 2008' href='../../../../2008/12/index.html' />
	<link rel='archives' title='November 2008' href='../../../../2008/11/index.html' />
	<link rel='archives' title='October 2008' href='../../../../2008/10/index.html' />
	<link rel='archives' title='September 2008' href='../../../../2008/09/index.html' />
	<link rel='archives' title='August 2008' href='../../../../2008/08/index.html' />
	<link rel='archives' title='July 2008' href='../../../../2008/07/index.html' />
	<link rel='archives' title='June 2008' href='../../../../2008/06/index.html' />
	<link rel='archives' title='May 2008' href='../../../../2008/05/index.html' />
	<link rel='archives' title='April 2008' href='../../../../2008/04/index.html' />
	<link rel='archives' title='March 2008' href='../../../../2008/03/index.html' />
	<link rel='archives' title='February 2008' href='../../../../2008/02/index.html' />
	<link rel='archives' title='January 2008' href='../../../../2008/01/index.html' />
	<link rel='archives' title='November 2007' href='../../../../2007/11/index.html' />
	<link rel='archives' title='October 2007' href='../../../../2007/10/index.html' />
	<link rel='archives' title='September 2007' href='../../../../2007/09/index.html' />
	<link rel='archives' title='August 2007' href='../../../../2007/08/index.html' />
	<link rel='archives' title='July 2007' href='../../../../2007/07/index.html' />
	<link rel="alternate" type="application/rss+xml" title="Ian Bicking: a blog &raquo; What Does A WebOb App Look Like? Comments Feed" href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/feed/" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Configuration management: push vs. pull' href='../../10/configuration-management-push-vs-pull/index.html' />
<link rel='next' title='The Web Server Benchmarking We Need' href='../../16/web-server-benchmarking-we-need/index.html' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='http://blog.ianbicking.org/?p=192' />
<link rel="stylesheet" href="../../../../wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"  type="text/css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
        <style type="text/css" media="all">
/*<![CDATA[*/
body { font-size: 100%; }
body { font-family: tahoma, geneva, sans-serif; }
div.post-header, h2.post-title, p.post-date-single, h2.post-title-single, div.post-entry h1, div.post-entry h2, div.post-entry h3, div.post-entry h4, div.post-entry h5, div.post-entry h6, div.post-entry blockquote, div.post-footer, h3#comment-count, h4#comment-header, div#comments ol li p.comment-metadata, h4#respond { font-family: verdana, geneva, sans-serif; }
div.post-entry p { text-align: left; }
div#wrapper { width: 100%; }

/*]]>*/
</style>
</head>
<body>

<div id="wrapper">

	<div id="header" onclick="location.href='http://blog.ianbicking.org/';" style="cursor:pointer;">
		<h1 id="title"><a href="../../../../index.html" title="Ian Bicking: a blog">Ian Bicking: a blog</a></h1>
		<p id="description"></p>
	</div>
<!-- WP Theme Credits -->
<div style="display: none;">We can answer on question <a href="http://www.olnevhost.net/vps-hosting.html">what is VPS</a>? and
what is <a href="http://www.olnevhost.net/dedicated-servers.html"><strong>cheap dedicated servers</strong></a>?</div>
<!-- END HEADER -->
<div id="container">
	<div id="content" class="widecolumn">


		<div id="post-192" class="post single-post">
			<p class="post-date-single">{ 2010 03 12 }</p>
			<h2 class="post-title-single">What Does A WebOb App Look Like?</h2>
			<div class="post-entry">
				<div class="document">
<p>Lately I&#8217;ve been writing code using WebOb and just a few other small libraries.  It&#8217;s not entirely obvious what this looks like, so I thought I&#8217;d give a simple example.</p>
<p>I make each application a class.  Instances of the class are &quot;configured applications&quot;.  So it looks a little like this (for an application that takes one configuration parameter, <tt class="docutils literal"><span class="pre">file_path</span></tt>):</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">class</span> Application<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, file_path<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">file_path</span> = file_path<br />
&nbsp;</div>
<p>Then the app needs to be a WSGI app, because that&#8217;s how I roll.  I use <a class="reference external" href="http://pythonpaste.org/webob/modules/dec.html">webob.dec</a>:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> webob.<span class="me1">dec</span> <span class="kw1">import</span> wsgify<br />
<span class="kw1">from</span> webob <span class="kw1">import</span> exc<br />
<span class="kw1">from</span> webob <span class="kw1">import</span> Response<br />
<br />
<span class="kw1">class</span> Application<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, file_path<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">file_path</span> = file_path<br />
&nbsp; &nbsp; @<span class="co1">wsgify</span><br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> Response<span class="br0">&#40;</span><span class="st0">'Hi!'</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>Somewhere separate from the application you actually instantiate <tt class="docutils literal"><span class="pre">Application</span></tt>.  You can use <a class="reference external" href="http://pythonpaste.org/deploy/">Paste Deploy</a> for that, configure it yourself, or just do something ad hoc (a lot of mod_wsgi <tt class="docutils literal"><span class="pre">.wsgi</span></tt> files are like this, basically).</p>
<p>I use <a class="reference external" href="http://pythonpaste.org/webob/reference.html#exceptions">webob.exc</a> for things like <tt class="docutils literal"><span class="pre">exc.HTTPNotFound()</span></tt>.  You can raise that as an exception, but I mostly just return the object (to the same effect).</p>
<p>Now you have Hello World.  I then sometimes do something terrible, I start handling URLs like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
@<span class="co1">wsgify</span><br />
<span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">if</span> req.<span class="me1">path_info</span> == <span class="st0">'/'</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">self</span>.<span class="me1">index</span><span class="br0">&#40;</span>req<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">elif</span> req.<span class="me1">path_info</span>.<span class="me1">startswith</span><span class="br0">&#40;</span><span class="st0">'/view/'</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">self</span>.<span class="me1">view</span><span class="br0">&#40;</span>req<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPNotFound</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>This is lazy and a very bad idea.  So you want a dispatcher.  There are several (e.g., <a class="reference external" href="http://pypi.python.org/pypi/selector/">selector</a>).  I&#8217;ll use <a class="reference external" href="http://routes.groovie.org">Routes</a> here&#8230; the latest release makes it a bit easier (though it could still be streamlined a bit).  Here&#8217;s a pattern I think makes sense:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">from</span> routes <span class="kw1">import</span> Mapper<br />
<br />
<span class="kw1">class</span> Application<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw2">map</span> = Mapper<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'index'</span>, <span class="st0">'/'</span>, method=<span class="st0">'index'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'view'</span>, <span class="st0">'/view/{item}'</span>, method=<span class="st0">'view'</span><span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, file_path<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">file_path</span> = file_path<br />
<br />
&nbsp; &nbsp; @<span class="co1">wsgify</span><br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; results = <span class="kw2">self</span>.<span class="kw2">map</span>.<span class="me1">routematch</span><span class="br0">&#40;</span>environ=req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw1">not</span> results:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPNotFound</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; match, route = results<br />
&nbsp; &nbsp; &nbsp; &nbsp; link = URLGenerator<span class="br0">&#40;</span><span class="kw2">self</span>.<span class="kw2">map</span>, req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; req.<span class="me1">urlvars</span> = <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, match<span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; kwargs = match.<span class="kw3">copy</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; method = kwargs.<span class="me1">pop</span><span class="br0">&#40;</span><span class="st0">'method'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; req.<span class="me1">link</span> = link<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">getattr</span><span class="br0">&#40;</span><span class="kw2">self</span>, method<span class="br0">&#41;</span><span class="br0">&#40;</span>req, **kwargs<span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> index<span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
&nbsp; &nbsp; <span class="kw1">def</span> view<span class="br0">&#40;</span><span class="kw2">self</span>, req, item<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
&nbsp;</div>
<p>Another way you might do it is to skip the class, which means skipping a clear place for configuration.  I don&#8217;t like that, but if you don&#8217;t care about that, then it looks like this:</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">def</span> index<span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; ...<br />
<span class="kw1">def</span> view<span class="br0">&#40;</span><span class="kw2">self</span>, req, item<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; ...<br />
<br />
<span class="kw2">map</span> = Mapper<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
<span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'index'</span>, <span class="st0">'/'</span>, view=index<span class="br0">&#41;</span><br />
<span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'view'</span>, <span class="st0">'/view/{item}'</span>, view=view<span class="br0">&#41;</span><br />
<br />
@<span class="co1">wsgify</span><br />
<span class="kw1">def</span> application<span class="br0">&#40;</span>req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; results = <span class="kw2">map</span>.<span class="me1">routematch</span><span class="br0">&#40;</span>environ=req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw1">if</span> <span class="kw1">not</span> results:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPNotFound</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; match, route = results<br />
&nbsp; &nbsp; link = URLGenerator<span class="br0">&#40;</span><span class="kw2">map</span>, req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; req.<span class="me1">urlvars</span> = <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, match<span class="br0">&#41;</span><br />
&nbsp; &nbsp; kwargs = match.<span class="kw3">copy</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; view = kwargs.<span class="me1">pop</span><span class="br0">&#40;</span><span class="st0">'view'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; req.<span class="me1">link</span> = link<br />
&nbsp; &nbsp; <span class="kw1">return</span> view<span class="br0">&#40;</span>req, **kwargs<span class="br0">&#41;</span><br />
&nbsp;</div>
<p>Then <tt class="docutils literal"><span class="pre">application</span></tt> is pretty much boilerplate.  You could put configuration in the request if you wanted, or use some other technique (like <a class="reference external" href="http://pypi.python.org/pypi/Contextual">Contextual</a>).</p>
<p>I talked some with <a class="reference external" href="http://be.groovie.org/">Ben Bangert</a> about what he&#8217;s trying with these patterns, and he&#8217;s doing something reminiscent of Pylons controllers (but without the rest of Pylons) and it looks more like this (with my own adaptations):</p>
<div class="dean_ch" style="white-space: wrap;"><br />
<span class="kw1">class</span> BaseController<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; special_vars = <span class="br0">&#91;</span><span class="st0">'controller'</span>, <span class="st0">'action'</span><span class="br0">&#93;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, request, link, **config<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">request</span> = request<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">link</span> = link<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">for</span> name, value <span class="kw1">in</span> config.<span class="me1">items</span><span class="br0">&#40;</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">setattr</span><span class="br0">&#40;</span><span class="kw2">self</span>, name, value<span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; action = <span class="kw2">self</span>.<span class="me1">request</span>.<span class="me1">urlvars</span>.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'action'</span>, <span class="st0">'index'</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw2">hasattr</span><span class="br0">&#40;</span><span class="kw2">self</span>, <span class="st0">'__before__'</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.__before__<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; kwargs = req.<span class="me1">urlsvars</span>.<span class="kw3">copy</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">for</span> attr <span class="kw1">in</span> <span class="kw2">self</span>.<span class="me1">special_vars</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> attr <span class="kw1">in</span> kwargs:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">del</span> kwargs<span class="br0">&#91;</span>attr<span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">getattr</span><span class="br0">&#40;</span><span class="kw2">self</span>, action<span class="br0">&#41;</span><span class="br0">&#40;</span>**kwargs<span class="br0">&#41;</span><br />
<br />
<span class="kw1">class</span> Index<span class="br0">&#40;</span>BaseController<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">def</span> index<span class="br0">&#40;</span><span class="kw2">self</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
&nbsp; &nbsp; <span class="kw1">def</span> view<span class="br0">&#40;</span><span class="kw2">self</span>, item<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
<br />
<span class="kw1">class</span> Application<span class="br0">&#40;</span><span class="kw2">object</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw2">map</span> = Mapper<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'index'</span>, <span class="st0">'/'</span>, controller=Index<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">map</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="st0">'view'</span>, <span class="st0">'/view/{item}'</span>, controller=Index, &nbsp; &nbsp; action=<span class="st0">'view'</span><span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__init__</span><span class="br0">&#40;</span><span class="kw2">self</span>, **config<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">self</span>.<span class="me1">config</span> = config<br />
<br />
&nbsp; &nbsp; @<span class="co1">wsgify</span><br />
&nbsp; &nbsp; <span class="kw1">def</span> <span class="kw4">__call__</span><span class="br0">&#40;</span><span class="kw2">self</span>, req<span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; &nbsp; &nbsp; results = <span class="kw2">self</span>.<span class="kw2">map</span>.<span class="me1">routematch</span><span class="br0">&#40;</span>environ=req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw1">not</span> results:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> exc.<span class="me1">HTTPNotFound</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; match, route = results<br />
&nbsp; &nbsp; &nbsp; &nbsp; link = URLGenerator<span class="br0">&#40;</span><span class="kw2">self</span>.<span class="kw2">map</span>, req.<span class="me1">environ</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; req.<span class="me1">urlvars</span> = <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, match<span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; controller = match<span class="br0">&#91;</span><span class="st0">'controller'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>req, link, **<span class="kw2">self</span>.<span class="me1">config</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> controller<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp;</div>
<p>That&#8217;s a lot of code blocks, but they all really say the same thing ;)  I think writing apps with almost-no-framework like this is pretty doable, so if you have something small you should give it a go.  I think it&#8217;s especially appropriate for applications that are an API (not a &quot;web site&quot;).</p>
</div>
<p>Automatically generated list of related posts:</p><ol>
<li><a href='../../../../2009/05/22/webob-decorator/index.html' rel='bookmark' title='WebOb decorator'>WebOb decorator</a> <small>Lately I&#8217;ve been writing a few applications (e.g., PickyWiki and...</small></li>
<li><a href='../../../../2007/08/18/webob/index.html' rel='bookmark' title='WebOb'>WebOb</a> <small>I&#8217;ve have it in my head to extract/rewrite parts of...</small></li>
<li><a href='../../../../2008/04/02/json-rpc-webob-example/index.html' rel='bookmark' title='JSON-RPC WebOb Example'>JSON-RPC WebOb Example</a> <small>I just saw this json-rpc recipe go by as a...</small></li>
<li><a href='../../../../2008/04/13/app-engine-and-pylons/index.html' rel='bookmark' title='App Engine and Pylons'>App Engine and Pylons</a> <small>So I promised some more technical discussion of App Engine...</small></li>
<li><a href='../../../../2008/04/09/app-engine-and-open-source/index.html' rel='bookmark' title='App Engine and Open Source'>App Engine and Open Source</a> <small>This is about Google App Engine which probably everyone has...</small></li>
</ol>											</div><!-- END POST-ENTRY  -->
			<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/"
    dc:identifier="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/"
    dc:title="What Does A WebOb App Look Like?"
    trackback:ping="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/trackback/" />
</rdf:RDF> -->
			<div class="post-footer">
				<p>Posted by Ian Bicking on Friday, March 12th, 2010, at 5:50 pm, and filed under <a href="../../../../category/programming/index.html" title="View all posts in Programming" rel="category tag">Programming</a>, <a href="../../../../category/python/index.html" title="View all posts in Python" rel="category tag">Python</a>, <a href="../../../../category/web/index.html" title="View all posts in Web" rel="category tag">Web</a>.</p>
				<p>
				Comments have a <a href='http://blog.ianbicking.org/2010/03/12/a-webob-app-example/feed/'>feed</a>.</p>
			</div><!-- END POST-FOOTER -->
		</div><!-- END POST -->

<div id="comments">




<h4 id="comments">30 Comments</h4>
 <ul class="commentlist">
		<li class="comment even thread-even depth-1 parent" id="comment-155840">
				<div id="div-comment-155840" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/dd1a815ca3634ab75bd9c92a719005d5?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://self.maluke.com/' rel='external nofollow' class='url'>Sergey Schetinin</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-155840">
			March 12, 2010 at 6:36 pm</a>		</div>

		<p>See also: pasteob.Autodispatch </p>

<ul>
<li><a href="http://bitbucket.org/mlk/pasteob/src/tip/pasteob/&#95;&#95;init&#95;&#95;.py#cl-95" rel="nofollow">http://bitbucket.org/mlk/pasteob/src/tip/pasteob/<strong>init</strong>.py#cl-95</a></li>
<li><a href="http://groups.google.com/group/paste-users/browse&#95;thread/thread/db39375d2142760d/f63ffadb0521026e?lnk=raot" rel="nofollow">http://groups.google.com/group/paste-users/browse_thread/thread/db39375d2142760d/f63ffadb0521026e?lnk=raot</a></li>
</ul>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment odd alt depth-2 parent" id="comment-156256">
				<div id="div-comment-156256" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a57c52861cb36307efbb477b4ec3a292?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.maetico.com' rel='external nofollow' class='url'>Jorge Vargas</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156256">
			March 15, 2010 at 10:49 pm</a>		</div>

		<p>This seems like the start of CherryPy dispatching, which was later know as Object Dispatch and popularized by TurboGears. I both love and hate it. It&#8217;s awesome to give structure to your code and app eliminating that pesky routes configuration, however it&#8217;s bad when you need to get outside of the norm and you have to add several workarounds for the edge cases, take a look at <strong>dispatch</strong> and other <strong>*</strong> methods in TurboGears2.1 codebase.</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment even depth-3" id="comment-156263">
				<div id="div-comment-156263" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/dd1a815ca3634ab75bd9c92a719005d5?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://self.maluke.com/' rel='external nofollow' class='url'>Sergey Schetinin</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156263">
			March 15, 2010 at 11:38 pm</a>		</div>

		<p>It is somewhat similar to CherryPy, but there are important differences. First of all everything is WSGI, no query-as-arguments and stuff. Second, the names are picked in such a way that there&#8217;s no need for @expose. It also handles edge cases very well.</p>

<p>I know the other solutions and their shortcomings, so you might find that Autodispatch finally gets it right.</p>

		<div class="reply">
				</div>
				</div>
		</li>
</ul>
</li>
</ul>
</li>
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-155868">
				<div id="div-comment-155868" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/0c8a56d012e5a2cabe00f28b5f68ce83?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://cdent.tumblr.com/' rel='external nofollow' class='url'>Chris Dent</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-155868">
			March 13, 2010 at 5:14 am</a>		</div>

		<p>I&#8217;ve never quite been able to get my head around these &#8220;almost-no-framework&#8221; things. Why not go all the way and just be pretty much no framework? What are WebOb and things like it providing here that isn&#8217;t obfuscation above a simple set of callables doing <code>(environ, start_response)</code> dispatched by selector or Routes? To me, doing it that way keeps the mechanics of the &#8220;web&#8221; stuff transparent and highly visible, which I&#8217;ve found quite critical in maintaining good HTTP hygiene. I want to be able to see.</p>

<p>My own particular accretion of bits of code started from what I learned from Joe Gregorio&#8217;s [Robaccia](<a href="http://bitworking.org/news/Why&#95;so&#95;many&#95;Python&#95;web&#95;frameworks" rel="nofollow">http://bitworking.org/news/Why<em>so</em>many<em>Python</em>web_frameworks</a>) and has evolved into a bunch of pieces of WSGI I use here and there as needed, like lego.</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment even depth-2" id="comment-155938">
				<div id="div-comment-155938" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/dd3cddb81132208624e98cc877c05591?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://mikepk.com' rel='external nofollow' class='url'>mikepk</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-155938">
			March 13, 2010 at 1:49 pm</a>		</div>

		<p>I think the best case for the &#8220;almost no framework&#8221; is when you&#8217;re clear what the small helper abstractions are giving you and doing for you. I kind of envision it as satisfying the initial impulse that leads most people to build a web framework in the first place (getting rid of the same repetitive, error-prone tasks you have to do on every request) but avoids the &#8220;It does everything for you <em>poof</em> it&#8217;s MAGIC&#8221; behavior that almost all frameworks seem to evolve into. You&#8217;re right it takes some of the web &#8220;stuff&#8221; out of view, but as long as you know what that &#8220;stuff&#8221; is, you can always hack it when you need to.</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment odd alt depth-2" id="comment-156032">
				<div id="div-comment-156032" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/dd1a815ca3634ab75bd9c92a719005d5?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://self.maluke.com/' rel='external nofollow' class='url'>Sergey Schetinin</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156032">
			March 14, 2010 at 4:45 am</a>		</div>

		<p>WebOb request / response objects represent HTTP requests / responses much closer than raw WSGI does.</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment even depth-2" id="comment-156259">
				<div id="div-comment-156259" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a57c52861cb36307efbb477b4ec3a292?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.maetico.com' rel='external nofollow' class='url'>Jorge Vargas</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156259">
			March 15, 2010 at 10:56 pm</a>		</div>

		<p>Two things</p>

<p>1- removing repetition for example in this case you will get tired of creating Response objects on every return so you will either create a default response you clone and return a string (this is what pylons did) or make up some marker to determine how to create it (this is what TurboGears did with the @expose decorator + returning a dict)</p>

<p>2- Raw WSGI is hard to maintain not to mention very unfriendly to object oriented programming, reading from the environ and checking if the key is valid gets old quick which is why webob was born.</p>

<p>In other words as others have pointed out the framework grows out of the necessity of eliminating repetition which pulls in constraints on design and style. IMO that is the trade off and I&#8217;ll salute everyone that will be able to abstract repetition without adding constraints.</p>

		<div class="reply">
				</div>
				</div>
		</li>
</ul>
</li>
		<li class="comment odd alt thread-even depth-1" id="comment-155937">
				<div id="div-comment-155937" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/dd3cddb81132208624e98cc877c05591?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://mikepk.com' rel='external nofollow' class='url'>mikepk</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-155937">
			March 13, 2010 at 1:41 pm</a>		</div>

		<p>Seems like an interesting approach for quick, one-off applications (or as you say, APIs).</p>

<p>I&#8217;ve been writing some web applications with a very thin custom web framework I put together. I was inspired by (and used many of the ideas in) your &#8220;Do-It-Yourself Framework&#8221; articles. It ended up using WSGI, WebOb, Routes, Mako, and my own non-orm (not a fan of ORMs) db layer as the foundation pieces. It&#8217;s lighter weight than Pylons and requires a lot less configuration with the obvious trade off being that it&#8217;s less flexible (only works with MySQL or the filesystem for the storage etc&#8230;). </p>

<p>I wanted to say thanks for those articles and all of your contributions!</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment even thread-odd thread-alt depth-1" id="comment-155967">
				<div id="div-comment-155967" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/5faa8f7f53d3ac658c4dfa4bd04a2ee3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://gedmin.as' rel='external nofollow' class='url'>Marius Gedminas</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-155967">
			March 13, 2010 at 5:10 pm</a>		</div>

		<p>I&#8217;ve written a few mini-apps (e.g. restview, which you can find on PyPI) like this but using only Python&#8217;s stdlib.  It was rather painful, but then &#8220;only depends on Python&#8217;s stdlib&#8221; is a compelling feature sometimes.</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment odd alt thread-even depth-1 parent" id="comment-156066">
				<div id="div-comment-156066" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a709fd00fc849280c23233ef0a01c5dc?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://plope.com' rel='external nofollow' class='url'>Chris McDonough</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156066">
			March 14, 2010 at 4:49 pm</a>		</div>

		<p>I&#8217;ll go the other way from Chris Dent on this and ask if you&#8217;re going to do this, why not just use a framework?  Above, you&#8217;re just typing code that someone has already typed up in a module in some existing framework.  And without tests.</p>

<p>This is a rhetorical question.  I know the right answers to this from first-person experience: &#8220;because if I type it, I&#8217;ll understand it&#8221; and &#8220;I wont need anybody&#8217;s permission to change it later&#8221;.   There are the counterarguments:  understanding other people&#8217;s code is a valuable skill to have; working with others is also valuable.</p>

<p>But in any case, I don&#8217;t think &#8220;no framework&#8221; is ever the right goal.  &#8220;Best fit for my brain&#8221; is almost always the right goal, though, so if they are one in the same, great.</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment even depth-2" id="comment-156224">
				<div id="div-comment-156224" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b1f36e554be0e1ae19f9a74d6ece9107?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.oddbird.net' rel='external nofollow' class='url'>Carl Meyer</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156224">
			March 15, 2010 at 3:01 pm</a>		</div>

		<p>This speaks my mind. In all aspects.</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment byuser comment-author-ianb bypostauthor odd alt depth-2 parent" id="comment-156228">
				<div id="div-comment-156228" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/cc8334869c9d2a9e603017f2da805eb3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../../../index.html' rel='external nofollow' class='url'>Ian Bicking</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156228">
			March 15, 2010 at 3:37 pm</a>		</div>

		<p>I&#8217;d generally agree.  Though there&#8217;s some other points:</p>

<ul>
<li><p>By using the least amount of infrastructure that you need, the code is more navigable for everyone.  This is actually a substantial part of why I don&#8217;t use Pylons for these small projects, I just find the file layout unnecessarily deep (<code>paster create -t pylons_minimal</code> helps, but I like going even smaller).</p></li>
<li><p>Components have different levels of stability.  There&#8217;s simple code stability (a lack of bugs), but even more for me is the issue of conceptual stability: is this a good factoring of the domain, does it address the important problems, does it fully encapsulate its complexity, is it sufficiently adaptable?  There are components I feel fairly confident about (e.g., WebOb, Routes or another simple dispatching library, most template libraries, etc).  Most frameworks incorporate things that make me uncomfortable.</p></li>
<li><p>Some problems just have uncomfortable aspects, but I&#8217;m a lot more comfortable if those parts are ad hoc and per-application.</p></li>
<li><p>This is not completely defeatist, as I also believe this library-of-things-I-am-comfortable-with increases over time.</p></li>
<li><p>I believe there is a genuine benefit to avoiding embedding control structures in frameworks and libraries.  For instance, I think there is a benefit in doing a route match with a library but doing the actual request routing in my application code.</p></li>
</ul>

<p>I don&#8217;t think I&#8217;d say &#8220;best fit for my brain&#8221; is how I&#8217;d qualify it.  Maybe one general caveat is that I want to code for me-right-now and me-of-the-future; I&#8217;ve made many mistakes by forgetting me-of-the-future.  But I would also use this pattern in a collaborative environment, if I thought those other advantages were compelling; i.e., I&#8217;d use this pattern (<em>sometimes</em>) even when the code is intended for unknown future developers.</p>

<p>The counterargument is kind of [Greenspun's Rule](<a href="http://en.wikipedia.org/wiki/Greenspun&#039;s&#95;Tenth&#95;Rule" rel="nofollow">http://en.wikipedia.org/wiki/Greenspun&#039;s<em>Tenth</em>Rule</a>): &#8220;Any sufficiently complicated C or Fortran program contains an ad hoc, informally-specified, bug-ridden, slow implementation of half of Common Lisp.&#8221;  Or, &#8220;Any sufficiently complicated no-framework application contains an ad hoc, informally-specified, bug-ridden, slow implementation of half of a web framework.&#8221;  Except&#8230; the scales aren&#8217;t really that large; half of Pylons just isn&#8217;t an intimidating size.  I think that&#8217;s because we&#8217;ve been moving up to higher levels, both at the language level and the tool level.</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment even depth-3 parent" id="comment-156229">
				<div id="div-comment-156229" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/0c8a56d012e5a2cabe00f28b5f68ce83?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://cdent.tumblr.com/' rel='external nofollow' class='url'>Chris Dent</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156229">
			March 15, 2010 at 3:56 pm</a>		</div>

		<p>I&#8217;m not surprised that I&#8217;m sort of alone on this &#8220;no-framework&#8221; notion. It&#8217;s not that I&#8217;m anti-DRY or something like that, but rather that I think of code as human communication more than computer communication, and beyond it being human communication I think of it as an educational tool. When I look at a web application and all the web &#8220;stuff&#8221; has been abstracted away (including, in response to Sergey, how the server is delivering my application information) the learning opportunity is constrained to a rather small domain. My future me is incredibly stupid, and I&#8217;m pretty sure it&#8217;s neither offensive nor incorrect to claim that everyone else&#8217;s is too.</p>

<p>I suppose in many cases this limited learning domain ought to be fine, it&#8217;s that small domain where the action is supposed to be. However, this leaves armies of developers with no idea how the web works, and importantly how it could work if they could see some of the workings. Obviously there&#8217;s a limit. I&#8217;m not saying we should all be pushing things into registers, but where we choose to draw the boundary is an indicator of what we think matters, what we think needs to be seen.</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment byuser comment-author-ianb bypostauthor odd alt depth-4" id="comment-156230">
				<div id="div-comment-156230" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/cc8334869c9d2a9e603017f2da805eb3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../../../index.html' rel='external nofollow' class='url'>Ian Bicking</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156230">
			March 15, 2010 at 4:00 pm</a>		</div>

		<p>FWIW, the <code>__str__</code> methods of webob.Request and Response give the HTTP request and response pretty much how it goes over the wire.</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment even depth-4 parent" id="comment-156237">
				<div id="div-comment-156237" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b1f36e554be0e1ae19f9a74d6ece9107?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.oddbird.net' rel='external nofollow' class='url'>Carl Meyer</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156237">
			March 15, 2010 at 8:07 pm</a>		</div>

		<p>I&#8217;m honestly kind of confused by this. There may well be &#8220;armies of developers with no idea how the web works,&#8221; but I don&#8217;t see how it&#8217;s due to WebOb, or Pylons, or Django. When I write, say, Django views, I work with a Request object and a Response object. They have a status code, and headers I can inspect and manipulate, and body content. Each time a request comes in, I send back a response. If that isn&#8217;t pretty much &#8220;how the web works,&#8221; I&#8217;m missing something. The exact details of the raw WSGI API might be useful to know in some circumstances, but describing them as &#8220;how the web works&#8221; seems over the top.</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment odd alt depth-5" id="comment-156579">
				<div id="div-comment-156579" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/0c8a56d012e5a2cabe00f28b5f68ce83?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://cdent.tumblr.com/' rel='external nofollow' class='url'>Chris Dent</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156579">
			March 18, 2010 at 3:30 am</a>		</div>

		<p>This vast collection of comments has helped me to work out part of what my issues are. I&#8217;m not attempting to make any claim to correctness on my part, more just exploring. Firstly I think I have an unfortunate tendency to have a knee jerk negative reaction to seeing objects where I wouldn&#8217;t want them to be. They make grand sense in all kinds of places, but I do not like them as the first visible manifestation of the handler of a web request: too much tendency towards action at a distance and various buried magic. I prefer something much closer to properly functional because in my mental model (what &#8220;fits my brain&#8221;) a web request is functional (not strictly so, there are side effects which show up in the persistence layer but for the most part I want them as state free and idempotent as possible). In that sense, a bare WSGI callable is really quite nice. That leads nicely to the second point: In Ian&#8217;s second code block (prefixed with &#8220;Then the app needs to be a WSGI app&#8221;) at first glance I see no WSGI app. I see something which under the covers is a wsgi app, being made so by &#8220;other stuff&#8221;.</p>

<p>I have no objection to there being an object which encapsulates an HTTP request or response nor extensive use of libraries, what is the problem is the WSGI stack being obscured. Establish the request object further up the stack and hork it into <code>environ</code> and let me pull it out later if I want, but don&#8217;t change my application signatures. Those signatures help to ensure that I&#8217;m creating what amounts to a stackable series of independent tiny little web apps (even if to the outside world they look like just one). Creating using that model helps to ensure that my codebase is deliciously extensible and scalable.</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment even depth-5" id="comment-156581">
				<div id="div-comment-156581" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/dd1a815ca3634ab75bd9c92a719005d5?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://self.maluke.com/' rel='external nofollow' class='url'>Sergey Schetinin</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156581">
			March 18, 2010 at 3:43 am</a>		</div>

		<p>@Chris,
The wsgify-decorated functions/methods have dual-signatures and they are actually WSGI apps, but the fact it&#8217;s not obvious is bad enough. I voiced this concern some time ago, so you might want to check out the discussion: 
 * <a href="http://groups.google.com/group/paste-users/browse&#95;thread/thread/7346e75940413f46" rel="nofollow">http://groups.google.com/group/paste-users/browse<em>thread/thread/7346e75940413f46</em></a>
 * <a href="http://groups.google.com/group/paste-users/browse&#95;thread/thread/aae70301addad062" rel="nofollow">http://groups.google.com/group/paste-users/browsethread/thread/aae70301addad062</a></p>

		<div class="reply">
				</div>
				</div>
		</li>
</ul>
</li>
</ul>
</li>
		<li class="comment odd alt depth-3" id="comment-156233">
				<div id="div-comment-156233" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a709fd00fc849280c23233ef0a01c5dc?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://plope.com' rel='external nofollow' class='url'>Chris McDonough</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156233">
			March 15, 2010 at 5:13 pm</a>		</div>

		<p>Yeah as you intuited via the Greenspun comment I&#8217;m pretty sure that any particular brand of no-framework environment ultimately ends up as a framework.  It&#8217;s the no-framework-framework created by the whomever wrote its first hundred lines of code.  Even the 30-50 lines of code you entered above has contracts hidden in it: to generate a URL from within a view, you need to know enough to call route_url; views must be defined with the kwargs defined in the route, and so forth.  Frameworks are all about contracts like this.  I think the real differences between the code you&#8217;ve created above and any other framework are these:</p>

<ul>
<li><p>You&#8217;ve not <em>committed</em> to any contracts (there are no documented contracts, and you call always call 
&#8220;implementation detail&#8221; if someone complains due to a change you made).  This is the moral equivalent
of &#8220;I dont need to ask anyone if I can change this&#8221;.</p></li>
<li><p>The notional contracts that do exist are maybe fewer, so you can keep them in your head all at once. 
This is the moral equivalent of &#8220;I typed it all so I understand it all&#8221;.</p></li>
</ul>

<p>So yeah.  I agree with Greenspun.  If you&#8217;re a lone developer on a web project, and you will always be the lone developer on that project, maybe creating-the-mainloop-from-scratch on that project makes sense if you&#8217;re the most comfortable with that solution.  That&#8217;s cool.  But if you&#8217;re trying to collaborate with one or more people on a project, though, you always need <em>some</em> contracts, because collaboration at some level just requires them as a replacement for a personal mind-meld.   And once there&#8217;s a contract or two, I think you become the proud new owner of a framework.</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment even depth-3 parent" id="comment-156247">
				<div id="div-comment-156247" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b1f36e554be0e1ae19f9a74d6ece9107?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.oddbird.net' rel='external nofollow' class='url'>Carl Meyer</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156247">
			March 15, 2010 at 9:18 pm</a>		</div>

		<p>Not to discount legitimate technical arguments one way or the other, but it&#8217;s striking to me how many of these preferences seem explainable by which abstraction level you cut your teeth on. When I got into Python web dev, Django was well-recommended and had good docs, so I tried it first. I had success, it fit my brain, and I learned its internals to the point where not much that it does feels magical; I know where to find the relevant code, and how to bend it to my needs. Sure, there are chunks of it (and even parts of the driving philosophy) that I don&#8217;t like very much, but the value outweighs the discomfort; the idea of reinventing in my own code pieces of Django that are well-tested, widely used, and have worked well for me in the past doesn&#8217;t hold a lot of appeal. I cut my teeth working on top of Django, not on alternatives to it.</p>

<p>And then there&#8217;s Pinax, another frameworky thing one level higher on the abstraction stack, which also addresses problems I face. And I find I&#8217;m quite resistant to using it (still haven&#8217;t for anything serious) because I already worked on those problems myself, and built solutions that I like. I don&#8217;t want to abandon my solutions in favor of someone else&#8217;s conception. I&#8217;m willing to use other people&#8217;s code at Pinax&#8217; level of abstraction, but I&#8217;m much more picky: it has to be tightly focussed, clearly correctly factored, library-like rather than framework-like (so I can fit it into my personal no-framework framework); all the things that sound pretty similar to Ian&#8217;s comments about using Routes or WebOb.</p>

<p>Grizzled veterans of C don&#8217;t like having Python manage their memory for them, either&#8230;</p>

<p>On the other hand, maybe this just means that I need to take a couple months and dive head-long into writing my own web framework, to broaden my awareness of the design choices made. Probably so. Python hackers ought to learn C memory management, too.</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment byuser comment-author-ianb bypostauthor odd alt depth-4 parent" id="comment-156250">
				<div id="div-comment-156250" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/cc8334869c9d2a9e603017f2da805eb3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../../../index.html' rel='external nofollow' class='url'>Ian Bicking</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156250">
			March 15, 2010 at 9:40 pm</a>		</div>

		<p>I hope we all agree on at least one thing: everyone should make their own framework!  Whether even that person should use their framework, eh&#8230;</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment even depth-5" id="comment-156251">
				<div id="div-comment-156251" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/b1f36e554be0e1ae19f9a74d6ece9107?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.oddbird.net' rel='external nofollow' class='url'>Carl Meyer</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156251">
			March 15, 2010 at 9:46 pm</a>		</div>

		<p>Sigh. Well, you can at least be sure it&#8217;ll use WebOb.</p>

<p>(<em>doesn&#8217;t want to get called out on Twitter by Ian for writing another set of non-WebOb request/response objects</em>)</p>

		<div class="reply">
				</div>
				</div>
		</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-156198">
				<div id="div-comment-156198" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/2052760be2ef69b07fddb4a5b7da9a0d?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.whitmorriss.org' rel='external nofollow' class='url'>whit</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156198">
			March 15, 2010 at 9:58 am</a>		</div>

		<p>Thanks for the clear exposition of the techniques I&#8217;ve been copping off of you since FlatAtomPub!</p>

<p>Two thoughts:</p>

<ul>
<li><p>You mention Contextual.  If you feel so inclined it would be illuminating to see how you would handle the boilerplate using Contextual.</p></li>
<li><p>I like the examination of the least possible or &#8220;goldilocks&#8221; framework approach as it inevitably leads to matching the purpose of the codebase to the product (the application) rather than fitting an application to an existing framework.  And that thing mcdonc said about fitting your head.  </p></li>
<li><p>Though chris R will curse me for mentioning it, his &#8220;nothing&#8221; framework is a really nice example of the nok framework principle: <a href="http://www.bitbucket.org/chrisrossi/happy/overview/" rel="nofollow">http://www.bitbucket.org/chrisrossi/happy/overview/</a> .    As he describes it, it&#8217;s all about removing inversion of control.  The most obvious effect of this is the increase amount of code in the area of application boilerplate.  OTOH, auditing what happens is extremely easy: <a href="http://www.bitbucket.org/chrisrossi/edwin/src/tip/src/edwin/edwin/application.py" rel="nofollow">http://www.bitbucket.org/chrisrossi/edwin/src/tip/src/edwin/edwin/application.py</a> .</p></li>
</ul>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment byuser comment-author-ianb bypostauthor even depth-2" id="comment-156202">
				<div id="div-comment-156202" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/cc8334869c9d2a9e603017f2da805eb3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../../../index.html' rel='external nofollow' class='url'>Ian Bicking</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156202">
			March 15, 2010 at 11:05 am</a>		</div>

		<p>The use of Contextual is more speculative, I haven&#8217;t really tried it.  I think it might look like this:</p>

<pre><code>@context.setting
def config(value={})
    return value

def configure_app(app, settings):
    def replacement_app(environ, start_response):
        with context.new():
            for obj, setting in settings:
                obj &lt;&lt;= setting
            return app(environ, start_response)
    return replacement_app
</code></pre>

<p>Then you could configure an application like this:</p>

<pre><code>@wsgify
def myapp(req):
    return Response('%s world!' % config()['greeting'])

app = configure_app(myapp, [(config, {'greeting': 'hello'})])
</code></pre>

<p>Though I find Contextual perhaps more clever than is necessary.  I wish it just looked like this:</p>

<pre><code>config = dynlib.DynamicFactory(name='%s.config' % __name__)

def configure_app(app, settings):
    def replacement_app(environ, start_response):
        with dynlib.settings(settings):
            return app(environ, settings)
    return replacement_app
</code></pre>

<p>With all the other pieces the same, and with no other fanciness (like Contextual&#8217;s Services, or the fancy <code>&lt;&lt;=</code> assignment).  Also perhaps the ability to associate values with strings instead of only concrete objects.  But it deserves some exploration before settling on anything.</p>

<p>I think both Happy and PasteOb (and a few other things I&#8217;ve heard about) represent a kind of continuation of a big-bag-of-tricks which Paste core represented for a long time (but which is long in the tooth, so I&#8217;m glad to see other people looking at these tasks again with a fresh eye).</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment odd alt depth-2" id="comment-156203">
				<div id="div-comment-156203" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/dd1a815ca3634ab75bd9c92a719005d5?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://self.maluke.com/' rel='external nofollow' class='url'>Sergey Schetinin</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156203">
			March 15, 2010 at 11:19 am</a>		</div>

		<p>Here&#8217;s a real example based on contextual-fork and some proprietary modules:</p>

<pre><code>from pasteob import *
from mext.context import State   
from mext.sendmail import *

@webob_wrap
def app(req):
   Sendmail.send(...)
   return Response("Email sent")

SmtpSendmail.activate('localhost')
# could also be, for example
# Sendmail.activate('/home/foo/mysendmail')

app = State.wrap_cb(app) # only necessary if the server doesn't manage the contextual state itself
serve(app)
</code></pre>

<p>PasteOb has similar hooks for webauth, which is something I plan to describe in [paste-users](<a href="http://groups.google.com/group/paste-users" rel="nofollow">http://groups.google.com/group/paste-users</a>) sometime later.</p>

		<div class="reply">
				</div>
				</div>
		</li>
</ul>
</li>
		<li class="comment even thread-even depth-1 parent" id="comment-156253">
				<div id="div-comment-156253" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/bde162f1d6702057fbf9ed41c05ab72e?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn">Stephen J Day</cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156253">
			March 15, 2010 at 10:33 pm</a>		</div>

		<p>What&#8217;s your opinion on the microframeworks, like [bottle](<a href="http://bottle.paws.de/" rel="nofollow">http://bottle.paws.de/</a>)? It&#8217;s seems these fit the bill for very quick prototyping for an api or backend interface. I have used bottle a few times now, with great success. Yes, its a framework, but it doesn&#8217;t really have any dependencies and its easy to modify for the specific application if needed. On top of that, its smoking fast.</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment odd alt depth-2" id="comment-156255">
				<div id="div-comment-156255" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a57c52861cb36307efbb477b4ec3a292?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.maetico.com' rel='external nofollow' class='url'>Jorge Vargas</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156255">
			March 15, 2010 at 10:45 pm</a>		</div>

		<p>Bottle fits into the &#8220;why don&#8217;t you use webob&#8221; problem. IMO it&#8217;s a great tool but why implement all the parsing yet one more time.</p>

		<div class="reply">
				</div>
				</div>
		</li>
		<li class="comment byuser comment-author-ianb bypostauthor even depth-2" id="comment-156260">
				<div id="div-comment-156260" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/cc8334869c9d2a9e603017f2da805eb3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../../../index.html' rel='external nofollow' class='url'>Ian Bicking</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156260">
			March 15, 2010 at 11:05 pm</a>		</div>

		<p>For a web<strong>site</strong> I generally would not promote this style of microframework.  Bottle seems to be focused on smaller things.  I am not anti-library&#8230; Bottle eschews all libraries, which to me makes it uninteresting.  I might steal some ideas from it if I thought there were ideas worth stealing.  I&#8217;m not aware of any.  I don&#8217;t like the decorators for routes technique as it relies on import side-effects (the routes get registered when the decorator is executed).  The thread-local request object is bad stuff.</p>

		<div class="reply">
				</div>
				</div>
		</li>
</ul>
</li>
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-156254">
				<div id="div-comment-156254" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/a57c52861cb36307efbb477b4ec3a292?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.maetico.com' rel='external nofollow' class='url'>Jorge Vargas</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156254">
			March 15, 2010 at 10:45 pm</a>		</div>

		<p>Sorry to jump late into the party but I have to say I both agree and disagree with this approach. First of all the moment I discovered webob.wsgify I was like ohhh that is what I have been wanting for quite some time and I was stuck at the problem regarding routing (btw why is the if/else approach naive? is it because of routes optimization or I&#8217;m missing something?) in fact I find python based routing to be a good thing! because then you are not forced to route on URL, and you can do interesting things like A/B testing or just use completely different code paths depending on the type of user. So I guess in this particular case this fits my brain. I also agree that it could become bad fast for &#8220;big applications&#8221; but then the problem could be framed in &#8220;do we really need big applications&#8221;? </p>

<p>That said this leads us down the route of having to reinvent everything as it is not possible to reuse anything for this &#8220;framework&#8221; as there is nothing written in it except for what you wrote and IMO that is very bad, mainly because there is always someone out there that could and in fact already wrote a better solution to this particular problem.</p>

<p>That brings me to another plus point which is code reuse, in this no-framework environment reusing code is actually the best part of it as it is all wsgi and since you are using the least amount of code it means you will be compatible with others and (at least in theory) you should be able to plug in code written in other frameworks into your own system.</p>

<p>Last but not least thank you for putting words to what I have been playing around with. I have been doing something like this for two small apps playing around with this idea, and so far I like what I have. I have been slowly getting converted into the philosophy of libraries &gt; frameworks and the ability to plug-n-play with component to create that dream of a &#8220;Best of&#8221; framework.</p>

<p>As for the argument regarding &#8220;developers that don&#8217;t know better&#8221; I think we have to be pragmatic here, you should (at different points in time) both be the super wise guy that dives into the HTTP headers while at others you just want to have a method be called and return a string. </p>

<p>Anyway sorry for the long comment and keep up the good work recently your post have been enlightening filling peaces of the puzzle</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment byuser comment-author-ianb bypostauthor even depth-2 parent" id="comment-156261">
				<div id="div-comment-156261" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://0.gravatar.com/avatar/cc8334869c9d2a9e603017f2da805eb3?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='../../../../index.html' rel='external nofollow' class='url'>Ian Bicking</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-156261">
			March 15, 2010 at 11:11 pm</a>		</div>

		<p>Re: routing: I&#8217;ve done if/else routing and found it very hard to maintain.  It&#8217;s like when I&#8217;ve generated HTML without a template: in some circumstances it might seem okay or even a good idea at first, but I always am annoyed with my choice later.  The one exception in my experience is something like a CMS where the routing itself is very application-specific and data-driven.  In my example it would still be easy to do A/B testing, as the routing just returns a match but doesn&#8217;t invoke it, so it&#8217;s clear where you&#8217;d put different logic in.</p>

<p>I&#8217;d be curious what people think: if you were making an application, what&#8217;s the next thing you&#8217;d look to a library for?  Templates are a no-brainer.  I&#8217;d add an optional constraint: barring things that abstract out logic and conditionals (e.g.,, what <code>Application</code> does), what library (or kind of library) would you want to use?</p>

		<div class="reply">
				</div>
				</div>
		<ul class='children'>
		<li class="comment odd alt depth-3" id="comment-157376">
				<div id="div-comment-157376" class="comment-body">
				<div class="comment-author vcard">
		<img alt='' src='http://1.gravatar.com/avatar/7e8f40a05adf2c3ddc3f5c6f49fb94d1?s=32&amp;d=http%3A%2F%2Fblog.ianbicking.org%2Fwp-includes%2Fimages%2Fblank.gif&amp;r=PG' class='avatar avatar-32 photo' height='32' width='32' />		<cite class="fn"><a href='http://www.google.com/profiles/pjkeane' rel='external nofollow' class='url'>Peter Keane</a></cite> <span class="says">says:</span>		</div>

		<div class="comment-meta commentmetadata"><a href="http://blog.ianbicking.org/2010/03/12/a-webob-app-example/comment-page-1/#comment-157376">
			March 27, 2010 at 11:06 am</a>		</div>

		<p>I&#8217;d love to see a routing system w/ a similar API to that described here (but Python, not PHP):</p>

<p><a href="http://www.google.com/buzz/pjkeane/CWyFG8ydaoT/URL-Dispatching-made-easy-Ive-not-yet-found-a-URL" rel="nofollow">http://www.google.com/buzz/pjkeane/CWyFG8ydaoT/URL-Dispatching-made-easy-Ive-not-yet-found-a-URL</a></p>

		<div class="reply">
				</div>
				</div>
		</li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="navigation">
<div class="alignleft"></div>
<div class="alignright"></div>
</div>




</div>

		<div class="navigation">
			<div class="nav-left">&laquo; <a href="../../10/configuration-management-push-vs-pull/index.html" rel="prev">Configuration management: push vs. pull</a></div>
			<div class="nav-right"><a href="../../16/web-server-benchmarking-we-need/index.html" rel="next">The Web Server Benchmarking We Need</a> &raquo;</div>
		</div><!-- END NAVIGATION -->


	</div><!-- END CONTENT -->
</div><!-- END CONTAINER  -->

<div id="sidebar">
	<ul>
		<li id="home-link">
			<h2><a href="../../../../index.html" title="Ian Bicking: a blog">Home</a></h2>
		</li>
<li id="text-315934862" class="widget widget_text"><h2 class="widgettitle">About</h2>
			<div class="textwidget">Ian is a developer with Mozilla, <a href="http://ianbicking.appspot.com/projects">Python open source developer</a>, actually uses <a href="https://plus.google.com/u/0/104537541227697934010/posts">Google+</a> more than <a href="http://twitter.com/ianbicking">twitter</a> and lives in Minneapolis.<br>
<span class="gittip-0001" gittip-username="ianbicking"></span>
<script id="gittip-0001"
  src="https://www.gittip.com/assets/widgets/0001.js"></script>
</div>
		</li>
<li id="text-315934863" class="widget widget_text">			<div class="textwidget"><!-- <script type="text/javascript">mbgc='f5f5f5';ww='160';mbc='cecece';bbc='3F79D5';bmobc='3b71c6';bbgc='4889F0';bmoc='3F79D5';bfc='FFFFFF';bmofc='ffffff';tlc='cecece';tc='6a6a6a';nc='6a6a6a';bc='6a6a6a';l='y';fs='16';fsb='13';bw='100';ff='4';lu='6a6a6a';pc='4889F0';wh='340';b='s'; pid='104537541227697934010';</script><script type="text/javascript" src="http://widgetsplus.com/google_plus_widget.js"></script> --></div>
		</li>
<li id="archives-2" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
		<ul>
			<li><a href='../../../../2012/10/index.html' title='October 2012'>October 2012</a></li>
	<li><a href='../../../../2012/02/index.html' title='February 2012'>February 2012</a></li>
	<li><a href='../../../../2011/04/index.html' title='April 2011'>April 2011</a></li>
	<li><a href='../../../../2011/03/index.html' title='March 2011'>March 2011</a></li>
	<li><a href='../../../09/index.html' title='September 2010'>September 2010</a></li>
	<li><a href='../../../08/index.html' title='August 2010'>August 2010</a></li>
	<li><a href='../../../05/index.html' title='May 2010'>May 2010</a></li>
	<li><a href='../../../04/index.html' title='April 2010'>April 2010</a></li>
	<li><a href='../../index.html' title='March 2010'>March 2010</a></li>
	<li><a href='../../../02/index.html' title='February 2010'>February 2010</a></li>
	<li><a href='../../../01/index.html' title='January 2010'>January 2010</a></li>
	<li><a href='../../../../2009/09/index.html' title='September 2009'>September 2009</a></li>
	<li><a href='../../../../2009/05/index.html' title='May 2009'>May 2009</a></li>
	<li><a href='../../../../2009/04/index.html' title='April 2009'>April 2009</a></li>
	<li><a href='../../../../2009/01/index.html' title='January 2009'>January 2009</a></li>
	<li><a href='../../../../2008/12/index.html' title='December 2008'>December 2008</a></li>
	<li><a href='../../../../2008/11/index.html' title='November 2008'>November 2008</a></li>
	<li><a href='../../../../2008/10/index.html' title='October 2008'>October 2008</a></li>
	<li><a href='../../../../2008/09/index.html' title='September 2008'>September 2008</a></li>
	<li><a href='../../../../2008/08/index.html' title='August 2008'>August 2008</a></li>
	<li><a href='../../../../2008/07/index.html' title='July 2008'>July 2008</a></li>
	<li><a href='../../../../2008/06/index.html' title='June 2008'>June 2008</a></li>
	<li><a href='../../../../2008/05/index.html' title='May 2008'>May 2008</a></li>
	<li><a href='../../../../2008/04/index.html' title='April 2008'>April 2008</a></li>
	<li><a href='../../../../2008/03/index.html' title='March 2008'>March 2008</a></li>
	<li><a href='../../../../2008/02/index.html' title='February 2008'>February 2008</a></li>
	<li><a href='../../../../2008/01/index.html' title='January 2008'>January 2008</a></li>
	<li><a href='../../../../2007/11/index.html' title='November 2007'>November 2007</a></li>
	<li><a href='../../../../2007/10/index.html' title='October 2007'>October 2007</a></li>
	<li><a href='../../../../2007/09/index.html' title='September 2007'>September 2007</a></li>
	<li><a href='../../../../2007/08/index.html' title='August 2007'>August 2007</a></li>
	<li><a href='../../../../2007/07/index.html' title='July 2007'>July 2007</a></li>
		</ul>
</li>
<li id="text-315934861" class="widget widget_text">			<div class="textwidget"><a href="../../../../archive/index.html">The Older Archives</a></div>
		</li>
<li id="categories-1" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-12"><a href="../../../../category/erlang/index.html" title="View all posts filed under Erlang">Erlang</a>
</li>
	<li class="cat-item cat-item-11"><a href="../../../../category/html/index.html" title="View all posts filed under HTML">HTML</a>
</li>
	<li class="cat-item cat-item-8"><a href="../../../../category/javascript/index.html" title="View all posts filed under Javascript">Javascript</a>
</li>
	<li class="cat-item cat-item-15"><a href="../../../../category/licensing/index.html" title="View all posts filed under Licensing">Licensing</a>
</li>
	<li class="cat-item cat-item-18"><a href="../../../../category/mozilla/index.html" title="View all posts filed under Mozilla">Mozilla</a>
</li>
	<li class="cat-item cat-item-5"><a href="../../../../category/notech/index.html" title="View all posts filed under Non-technical">Non-technical</a>
</li>
	<li class="cat-item cat-item-6"><a href="../../../../category/olpc/index.html" title="View all posts filed under OLPC">OLPC</a>
</li>
	<li class="cat-item cat-item-14"><a href="../../../../category/packaging/index.html" title="View all posts filed under Packaging">Packaging</a>
</li>
	<li class="cat-item cat-item-4"><a href="../../../../category/politics/index.html" title="View all posts filed under Politics">Politics</a>
</li>
	<li class="cat-item cat-item-3"><a href="../../../../category/programming/index.html" title="View all posts filed under Programming">Programming</a>
</li>
	<li class="cat-item cat-item-7"><a href="../../../../category/python/index.html" title="View all posts filed under Python">Python</a>
</li>
	<li class="cat-item cat-item-10"><a href="../../../../category/ruby/index.html" title="View all posts filed under Ruby">Ruby</a>
</li>
	<li class="cat-item cat-item-19"><a href="../../../../category/security/index.html" title="View all posts filed under Security">Security</a>
</li>
	<li class="cat-item cat-item-16"><a href="../../../../category/silverlining.1" title="View all posts filed under Silver Lining">Silver Lining</a>
</li>
	<li class="cat-item cat-item-20"><a href="../../../../category/programming/testing/index.html" title="View all posts filed under Testing">Testing</a>
</li>
	<li class="cat-item cat-item-9"><a href="../../../../category/web/index.html" title="View all posts filed under Web">Web</a>
</li>
	<li class="cat-item cat-item-13"><a href="../../../../category/zopeplone/index.html" title="View all posts filed under Zope/Plone">Zope/Plone</a>
</li>
		</ul>
</li>
<li id="search-2" class="widget widget_search"><form id="searchform" method="get" action="../../../../index.html">
	<div>
		<input id="s" name="s" type="text" value="" tabindex="1" size="10" />
		<input id="searchsubmit" name="searchsubmit" type="submit" value="Find" tabindex="2" />
	</div>
</form> </li>
		<li id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widgettitle">Recent Posts</h2>
		<ul>
				<li><a href="../../../../index.html?p=291" title="Why doctest.js is better than Python&#8217;s doctest">Why doctest.js is better than Python&#8217;s doctest</a></li>
				<li><a href="../../../../index.html?p=283" title="Python Application Package">Python Application Package</a></li>
				<li><a href="../../../../index.html?p=277" title="Git-as-sync, not source-control-as-deployment">Git-as-sync, not source-control-as-deployment</a></li>
				<li><a href="../../../../index.html?p=253" title="My Unsolicited Advice For PyPy">My Unsolicited Advice For PyPy</a></li>
				<li><a href="../../../../index.html?p=250" title="A Python Web Application Package and Format (we should make one)">A Python Web Application Package and Format (we should make one)</a></li>
				</ul>
		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">Recent Comments</h2>
<ul id="recentcomments"><li class="recentcomments"><a href='http://www.mirsa.com.tr' rel='external nofollow' class='url'>havalandrma</a> on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-228633">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments"><a href='http://redealmeidense.com.br/portalx/modules/' rel='external nofollow' class='url'>this website</a> on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-196267">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments">Eric Pierce on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195322">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments">Paul Brian on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195321">Why doctest.js is better than Python&#8217;s doctest</a></li><li class="recentcomments"><a href='http://benjiyork.com' rel='external nofollow' class='url'>Benji York</a> on <a href="../../../../2012/10/02/why-doctest-js-is-better-than-pythons-doctest/comment-page-1/index.html#comment-195320">Why doctest.js is better than Python&#8217;s doctest</a></li></ul></li>
	</ul>
</div>

	<div id="footer">
		<p>
			&copy; 2013 Ian Bicking<!--
Does this commenting make me evil?
			|
			Thanks, <a href="http://wordpress.org/" title="WordPress">WordPress</a>
			|
			<a href="http://www.plaintxt.org/themes/barthelme/" title="Barthelme for WordPress" rel="follow">Barthelme</a> theme by <a href="http://scottwallick.com/" title="scottwallick.com" rel="follow">Scott</a>
			| <!-- The following is a link to the theme author's sponsor. Please consider its smallness and that Scott was nice enough to make this theme publically available. -->
			Sponsor: <a href="http://www.active-sandals.com/womreefsan.html" title="Support: Reef Sandals">Reef Sandals</a>
			|
			Valid <a href="http://validator.w3.org/check?uri=http://blog.ianbicking.org&amp;outline=1&amp;verbose=1" title="Valid XHTML 1.0 Strict" rel="nofollow">XHTML</a> &amp; <a href="http://jigsaw.w3.org/css-validator/validator?uri=http://blog.ianbicking.org/wp-content/themes/Barthelme-ianb/style.css&amp;profile=css2&amp;warning=no" title="Valid CSS" rel="nofollow">CSS</a>
			|
			-->
			RSS: <a href="../../../../feed/rss/index.html" title="Ian Bicking: a blog RSS 2.0 (XML) Feed" rel="alternate" type="application/rss+xml">Posts</a> &amp; <a href="../../../../comments/feed/index.html" title="Ian Bicking: a blog Comments RSS 2.0 (XML) Feed" rel="alternate" type="application/rss+xml">Comments</a>
		</p>
	</div>

</div><!-- END WRAPPER -->

	<!-- Somehow 44 queries occured in 1.586 seconds. Magic! -->
	<!-- The "Barthelme" theme copyright (c) 2006 Scott Allan Wallick - http://www.plaintxt.org/themes/ -->
	<script type='text/javascript' src='../../../../wp-includes/js/comment-reply.js?ver=3.4.2'></script>

<!-- Google Analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2442258-1";
urchinTracker();
</script>

</body>
</html>